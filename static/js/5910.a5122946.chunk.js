"use strict";(self.webpackChunkmmsp_land_hl=self.webpackChunkmmsp_land_hl||[]).push([[5910],{3289:(t,e,i)=>{i.d(e,{Dr:()=>M,EM:()=>A,Gn:()=>v,IQ:()=>_,Jk:()=>p,KK:()=>m,NZ:()=>V,TY:()=>u,Yg:()=>g,Zi:()=>y,gF:()=>h,mp:()=>S,oF:()=>x});var s=i(89379),n=i(401),o=i(13442),r=i(59286),a=i(15698),l=i(74075);function u(t){var e,i;return t.minScale||t.maxScale?{minScale:null!==(e=t.minScale)&&void 0!==e?e:0,maxScale:null!==(i=t.maxScale)&&void 0!==i?i:0}:null}function c(t){if(null==t)return null;if(Array.isArray(t)){const[e,i,s,n]=t;return[e,i,s,255*n]}return"string"==typeof t?t:(0,s.A)((0,s.A)({},t),{},{defaultValue:c(null===t||void 0===t?void 0:t.defaultValue)})}async function p(t,e){const{cimResourceManager:i,cimAnalyzer:s,scaleExpression:o}=e.schemaOptions;await Promise.all(n.wp.fetchResources(t.symbol,i,[]));const r=s.analyzeSymbolReference(t,!1),a={scaleInfo:u(t),scaleExpression:o},l=[];for(const n of r)switch(n.type){case"marker":l.push(...d(n,e,a));break;case"fill":l.push(...b(n,e,a));break;case"outlineFill":l.push(...f(n,e,a));break;case"gradientFill":l.push(...w(n,e,a));break;case"line":l.push(...C(n,e,a));break;case"gradientStroke":l.push(...P(n,e,a));break;case"text":l.push(...T(n,e,a))}return l}function d(t,e,i){const{uniforms:n,schemaOptions:o}=e,{store:l}=o,u=t.isOutline?(0,s.A)((0,s.A)({},a.Dk),{},{visualVariableSizeScaleStops:n.visualVariableSizeOutlineScaleStops}):{visualVariableColor:n.visualVariableColor,visualVariableOpacity:n.visualVariableOpacity,visualVariableSizeMinMaxValue:n.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:n.visualVariableSizeScaleStops,visualVariableSizeStops:n.visualVariableSizeStops,visualVariableSizeUnitValue:n.visualVariableSizeUnitValue,visualVariableRotation:n.visualVariableRotation};if(t.animationParams){const{hasShiftAnimation:e}=t.animationParams.params,s=e?r.YS.animatedMarkerShift:r.YS.animatedMarker;return h(l.ensureInstance(s,{uniforms:u,optionalAttributes:{zoomRange:!0,value1Position2Value2:t.animationParams.params.hasShiftAnimation,lineLength:e}}),t,a.Dk,i)}return y(l.ensureInstance(r.YS.marker,{uniforms:u,optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,n,i)}function h(t,e,i,s){return e.animationParams?[t.createMeshInfo({pixelDimensions:e.pixelDimensions,texelDimensions:e.texelDimensions,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,sprite:(0,l.xi)(e),animations:e.animationParams,scaleInfo:s.scaleInfo,scaleSymbolsProportionally:e.scaleSymbolsProportionally,strokeWidth:e.outlineWidth,isMapAligned:1===e.alignment,colorLocked:e.colorLocked,isStroke:e.isStroke,baseSize:e.baseSize,placement:e.markerPlacement,referenceSize:e.referenceSize,angleToLine:!!e.markerPlacement&&e.markerPlacement.placement&&"angleToLine"in e.markerPlacement.placement&&e.markerPlacement.placement.angleToLine,sizeRatio:e.sizeRatio,patternHeight:null})]:[]}function m(t,e,i,s){return e.animationParams?[t.createMeshInfo({effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,sprite:(0,l.xi)(e),animations:e.animationParams,scaleInfo:s.scaleInfo,scaleSymbolsProportionally:!1,strokeWidth:1,isMapAligned:!0,colorLocked:e.colorLocked||!1,isStroke:!1,baseSize:"width"in e?e.width:-1,placement:null,referenceSize:2,angleToLine:!1,sizeRatio:1,patternHeight:"fill"===e.type&&e.spriteRasterizationParam?e.height:null,joinType:"join"in e?e.join:"round",capType:"cap"in e?e.cap:"round",miterLimit:"miterLimit"in e&&e.miterLimit||2})]:[]}function y(t,e,i,s){var n,r;let{scaleInfo:u,scaleExpression:p}=s;const d=(0,l.IY)(i);return[t.createMeshInfo({size:e.size,scaleX:e.scaleX,anchorX:e.anchorPoint.x,anchorY:e.anchorPoint.y,angle:e.rotation,color:null!==(n=c(e.color))&&void 0!==n?n:[0,0,0,0],colorLocked:e.colorLocked,frameHeight:e.frameHeight,widthRatio:e.widthRatio,scaleInfo:u,offsetX:e.offsetX,offsetY:e.offsetY,outlineColor:null!==(r=c(e.outlineColor))&&void 0!==r?r:[0,0,0,0],outlineSize:e.outlineWidth,referenceSize:e.referenceSize||o.D.CIMVectorMarker.size,rotateClockwise:e.rotateClockwise,scaleFactor:null!==p&&void 0!==p?p:1,sizeRatio:e.sizeRatio,alignment:e.alignment,isAbsoluteAnchorPoint:e.isAbsoluteAnchorPoint,scaleSymbolsProportionally:e.scaleSymbolsProportionally,sprite:e.spriteRasterizationParam,hasSizeVV:d,placement:e.markerPlacement,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,transforms:e.transform,minPixelBuffer:(0,a.j0)(i)})]}function f(t,e,i){const{uniforms:s,schemaOptions:n}=e,{store:o}=n;return g(o.ensureInstance(r.YS.outlineFill,{uniforms:{visualVariableColor:t.colorLocked?null:s.visualVariableColor,visualVariableOpacity:s.visualVariableOpacity,visualVariableSizeMinMaxValue:null,visualVariableSizeScaleStops:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}function g(t,e,i){var s,n;const o=null!==(s=c(e.color))&&void 0!==s?s:[0,0,0,0],r=null!==(n=c(e.outlineColor))&&void 0!==n?n:[0,0,0,0];return[t.createMeshInfo({color:o,outlineColor:r,width:e.outlineWidth,referenceWidth:e.referenceWidth,capType:e.cap,joinType:e.join,miterLimit:e.miterLimit,outlineUsesColorVV:!e.outlineColorLocked,hasSizeVV:!1,scaleInfo:i.scaleInfo,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,outlineEffects:e.outlineEffects?{type:"cim-effect-infos",effectInfos:e.outlineEffects}:null})]}function v(t,e,i){var s;let{scaleInfo:n}=i;return[t.createMeshInfo({color:null!==(s=c(e.color))&&void 0!==s?s:[0,0,0,0],scaleInfo:n,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null})]}function b(t,e,i){if(!t.spriteRasterizationParam)return function(t,e,i){const{uniforms:n,schemaOptions:o}=e,{store:l}=o,u={visualVariableColor:t.colorLocked?null:n.visualVariableColor,visualVariableOpacity:n.visualVariableOpacity};if(t.animationParams){const e=r.YS.animatedFill;return m(l.ensureInstance(e,{uniforms:(0,s.A)((0,s.A)({},u),{},{visualVariableSizeMinMaxValue:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null,visualVariableSizeScaleStops:null,visualVariableRotation:null}),optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,lineLength:!1}}),t,a.Dk,i)}return v(l.ensureInstance(r.YS.fill,{uniforms:u,optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}(t,e,i);const{uniforms:n,schemaOptions:o}=e,{store:l}=o,u={visualVariableColor:t.colorLocked?null:n.visualVariableColor,visualVariableOpacity:n.visualVariableOpacity};if(t.animationParams){const e=r.YS.animatedFill;return m(l.ensureInstance(e,{uniforms:(0,s.A)((0,s.A)({},u),{},{visualVariableSizeMinMaxValue:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null,visualVariableSizeScaleStops:null,visualVariableRotation:null}),optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,lineLength:!1}}),t,a.Dk,i)}return x(l.ensureInstance(r.YS.complexFill,{uniforms:u,optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,null!=n.visualVariableColor,i)}function x(t,e,i,s){var n;let{scaleInfo:o}=s;if(!e.spriteRasterizationParam)throw new Error("InternalError: Sprite should always be defined");const r=!!e.hasUnresolvedReplacementColor&&(!i||e.colorLocked),a=e.sampleAlphaOnly&&!r,l=e.spriteRasterizationParam;return[t.createMeshInfo({color:null!==(n=c(e.color))&&void 0!==n?n:[0,0,0,0],height:e.height,aspectRatio:e.scaleX,offsetX:e.offsetX,offsetY:e.offsetY,scaleX:1,scaleY:1,angle:e.angle,applyRandomOffset:e.applyRandomOffset,sampleAlphaOnly:a,scaleProportionally:"CIMHatchFill"===l.resource.type,sprite:l,scaleInfo:o,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null})]}function w(t,e,i){const{uniforms:s,schemaOptions:n}=e,{store:o}=n;return S(o.ensureInstance(r.YS.gradientFill,{uniforms:{visualVariableColor:null,visualVariableOpacity:s.visualVariableOpacity},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}function S(t,e,i){var s;let{scaleInfo:n}=i;if(!e.spriteRasterizationParam)throw new Error("InternalError: Sprite should always be defined");const o=e.spriteRasterizationParam;return[t.createMeshInfo({color:null!==(s=c(e.color))&&void 0!==s?s:[0,0,0,0],angle:e.angle,gradientMethod:e.gradientMethod,gradientSize:e.gradientSize,gradientSizeUnits:e.gradientSizeUnits,gradientType:e.gradientType,sprite:o,scaleInfo:n,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null})]}function C(t,e,i){const{uniforms:n,schemaOptions:o}=e,{store:l}=o,u=t.isOutline?(0,s.A)((0,s.A)({},a.Dk),{},{visualVariableSizeScaleStops:n.visualVariableSizeOutlineScaleStops}):{visualVariableColor:t.colorLocked?null:n.visualVariableColor,visualVariableOpacity:n.visualVariableOpacity,visualVariableSizeMinMaxValue:n.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:n.visualVariableSizeScaleStops,visualVariableSizeStops:n.visualVariableSizeStops,visualVariableSizeUnitValue:n.visualVariableSizeUnitValue};if(t.animationParams){const{hasShiftAnimation:e}=t.animationParams.params,n=r.YS.animatedLine;return m(l.ensureInstance(n,{uniforms:(0,s.A)((0,s.A)({},u),{},{visualVariableRotation:null}),optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,accumulatedDistance:!0,segmentDirection:!0,normal:!0,lineLength:e}}),t,a.Dk,i)}const c={uniforms:u,optionalAttributes:{zoomRange:!!i.scaleInfo}},p=!!(u.visualVariableSizeMinMaxValue||u.visualVariableSizeScaleStops||u.visualVariableSizeStops||u.visualVariableSizeUnitValue);return t.spriteRasterizationParam?A(l.ensureInstance(r.YS.texturedLine,c),t,p,i):V(l.ensureInstance(r.YS.line,c),t,p,i)}function z(t,e,i){var s;let{scaleInfo:n}=i;return{color:null!==(s=c(t.color))&&void 0!==s?s:[0,0,0,0],width:t.width,referenceWidth:t.referenceWidth,capType:t.cap,joinType:t.join,miterLimit:t.miterLimit,scaleInfo:n,hasSizeVV:e,effects:t.effects?{type:"cim-effect-infos",effectInfos:t.effects}:null}}function V(t,e,i,s){if(e.spriteRasterizationParam)throw new Error("InternalError: Sprite should not be defined");const n=z(e,i,s);return[t.createMeshInfo(n)]}function A(t,e,i,n){var o;const{spriteRasterizationParam:r,scaleDash:a,sampleAlphaOnly:l}=e;if(!r)throw new Error("InternalError: Sprite should be defined");return[t.createMeshInfo((0,s.A)((0,s.A)({},z(e,i,n)),{},{offsetAlongLine:null!==(o=e.offsetAlongLine)&&void 0!==o?o:0,shouldScaleDash:null!==a&&void 0!==a&&a,shouldSampleAlphaOnly:l,isSDF:"CIMPictureStroke"!==r.resource.type&&"CIMGradientStroke"!==r.resource.type,sprite:r}))]}function P(t,e,i){const{uniforms:n,schemaOptions:o}=e,{store:l}=o;return M(l.ensureInstance(r.YS.gradientStroke,{uniforms:t.isOutline?(0,s.A)((0,s.A)({},a.Dk),{},{visualVariableSizeScaleStops:n.visualVariableSizeOutlineScaleStops}):{visualVariableColor:null,visualVariableOpacity:n.visualVariableOpacity,visualVariableSizeMinMaxValue:n.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:n.visualVariableSizeScaleStops,visualVariableSizeStops:n.visualVariableSizeStops,visualVariableSizeUnitValue:n.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}function M(t,e,i){if(!e.spriteRasterizationParam)throw new Error("InternalError: Sprite should always be defined");const n=e.spriteRasterizationParam;return[t.createMeshInfo((0,s.A)((0,s.A)({},z(e,!1,i)),{},{gradientMethod:e.gradientMethod,gradientSize:e.gradientSize,gradientSizeUnits:e.gradientSizeUnits,gradientType:e.gradientType,sprite:n,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null}))]}function T(t,e,i){const{uniforms:s,schemaOptions:n}=e,{store:o}=n;return _(o.ensureInstance(r.YS.text,{uniforms:{visualVariableColor:t.colorLocked?null:s.visualVariableColor,visualVariableOpacity:s.visualVariableOpacity,visualVariableRotation:s.visualVariableRotation,visualVariableSizeMinMaxValue:s.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:s.visualVariableSizeScaleStops,visualVariableSizeStops:s.visualVariableSizeStops,visualVariableSizeUnitValue:s.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!!i.scaleInfo,referenceSymbol:!1,clipAngle:!1,visibility:!1}}),t,s,i)}function _(t,e,i,s){var n,o,r,l,u,p,d;let{scaleInfo:h,scaleExpression:m}=s;return[t.createMeshInfo({boxBackgroundColor:c(e.backgroundColor),boxBorderLineColor:c(e.borderLineColor),boxBorderLineSize:null!==(n=e.borderLineWidth)&&void 0!==n?n:0,color:null!==(o=c(e.color))&&void 0!==o?o:[0,0,0,0],offsetX:e.offsetX,offsetY:e.offsetY,postAngle:e.angle,fontSize:e.size,referenceSize:e.referenceSize,decoration:e.decoration,haloColor:null!==(r=c(e.haloColor))&&void 0!==r?r:[0,0,0,0],haloSize:null!==(l=e.haloSize)&&void 0!==l?l:0,outlineColor:null!==(u=c(e.outlineColor))&&void 0!==u?u:[0,0,0,0],outlineSize:e.outlineSize,lineWidth:e.lineWidth||512,lineHeightRatio:1,horizontalAlignment:null!==(p=e.horizontalAlignment)&&void 0!==p?p:"center",verticalAlignment:null!==(d=e.verticalAlignment)&&void 0!==d?d:"baseline",useCIMAngleBehavior:!1,glyphs:e.textRasterizationParam,scaleInfo:h,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,placement:e.markerPlacement,transforms:e.transform,scaleFactor:null!==m&&void 0!==m?m:1,minPixelBuffer:(0,a.j0)(i),repeatLabel:null,repeatLabelDistance:null,allowOverrun:null,labelPosition:null,layerId:null,labelClassId:null})]}},13618:(t,e,i)=>{i.d(e,{Jz:()=>p,T9:()=>a,uH:()=>l});var s=i(18690),n=i(92045),o=i(18943),r=i(9685);function a(t,e){return{type:"simple",filters:e,capabilities:{maxTextureSize:(0,r.C)().maxTextureSize},bindings:c(t)}}function l(t,e){const i=(0,r.C)();return{type:"multi",target:"feature",keyField:n.EA,filters:e,capabilities:{maxTextureSize:i.maxTextureSize},bindings:{0:c(t.trackLines.renderer),1:c(t.latestObservations.renderer),2:c(t.previousObservations.renderer)}}}function u(t){switch(t){case"opacity":return 2;case"color":return 1;case"rotation":return 3;case"size":return 0;default:return null}}function c(t){if(!t)return[];switch(t.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return p(t);case"dot-density":return function(t){const e=[];for(const i of t.attributes)e.push({binding:e.length,expression:i.valueExpression,field:i.field});return e}(t);case"pie-chart":return function(t){const e=p(t);let i=4;for(const s of t.attributes)e.push({binding:i++,expression:s.valueExpression,field:s.field});return e}(t);case"heatmap":return function(t){let{valueExpression:e,field:i}=t;return e||i?[{binding:0,expression:e,field:i}]:[]}(t)}}function p(t){var e;return"visualVariables"in t&&null!==(e=t.visualVariables)&&void 0!==e&&e.length?(0,o.R)(t.visualVariables).map(t=>function(t){switch(t.type){case"size":return function(t){return"$view.scale"===t.valueExpression?null:{binding:u(t.type),field:t.field,normalizationField:t.normalizationField,expression:t.valueExpression,valueRepresentation:t.valueRepresentation}}(t);case"color":case"opacity":return function(t){return{binding:u(t.type),field:t.field,normalizationField:t.normalizationField,expression:t.valueExpression}}(t);case"rotation":return function(t){return{binding:u(t.type),expression:t.valueExpression,field:t.field}}(t)}}(t)).filter(s.Ru):[]}},15698:(t,e,i)=>{i.d(e,{Dk:()=>x,K4:()=>S,j0:()=>w});var s=i(89379),n=(i(81806),i(76931)),o=i(31633),r=i(3454),a=i(5095),l=i(81608),u=i(18943);const c=1.25,p=128,d=128;function h(t){var e;if(null===(e=t.stops)||void 0===e||!e.length)return null;const i=t.stops.sort((t,e)=>t.value-e.value),s=(0,l.r)(i,8),n=s.map(t=>{let{value:e}=t;return e}),o=s.map(t=>{let{color:e}=t;return(0,l.p)(e)});return{values:n,colors:o}}function m(t){var e;if(null===(e=t.stops)||void 0===e||!e.length)return null;const i=t.stops.sort((t,e)=>t.value-e.value),s=(0,l.r)(i,8);return{opacityValues:s.map(t=>{let{value:e}=t;return e}),opacities:s.map(t=>{let{opacity:e}=t;return e})}}function y(t){return{rotationType:"geographic"===t.rotationType?0:1}}function f(t){var e;if(null===(e=t.stops)||void 0===e||!e.length)return null;if(t.stops.some(t=>t.useMaxValue||t.useMinValue))return(e,i)=>{const s=e.statisticsByLevel.get(i.key.level),o=t.stops.map(e=>{var i,o,r,l;return{value:e.useMaxValue?null!==(i=null===s||void 0===s||null===(o=s.get(t.field))||void 0===o?void 0:o.maxValue)&&void 0!==i?i:0:e.useMinValue?null!==(r=null===s||void 0===s||null===(l=s.get(t.field))||void 0===l?void 0:l.minValue)&&void 0!==r?r:0:e.value,size:e.size?(0,n.Lz)(e.size):a.qM}}).sort((t,e)=>t.value-e.value),r=(0,l.r)(o,8);return{values:r.map(t=>{let{value:e}=t;return e}),sizes:r.map(t=>{let{size:e}=t;return e})}};const i=t.stops.sort((t,e)=>t.value-e.value),s=(0,l.r)(i,8);return{values:s.map(t=>{let{value:e}=t;return e}),sizes:s.map(t=>{let{size:e}=t;return(0,n.Lz)(e)})}}function g(t){return e=>{var i;const{state:s}=e;return{unitValueToPixelsRatio:(0,o.GA)(s.spatialReference)/r.j[null!==(i=t.valueUnit)&&void 0!==i?i:"meters"]/s.resolution}}}function v(t,e){const i=e.length;if(t<e[0].value||1===i)return e[0].size;for(let s=1;s<i;s++)if(t<e[s].value){const i=(t-e[s-1].value)/(e[s].value-e[s-1].value);return e[s-1].size+i*(e[s].size-e[s-1].size)}return e[i-1].size}function b(t){const{minDataValue:e,maxDataValue:i,minSize:s,maxSize:o}=t;if("object"==typeof s&&"object"==typeof o)return(t,r)=>{const a=t.state.scale,l=(0,n.Lz)(v(a,s.stops)),u=(0,n.Lz)(v(a,o.stops));return{minMaxValueAndSize:[e,i,l,u]}};if("object"==typeof s||"object"==typeof o)throw new Error("InternalError: Found a partial VisualVariableSizeMinMaxValue");return{minMaxValueAndSize:[e,i,(0,n.Lz)(s),(0,n.Lz)(o)]}}const x={visualVariableColor:null,visualVariableOpacity:null,visualVariableRotation:null,visualVariableSizeStops:null,visualVariableSizeScaleStops:null,visualVariableSizeOutlineScaleStops:null,visualVariableSizeUnitValue:null,visualVariableSizeMinMaxValue:null};function w(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;if(t.visualVariableSizeMinMaxValue)return"function"==typeof t.visualVariableSizeMinMaxValue?p:Math.max(t.visualVariableSizeMinMaxValue.minMaxValueAndSize[3]*i,e);if(t.visualVariableSizeScaleStops){if("function"==typeof t.visualVariableSizeScaleStops)return p;const s=t.visualVariableSizeScaleStops.sizes;return Math.max(s[s.length-1]*i,e)}if(t.visualVariableSizeStops){if("function"==typeof t.visualVariableSizeStops)return p;const s=t.visualVariableSizeStops.sizes;return Math.max(s[s.length-1]*i,e)}return t.visualVariableSizeUnitValue?2*p:0}function S(t){const e=(0,s.A)({},x);if(!t||!("visualVariables"in t)||!t.visualVariables)return e;for(const i of(0,u.R)(t.visualVariables))switch(i.type){case"color":e.visualVariableColor=h(i);break;case"opacity":e.visualVariableOpacity=m(i);break;case"rotation":e.visualVariableRotation=y(i);break;case"size":switch(C(i)){case"field-stops":e.visualVariableSizeStops=f(i);break;case"scale-stops":"outline"===i.target?e.visualVariableSizeOutlineScaleStops=f(i):e.visualVariableSizeScaleStops=f(i);break;case"min-max":e.visualVariableSizeMinMaxValue=b(i);break;case"unit-value":e.visualVariableSizeUnitValue=g(i)}}return e}function C(t){return"number"==typeof t.minDataValue&&"number"==typeof t.maxDataValue&&null!=t.minSize&&null!=t.maxSize?"min-max":"$view.scale"===(null===t||void 0===t?void 0:t.valueExpression)&&Array.isArray(t.stops)?"scale-stops":null==t.field&&"$view.scale"===(null===t||void 0===t?void 0:t.valueExpression)||!(Array.isArray(t.stops)||"levels"in t&&t.levels)?null!=t.field||"$view.scale"!==(null===t||void 0===t?void 0:t.valueExpression)?"unit-value":null:"field-stops"}},16946:(t,e,i)=>{i.d(e,{g:()=>l});var s=i(89339),n=i(64780),o=i(93345),r=i(21812);const a={position:{type:o.pe.SHORT,count:2}};class l extends n.e{static create(t,e){const i=[];let{stride:n}=e;if(null==n){n=0;for(const[t,{count:i,type:o,offset:r}]of Object.entries(e.layout)){if(null!=r)throw new Error("Stride cannot be computed automatically when attribute offsets are supplied explicitly.");n+=i*s.I[o]}}let o=0;for(const[l,{count:d,offset:h,type:m,normalized:y}]of Object.entries(e.layout)){null!=h&&(o=h);const t=new r._(l,d,m,o,n,null!=y&&y,0);i.push(t),o+=d*s.I[m]}const a={primitive:e.primitive};null!=e.index&&(a.index="indexData");let{count:u}=e;if(null==u&&(u=e.index?e.index.length:e.vertex.byteLength/n,Math.floor(u)!==u))throw new Error("The byte length of vertex data must be an exact multiple of the stride, which is ".concat(n,"."));const c={start:0,count:u,group:0,primitive:e.primitive},p={vertex:{vertexData:{data:e.vertex,layout:i}},parts:[c],groups:[a]};return null!=e.index&&(p.index={indexData:{data:e.index}}),new l(t,p,e.layout)}static fromVertexStream(t,e){return l.create(t,{primitive:o.WR.TRIANGLE_STRIP,vertex:new Uint16Array(e),layout:a})}constructor(t,e,i){super(t,e),this._spec=i}bind(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super.bind(t,e,i)}}},18943:(t,e,i)=>{i.d(e,{R:()=>c,e:()=>d});var s=i(50076),n=i(76460),o=i(76931),r=i(9685);const a=8,l=a-2,u=()=>n.A.getLogger("esri.views.2d.layers.features.support.rendererUtils");function c(t){return t.map(t=>function(t){return("size"===t.type||"color"===t.type||"opacity"===t.type)&&null!=t.stops}(t)?function(t){var e;return t.stops=function(t,e){return e.length<=a?e:(u().warn("Found ".concat(e.length," Visual Variable stops, but MapView only supports ").concat(a,". Displayed stops will be simplified.")),e.length>2*a?function(t,e){const[i,...s]=e,n=s.pop(),r=s[0].value,a=s[s.length-1].value,u=(a-r)/l,c=[];for(let l=r;l<a;l+=u){let i=0;for(;l>=s[i].value;)i++;const n=s[i],r=e[i-1],a=l-r.value,u=n.value===r.value?1:a/(n.value-r.value);if("color"===t){const t=s[i],n=e[i-1],o=t.color.clone();o.r=p(n.color.r,o.r,u),o.g=p(n.color.g,o.g,u),o.b=p(n.color.b,o.b,u),o.a=p(n.color.a,o.a,u),c.push({value:l,color:o,label:t.label})}else if("size"===t){const t=s[i],n=e[i-1],r=(0,o.cr)(t.size),a=p((0,o.cr)(n.size),r,u);c.push({value:l,size:a,label:t.label})}else{const t=s[i],n=p(e[i-1].opacity,t.opacity,u);c.push({value:l,opacity:n,label:t.label})}}return[i,...c,n]}(t,e):function(t){const[e,...i]=t,s=i.pop();for(;i.length>l;){let t=0,e=0;for(let s=1;s<i.length;s++){const n=i[s-1],o=i[s],r=Math.abs(o.value-n.value);r>e&&(e=r,t=s)}i.splice(t,1)}return[e,...i,s]}(e))}(t.type,null!==(e=t.stops)&&void 0!==e?e:[]),t}(t.clone()):t)}function p(t,e,i){return(1-i)*t+i*e}function d(t){if(!t)return!0;switch(t.type){case"dot-density":break;case"heatmap":if(!function(){const{supportsColorBufferFloat:t,supportsColorBufferFloatBlend:e,supportsColorBufferHalfFloat:i}=(0,r.C)();return t&&e||i}()){const t=(0,r.C)(),e=["supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(e=>!t[e]).join(", ");return u().errorOnce(new s.A("webgl-missing-extension","Missing WebGL2 requirements for Heatmap: ".concat(e))),!1}}return!0}},29494:(t,e,i)=>{i.d(e,{H:()=>n});var s=i(81806);const n=new class{get forceStaticPath(){return"disabled"===(0,s.A)("esri-cim-animations-enable-status")}get forceAnimatedPath(){return"forced"===(0,s.A)("esri-cim-animations-enable-status")}get freezeGlobalTime(){const t=(0,s.A)("esri-cim-animations-freeze-time");return null!==t&&void 0!==t&&t}get spotlightAnimatedSymbols(){return!!(0,s.A)("esri-cim-animations-spotlight")}get forceGlobalTimeOrigin(){return!1!==(0,s.A)("esri-cim-animations-freeze-time")}}},59286:(t,e,i)=>{i.d(e,{YS:()=>Je,n_:()=>ei,Wn:()=>ti});var s=i(89379),n=i(6326),o=i(6951),r=i(60984),a=i(29494),l=i(62484);class u extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.nt)],u.prototype,"globalTime",void 0),(0,n.Cg)([(0,o.Pi)(r.ZY)],u.prototype,"animationTextureSize",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],u.prototype,"animationTexture",void 0),(0,n.Cg)([(0,o.Pi)(r.U)],u.prototype,"toScreen",void 0),(0,n.Cg)([(0,o.Pi)(r.U)],u.prototype,"toNdc",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],u.prototype,"mapRotation",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],u.prototype,"pixelRatio",void 0);var c=i(43282),p=i(5095),d=i(81806),h=i(60853);class m extends o.k2{getVisualVariableData(t){if(!this._vvData){const e=this.getAttributeDataCoords(t);this._vvData=(0,r.US)(this.visualVariableData,e).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(t){if(!this._uv){const e=(0,h.Kt)(t),i=this.size,s=(0,r.Wh)(e.x),n=(0,r.Wh)(e.y).multiply((0,r.Wh)(256)),o=(0,r.Wh)(e.z).multiply((0,r.Wh)(256)).multiply((0,r.Wh)(256)),a=(0,r.fV)(s.add(n).add(o)),l=(0,r.zi)(a,i),u=a.subtract(l).divide(i);this._uv=new r.ZY(l,u).add(.5).divide(i)}return this._uv}getFilterData(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.filterFlags,e).setDebugName("storage0")}getAnimationData(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.animation,e).setDebugName("storage1")}getVVData(t){return this.getVisualVariableData(t)}getDataDrivenData0(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.dataDriven0,e).setDebugName("storage30")}getDataDrivenData1(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.dataDriven1,e).setDebugName("storage31")}getDataDrivenData2(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.dataDriven2,e).setDebugName("storage32")}getGPGPUData(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.gpgpu,e).setDebugName("storage4")}getLocalTimeOrigin(t){const e=this.getAttributeDataCoords(t);return(0,r.US)(this.localTimeOrigin,e).x.setDebugName("storage5")}getFilterFlags(t){return(0,d.A)("webgl-ignores-sampler-precision")?(0,r.mk)(this.getFilterData(t).x.multiply((0,r.fV)(255))):this.getFilterData(t).x.multiply((0,r.fV)(255))}getLabelVisibility(t){const e=this.getFilterData(t).y.multiply(255);return new r.nt(1).subtract(e)}getAnimationValue(t){return this.getAnimationData(t).x}getSizeValue(t){return this.getVisualVariableData(t).x}getColorValue(t){return this.getVisualVariableData(t).y}getOpacityValue(t){return this.getVisualVariableData(t).z}getRotationValue(t){return this.getVisualVariableData(t).w}}(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"filterFlags",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"animation",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"gpgpu",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"localTimeOrigin",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"visualVariableData",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"dataDriven0",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"dataDriven1",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],m.prototype,"dataDriven2",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],m.prototype,"size",void 0);class y extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.nt)],y.prototype,"activeReasons",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],y.prototype,"highlightAll",void 0);class f extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.ZY)],f.prototype,"position",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],f.prototype,"distance",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],f.prototype,"smallSymbolDistance",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],f.prototype,"smallSymbolSizeThreshold",void 0);class g extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.U)],g.prototype,"displayViewScreenMat3",void 0),(0,n.Cg)([(0,o.Pi)(r.U)],g.prototype,"displayViewMat3",void 0),(0,n.Cg)([(0,o.Pi)(r.U)],g.prototype,"displayMat3",void 0),(0,n.Cg)([(0,o.Pi)(r.U)],g.prototype,"viewMat3",void 0),(0,n.Cg)([(0,o.Pi)(r.U)],g.prototype,"tileMat3",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"displayZoomFactor",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"requiredZoomFactor",void 0),(0,n.Cg)([(0,o.Pi)(r.ZY)],g.prototype,"tileOffset",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"currentScale",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"currentZoom",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"metersPerSRUnit",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"rotation",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],g.prototype,"pixelRatio",void 0);class v extends o.ZA{}(0,n.Cg)([(0,o.C5)(0,r.eB)],v.prototype,"id",void 0),(0,n.Cg)([(0,o.C5)(1,r.nt)],v.prototype,"bitset",void 0),(0,n.Cg)([(0,o.C5)(2,r.ZY)],v.prototype,"pos",void 0);class b extends o.Y7{}(0,n.Cg)([(0,o.C5)(14,r.ZY)],b.prototype,"nextPos1",void 0),(0,n.Cg)([(0,o.C5)(15,r.ZY)],b.prototype,"nextPos2",void 0);class x extends o.HS{}class w extends o.A{clip(t,e){let i=new r.nt(0);const s=this.storage.getFilterFlags(t);if(i=i.add((0,r.fV)(2).multiply((0,r.fV)(1).subtract((0,h.i6)(s,0)))),this.inside?i=i.add((0,r.fV)(2).multiply((0,r.fV)(1).subtract((0,h.i6)(s,1)))):this.outside?i=i.add((0,r.fV)(2).multiply((0,h.i6)(s,1))):this.highlight&&(i=i.add((0,r.fV)(2).multiply((0,r.fV)(1).subtract(this._checkHighlight(s))))),null!=e){const t=new r.nt(1).subtract((0,r.PM)(e.x,this.view.currentZoom)),s=(0,r.PM)(e.y,this.view.currentZoom);i=i.add(new r.nt(2).multiply(t.add(s)))}return i}getFragmentOutput(t,e){var i,s;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.nt(1/255);const a=new o.mm;return a.fragColor=null!==(i=null!==(s=this._maybeWriteHittest(e))&&void 0!==s?s:this._maybeHighlight(t,n))&&void 0!==i?i:t,a}_maybeHighlight(t,e){return this.highlight?new r.Zb(t.rgb,(0,r.PM)(e,t.a)):null}_checkHighlight(t){let e=this._checkHighlightBit(t,0);for(let i=1;i<p.U5;i++)e=e.add(this._checkHighlightBit(t,i));return(0,r.PM)(new r.nt(.1),e.add(this.highlight.highlightAll))}_checkHighlightBit(t,e){return(0,h.yS)(t,e).multiply((0,h.mh)(this.highlight.activeReasons,e))}maybeRunHittest(t,e,i){if(null==this.hittestRequest)return null;const s=this.hittest(t,e,i);let n=(0,r.Tk)((0,r.MM)(s,this.hittestRequest.distance),new r.nt(2),new r.nt(0));const o=this.storage.getAttributeDataCoords(t.id),a=(0,h.nb)(o);n=n.add(this.clip(t.id,t.zoomRange));const l=new r.Zb(new r.nt(1/255),0,0,0);return{glPointSize:new r.nt(1),glPosition:new r.Zb(a,n,1),color:l}}_maybeWriteHittest(t){return null!=this.hittestRequest?t.color:null}}(0,n.Cg)([o.E8],w.prototype,"inside",void 0),(0,n.Cg)([o.E8],w.prototype,"outside",void 0),(0,n.Cg)([(0,o.uK)(y)],w.prototype,"highlight",void 0),(0,n.Cg)([(0,o.Pi)(m)],w.prototype,"storage",void 0),(0,n.Cg)([(0,o.Pi)(g)],w.prototype,"view",void 0),(0,n.Cg)([(0,o.uK)(f)],w.prototype,"hittestRequest",void 0);var S=i(90113);class C extends o.k2{getPatternOffsetAtTileOrigin(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.nt(0),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.nt(1);const s=new r.ZY(S.YV).divide(t);let n=t.multiply((0,r.jc)(this.maxIntsToLocalOrigin.multiply(s))).add(this.tileOffsetFromLocalOrigin).subtract(new r.nt(.5).multiply(t));return n=new r.ZY(n.x.multiply(i).subtract(n.y.multiply(e)),n.x.multiply(e).add(n.y.multiply(i))),(0,r.zi)(n,t)}}(0,n.Cg)([(0,o.Pi)(r.ZY)],C.prototype,"tileOffsetFromLocalOrigin",void 0),(0,n.Cg)([(0,o.Pi)(r.ZY)],C.prototype,"maxIntsToLocalOrigin",void 0);class z extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.ZY)],z.prototype,"size",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],z.prototype,"texture",void 0);class V extends o.k2{getColor(t,e,i){return(0,r.j1)([(0,r.or)((0,h.M8)(t),i),e],[(0,r.$5)(t,this.values.first()),this.colors.first()],[(0,r.aX)(t,this.values.last()),this.colors.last()],[!0,()=>{const e=this.values.findIndex(e=>(0,r.MM)(e,t)),i=this.values.get(e),s=e.subtract(1),n=this.values.get(s),o=t.subtract(n).divide(i.subtract(n));return(0,r.jh)(this.colors.get(s),this.colors.get(e),o)}])}}(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.Zb,8))],V.prototype,"colors",void 0),(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],V.prototype,"values",void 0);class A extends o.k2{getOpacity(t){return(0,r.j1)([(0,h.M8)(t),new r.nt(1)],[(0,r.$5)(t,this.opacityValues.first()),this.opacities.first()],[(0,r.aX)(t,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const e=this.opacityValues.findIndex(e=>(0,r.MM)(e,t)),i=this.opacityValues.get(e),s=e.subtract(1),n=this.opacityValues.get(s),o=t.subtract(n).divide(i.subtract(n));return(0,r.jh)(this.opacities.get(s),this.opacities.get(e),o)}])}}(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],A.prototype,"opacities",void 0),(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],A.prototype,"opacityValues",void 0);class P extends o.k2{getVVRotationMat4(t){return(0,r.Tk)((0,h.M8)(t),r.$I.identity(),()=>{const e=this.getNormalizedAngle(t).multiply(S.os),i=(0,r.F8)(e),s=(0,r.gn)(e);return new r.$I(s,i,0,0,i.multiply(new r.nt(-1)),s,0,0,0,0,1,0,0,0,0,1)})}getVVRotationMat3(t){return(0,r.Tk)((0,h.M8)(t),r.U.identity(),()=>{const e=this.getNormalizedAngle(t).multiply(S.os),i=(0,r.F8)(e),s=(0,r.gn)(e);return new r.U(s,i,0,i.multiply(new r.nt(-1)),s,0,0,0,1)})}getNormalizedAngle(t){const e=(0,r.LC)(this.rotationType,new r.nt(1));return(0,r.Tk)(e,new r.nt(90).subtract(t),t)}}(0,n.Cg)([(0,o.Pi)(r.nt)],P.prototype,"rotationType",void 0);class M extends o.k2{getSize(t,e){const i=this.minMaxValueAndSize.xy,s=this.minMaxValueAndSize.zw;return(0,r.Tk)((0,h.M8)(t),e,()=>{const e=t.subtract(i.x).divide(i.y.subtract(i.x)),n=(0,r.qE)(e,new r.nt(0),new r.nt(1));return s.x.add(n.multiply(s.y.subtract(s.x)))})}}(0,n.Cg)([(0,o.Pi)(r.Zb)],M.prototype,"minMaxValueAndSize",void 0);class T extends o.k2{getSizeForViewScale(t){return(0,r.j1)([(0,r.$5)(t,this.values.first()),this.sizes.first()],[(0,r.aX)(t,this.values.last()),this.sizes.last()],[!0,()=>{const e=this.values.findIndex(e=>(0,r.MM)(e,t)),i=this.values.get(e),s=e.subtract(1),n=this.values.get(s),o=t.subtract(n).divide(i.subtract(n));return(0,r.jh)(this.sizes.get(s),this.sizes.get(e),o)}])}}(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],T.prototype,"sizes",void 0),(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],T.prototype,"values",void 0);class _ extends o.k2{getSize(t,e){const i=(0,r.j1)([(0,h.M8)(t),e],[(0,r.$5)(t,this.values.first()),this.sizes.first()],[(0,r.aX)(t,this.values.last()),this.sizes.last()],[!0,()=>{const e=this.values.findIndex(e=>(0,r.MM)(e,t)),i=this.values.get(e),s=e.subtract(1),n=this.values.get(s),o=t.subtract(n).divide(i.subtract(n));return(0,r.jh)(this.sizes.get(s),this.sizes.get(e),o)}]);return(0,r.Tk)((0,h.M8)(i),e,i)}}(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],_.prototype,"sizes",void 0),(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.nt,8))],_.prototype,"values",void 0);class R extends o.k2{getSize(t,e){return(0,r.Tk)((0,h.M8)(t),e,t.multiply(this.unitValueToPixelsRatio))}}function F(t){return null!=t.visualVariableSizeMinMaxValue||null!=t.visualVariableSizeScaleStops||null!=t.visualVariableSizeStops||null!=t.visualVariableSizeUnitValue}function D(t,e,i){if(F(t)){var s,n,o,r,a,l,u;const c=t.storage.getSizeValue(e);return null!==(s=null!==(n=null!==(o=null===(r=t.visualVariableSizeMinMaxValue)||void 0===r?void 0:r.getSize(c,i))&&void 0!==o?o:null===(a=t.visualVariableSizeScaleStops)||void 0===a?void 0:a.getSizeForViewScale(t.view.currentScale))&&void 0!==n?n:null===(l=t.visualVariableSizeStops)||void 0===l?void 0:l.getSize(c,i))&&void 0!==s?s:null===(u=t.visualVariableSizeUnitValue)||void 0===u?void 0:u.getSize(c,i)}return i}function k(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new r.x(!1);if(null==t.visualVariableColor)return i;const n=t.storage.getColorValue(e);return t.visualVariableColor.getColor(n,i,s)}function O(t,e){if(null==t.visualVariableOpacity)return new r.nt(1);const i=t.storage.getOpacityValue(e);return t.visualVariableOpacity.getOpacity(i)}function I(t,e){if(null==t.visualVariableRotation)return r.U.identity();const i=t.storage.getRotationValue(e);return t.visualVariableRotation.getVVRotationMat3(i)}(0,n.Cg)([(0,o.Pi)(r.nt)],R.prototype,"unitValueToPixelsRatio",void 0);class Z extends v{}(0,n.Cg)([(0,o.C5)(3,r.ZY)],Z.prototype,"offset",void 0),(0,n.Cg)([(0,o.C5)(4,r.Zb)],Z.prototype,"sizing",void 0),(0,n.Cg)([(0,o.C5)(5,r.Zb)],Z.prototype,"value1Position2Value2",void 0),(0,n.Cg)([(0,o.C5)(6,r.Zb)],Z.prototype,"animationPointerAndBaseSizeAndReferenceSize",void 0),(0,n.Cg)([(0,o.C5)(7,r.ZY)],Z.prototype,"zoomRange",void 0),(0,n.Cg)([(0,o.C5)(8,r.nt)],Z.prototype,"lineLength",void 0);class E extends x{}class B extends w{_vertexPreamble(t,e,i){const{id:s,offset:n,animationPointerAndBaseSizeAndReferenceSize:o,sizing:a}=t,l=o.xy,u=o.z,p=o.w,d=a.xy,m=this._getEvalParams(t,d,i);let y,f;if(t.value1Position2Value2){const e=L(l,6,m).a,i=t.pos,s=t.value1Position2Value2.yz,n=t.value1Position2Value2.x,o=t.value1Position2Value2.w,a=e.subtract(n).divide(o.subtract(n));f=i.add(s.subtract(i).multiply(a)),y=(0,r.PM)(new r.nt(1),a).add((0,r.PM)(new r.nt(0),(0,r.ze)(a)))}else f=t.pos,y=new r.nt(0);const g=a.z,v=(0,h.mh)(t.bitset,c.c.bitset.isStroke),b=a.w,x=(0,h.mh)(t.bitset,c.c.bitset.scaleSymbolsProportionally),w=L(l,0,m),C=(0,r.j1)([(0,r.LC)((0,h.mh)(t.bitset,c.c.bitset.isMapAligned),new r.nt(1)),this.view.rotation.divide(180).multiply(Math.PI)],[!0,new r.nt(0)]),z=new r.Ny((0,r.gn)(C),(0,r.F8)(C.multiply(-1)),(0,r.F8)(C),(0,r.gn)(C)).multiply(w.xy),V=w.z.subtract(C).subtract(e.multiply(S.rp)),A=w.w,P=(0,h.mh)(t.bitset,c.c.bitset.isSDF),M=D(this,s,new r.nt(p)).divide(new r.nt(p));return{baseSize:u,animationPointer:l,strokeWidth:g,isOutline:v,unscaledDistanceToPx:b,scaleSymbolsProportionally:x,isSDF:P,position:this._getScreenPosition({id:s,pos:f,offset:n,referenceSize:p,translation:z,rotation:V,scale:A,vvScale:M}),evalParams:m,vvScale:M,scale:A,clip:y}}_getScreenPosition(t){const{pos:e,translation:i,rotation:s,scale:n,offset:o,id:a,vvScale:l}=t,u=function(t,e){if(null==t.visualVariableRotation)return new r.nt(0);const i=t.storage.getRotationValue(e);return t.visualVariableRotation.getNormalizedAngle(i)}(this,a).multiply(Math.PI/180),c=i.x.multiply(4/3),p=i.y.multiply(-1).multiply(4/3),d=(0,r.F8)(u),h=(0,r.gn)(u),m=h.multiply(c).add((0,r.ze)(d).multiply(p)),y=d.multiply(c).add(h.multiply(p)),f=(0,r.F8)(s.subtract(u)),g=(0,r.gn)(s.subtract(u)),v=new r.nt(0),b=new r.nt(1),{pixelRatio:x}=this.animationInfo,w=new r.U(b,v,v,v,b,v,m.multiply(x),y.multiply(x),b),S=new r.U(g,f.multiply(-1),v,f,g,v,0,0,b),C=n.multiply(l).multiply(x).multiply(4/3),z=S.multiply(C),V=this.animationInfo.toScreen.multiply(new r.eB(e,1)),A=w.multiply(V).xy,P=z.multiply(new r.eB(o,0)).xy;return A.add(P)}_clip(t,e){let i=super.clip(t,e);const s=(0,r.$5)(this._getLocalTimeOrigin(t),new r.nt(0));return a.H.forceGlobalTimeOrigin||(i=i.add((0,r.j1)([s,()=>new r.nt(2)],[!0,()=>new r.nt(0)]))),i}_getLocalTimeOrigin(t){return this.storage.getLocalTimeOrigin(t)}_toNdc(t){return this.animationInfo.toNdc.multiply(new r.eB(t,1)).xy}_getEvalParams(t,e,i){const{globalTime:s,animationTextureSize:n,animationTexture:o}=this.animationInfo;return{globalTime:s,localTimeOrigin:this._getLocalTimeOrigin(t.id),animationTextureSize:n,animationTexture:o,pixelDimensions:e,lineLength:i}}_getColor(t,e){return(0,r.Tk)((0,r.LC)(e.isSDF,new r.nt(1)),this._getSDFColor(t,e),this._getSpriteColor(t,e))}_getSpriteColor(t,e){return(0,r.US)(this.mosaicInfo.texture,t).multiply(e.color)}_getSDFColor(t,e){const i=(0,r.US)(this.mosaicInfo.texture,t),s=new r.nt(.5).subtract((0,h.Rj)(i)).multiply(e.distanceToPx).multiply(S.V5),n=(0,r.qE)(new r.nt(.5).subtract(s),new r.nt(0),new r.nt(1)),o=e.color.multiply(n),a=e.outlineSize.multiply(.5),l=(0,r.tn)(s).subtract(a),u=(0,r.qE)(new r.nt(.5).subtract(l),new r.nt(0),new r.nt(1)),c=e.outlineColor.multiply(u);return new r.nt(1).subtract(c.a).multiply(o).add(c)}}function L(t,e,i){const n=t.add(new r.ZY(e,0)),o=(0,r.US)(i.animationTexture,n.add(.5).divide(i.animationTextureSize)).xy;return t=t.add(o),(0,r.om)((0,s.A)({animationPointer:t},i),r.Zb,null,t=>{const{out:e}=t;if(!e)throw new Error("out is null");return(0,l.DW)((0,s.A)((0,s.A)({},t),{},{out:e}))})}(0,n.Cg)([(0,o.Pi)(z)],B.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,o.Pi)(u)],B.prototype,"animationInfo",void 0),(0,n.Cg)([(0,o.Pi)(C)],B.prototype,"localTileOffset",void 0),(0,n.Cg)([(0,o.uK)(V)],B.prototype,"visualVariableColor",void 0),(0,n.Cg)([(0,o.uK)(A)],B.prototype,"visualVariableOpacity",void 0),(0,n.Cg)([(0,o.uK)(M)],B.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n.Cg)([(0,o.uK)(T)],B.prototype,"visualVariableSizeScaleStops",void 0),(0,n.Cg)([(0,o.uK)(_)],B.prototype,"visualVariableSizeStops",void 0),(0,n.Cg)([(0,o.uK)(R)],B.prototype,"visualVariableSizeUnitValue",void 0),(0,n.Cg)([(0,o.uK)(P)],B.prototype,"visualVariableRotation",void 0);class U extends Z{}(0,n.Cg)([(0,o.C5)(9,r.Zb)],U.prototype,"tlbr",void 0);class j extends o.Y7{}(0,n.Cg)([(0,o.C5)(13,r.ZY)],j.prototype,"nextPos1",void 0),(0,n.Cg)([(0,o.C5)(14,r.ZY)],j.prototype,"nextPos2",void 0);class Y extends E{}class Q extends B{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}_fragmentPoly(t){const e=(0,r.zi)(t.uv,new r.nt(1)),i=(0,r.jh)(t.tlbr.xy,t.tlbr.zw,e);return this._getColor(i,{color:t.color,distanceToPx:t.distanceToPx,isSDF:t.isSDF,outlineColor:t.outlineColor,outlineSize:t.strokeWidth})}_vertexPoly(t){const{position:e,animationPointer:i,evalParams:s,isOutline:n,unscaledDistanceToPx:o,vvScale:a,strokeWidth:l,scaleSymbolsProportionally:u,scale:p,isSDF:d,baseSize:m,clip:y}=this._vertexPreamble(t,new r.nt(0),t.lineLength||new r.nt(0)),f=this._toNdc(e);let g=L(i,1,s);g=new r.Zb(g.rgb.multiply(g.a),g.a);let v=L(i,2,s);v=new r.Zb(v.rgb.multiply(v.a),v.a);let b=L(i,3,s);b=new r.Zb(b.rgb.multiply(b.a),b.a);const x=L(i,4,s).a,w=L(i,5,s).a,S=k(this,t.id,g,(0,r.or)((0,h.K5)(t.bitset,c.c.bitset.colorLocked),new r.x(n))),C=(0,r.jh)(S,v,b),z=O(this,t.id),V=(0,r.jh)(z,x,w),A=C.multiply(V),P=this.clip(t.id,t.zoomRange).add(y.multiply(2)),M=o.multiply(a);return{unscaledDistanceToPx:o,vvScale:a,strokeWidth:l,scaleSymbolsProportionally:u,scale:p,isSDF:d,baseSize:m,ndc:f,color:A,z:P,isOutline:n,evalParams:s,distanceToPx:M}}}function q(t,e,i){const s=i.subtract(e),n=function(t,e){return(0,r.Om)(t,(0,r.S8)(e))}(t.subtract(e),s),o=(0,r.qE)(n.divide((0,r.Bw)(s)),new r.nt(0),new r.nt(1));return(0,r.Io)(t,e.add(o.multiply(i.subtract(e))))}function H(t){const e=(0,r.tn)(t);return(0,r.PM)(e.x.add(e.y).add(e.z),new r.nt(1.05))}function N(t,e,i,s){const n=new r.U(i.x.multiply(s.y).subtract(s.x.multiply(i.y)),s.x.multiply(e.y).subtract(e.x.multiply(s.y)),e.x.multiply(i.y).subtract(i.x.multiply(e.y)),i.y.subtract(s.y),s.y.subtract(e.y),e.y.subtract(i.y),s.x.subtract(i.x),e.x.subtract(s.x),i.x.subtract(e.x)),o=e.x.multiply(i.y.subtract(s.y)),a=i.x.multiply(s.y.subtract(e.y)),l=s.x.multiply(e.y.subtract(i.y)),u=o.add(a).add(l);return new r.nt(1).divide(u).multiply(n.multiply(new r.eB(1,t)))}function K(t,e,i,s){return(0,r.LC)(H(N(t,e,i,s)),new r.nt(1))}function W(t,e,i,s){const n=i.subtract(e),o=s.subtract(e),a=(0,h.tL)(n,o),l=(0,r.Uo)((0,r.Xe)(a,new r.nt(S.M)),(0,r.MM)(a,new r.nt(-S.M)));return(0,r.j1)([(0,r.Uo)((0,r.AU)(l),K(t.xy,e,i,s)),new r.nt(-1)],[!0,()=>{const n=q(t,e,i),o=q(t,i,s),a=q(t,s,e);return(0,r.jk)((0,r.jk)(n,o),a)}])}function G(t){return t.distance.add(1)}function X(t,e,i){const{viewMat3:s,tileMat3:n}=t.view,o=s.multiply(n),a=o.multiply(new r.eB(e.pos,1)),l=o.multiply(new r.eB(i.nextPos1,1)),u=o.multiply(new r.eB(i.nextPos2,1));return W(t.hittestRequest.position,a.xy,l.xy,u.xy)}class $ extends v{}(0,n.Cg)([(0,o.C5)(3,r.Zb)],$.prototype,"color",void 0),(0,n.Cg)([(0,o.C5)(4,r.ZY)],$.prototype,"zoomRange",void 0);class J extends w{constructor(){super(...arguments),this.type="FillShader",this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){const i=O(this,t.id),n=k(this,t.id,t.color).multiply(i),o=this.view.displayViewScreenMat3.multiply(new r.eB(t.pos.xy,1)),a=this.clip(t.id,t.zoomRange);return(0,s.A)({glPosition:new r.Zb(o.xy,a,1),color:n},this.maybeRunHittest(t,e,null))}fragment(t){return this.getFragmentOutput(t.color,t,new r.nt(0))}hittest(t,e){return X(this,t,e)}}(0,n.Cg)([(0,o.uK)(V)],J.prototype,"visualVariableColor",void 0),(0,n.Cg)([(0,o.uK)(A)],J.prototype,"visualVariableOpacity",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)($)),(0,n.Qj)(1,(0,o.hF)(b))],J.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(x))],J.prototype,"fragment",null);class tt extends ${}(0,n.Cg)([(0,o.C5)(5,r.Zb)],tt.prototype,"tlbr",void 0),(0,n.Cg)([(0,o.C5)(6,r.nt)],tt.prototype,"width",void 0),(0,n.Cg)([(0,o.C5)(7,r.nt)],tt.prototype,"height",void 0),(0,n.Cg)([(0,o.C5)(8,r.ZY)],tt.prototype,"offset",void 0),(0,n.Cg)([(0,o.C5)(9,r.ZY)],tt.prototype,"scale",void 0),(0,n.Cg)([(0,o.C5)(10,r.nt)],tt.prototype,"angle",void 0);function et(t,e,i,s,n){const o=(0,r.LC)((0,h.mh)(n,S.Fz),(0,r.fV)(1)),a=(0,h.Rj)(new r.Zb(t,0));return(0,r.Tk)(o,(0,r.w0)(s.divide(e.x),i.divide(e.y),0,(0,r.ze)(i.divide(e.x)),s.divide(e.y),0,(0,h._9)((0,r.Zc)(a,0)),(0,h._9)((0,r.Zc)(0,a)),1),(0,r.w0)(s.divide(e.x),i.divide(e.y),0,(0,r.ze)(i.divide(e.x)),s.divide(e.y),0,0,0,1))}function it(t,e){const i=t.view.requiredZoomFactor,s=new r.ZY(e.width,e.height),n=s.multiply(e.scale).multiply(i),o=e.angle.multiply(S.rp),a=(0,r.F8)(o),l=(0,r.gn)(o),u=et(e.id,n,a,l,e.bitset),c=t.localTileOffset.getPatternOffsetAtTileOrigin(s,a,l),p=i.multiply(e.scale).multiply(e.offset.subtract(c)).divide(n),d=new r.eB(e.pos,1),m=u.multiply(d).xy.subtract(p),y=e.tlbr.divide(t.mosaicInfo.size.xyxy);let f=(0,h.mh)(e.bitset,S.cn);return null!=t.visualVariableColor&&(f=(0,r.Tk)((0,h.M8)(t.storage.getColorValue(e.id)),new r.nt(0),f)),{tileTextureCoord:m,tlbr:y,sampleAlphaOnly:f}}function st(t,e){const i=(0,r.zi)(e.tileTextureCoord,new r.nt(1)),s=(0,r.jh)(e.tlbr.xy,e.tlbr.zw,i);let n=(0,r.US)(t.mosaicInfo.texture,s);return n=(0,r.Tk)((0,r.MM)(e.sampleAlphaOnly,new r.nt(.5)),n.aaaa,n),e.color.multiply(n)}class nt extends J{constructor(){super(...arguments),this.type="ComplexFillShader"}vertex(t,e){return(0,s.A)((0,s.A)({},super.vertex(t,e)),it(this,t))}fragment(t){const e=st(this,t);return this.getFragmentOutput(e,t,new r.nt(0))}}(0,n.Cg)([(0,o.Pi)(z)],nt.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,o.Pi)(C)],nt.prototype,"localTileOffset",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(tt)),(0,n.Qj)(1,(0,o.hF)(b))],nt.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],nt.prototype,"fragment",null);class ot extends Q{constructor(){super(...arguments),this.type="AnimatedFillShader"}vertex(t,e){const{distanceToPx:i,ndc:n,z:o,color:a,isOutline:l,strokeWidth:u,isSDF:c,scale:p,scaleSymbolsProportionally:d}=this._vertexPoly(t),h=this.view.requiredZoomFactor,m=t.sizing.xy,y=m.multiply(h),f=new r.nt(0),g=(0,r.F8)(f),v=(0,r.gn)(f),b=et(t.id,y,g,v,t.bitset),x=this.localTileOffset.getPatternOffsetAtTileOrigin(m,g,v),w=h.multiply(t.offset.subtract(x)).divide(y),S=new r.eB(t.pos,1),C=b.multiply(S).xy.subtract(w),z=t.tlbr.divide(this.mosaicInfo.size.xyxy);return(0,s.A)({glPosition:new r.Zb(n,o,1),tlbr:z,uv:C,color:a.multiply(new r.nt(1).subtract(l)),outlineColor:a.multiply(l),distanceToPx:i,strokeWidth:u.multiply((0,r.jh)(new r.nt(1),p,d)),isOutline:l,isSDF:c},this.maybeRunHittest(t,e,{}))}fragment(t){const e=this._fragmentPoly(t);return this.getFragmentOutput(e,t)}hittest(t,e,i){return X(this,t,e)}}(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(U)),(0,n.Qj)(1,(0,o.hF)(j))],ot.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Y))],ot.prototype,"fragment",null);class rt extends v{}(0,n.Cg)([(0,o.C5)(3,r.Zb)],rt.prototype,"color",void 0),(0,n.Cg)([(0,o.C5)(4,r.ZY)],rt.prototype,"offset",void 0),(0,n.Cg)([(0,o.C5)(5,r.ZY)],rt.prototype,"normal",void 0),(0,n.Cg)([(0,o.C5)(6,r.nt)],rt.prototype,"halfWidth",void 0),(0,n.Cg)([(0,o.C5)(7,r.nt)],rt.prototype,"referenceHalfWidth",void 0),(0,n.Cg)([(0,o.C5)(8,r.ZY)],rt.prototype,"zoomRange",void 0);class at extends x{}class lt extends o.k2{}function ut(t){return(0,r.T9)(new r.nt(S.Fb).multiply((0,r.PM)(t,new r.nt(S.J5))),new r.nt(1))}function ct(t,e){const{halfWidth:i,normal:s}=t,n=ut(i),o=(0,r.Bw)(s).multiply(i);return(0,r.qE)(n.multiply(i.subtract(o)).divide(e.add(n).subtract(new r.nt(1))),new r.nt(0),new r.nt(1))}function pt(t,e){const{id:i,offset:s,pos:n,normal:o,zoomRange:a}=e,{displayViewScreenMat3:l,displayViewMat3:u}=t.view,c=k(t,i,e.color),p=O(t,i),d=function(t,e){const{id:i,halfWidth:s,referenceHalfWidth:n}=e;if(F(t)){const e=D(t,i,new r.nt(2).multiply(n));return new r.nt(.5).multiply(s.divide((0,r.T9)(n,new r.nt(S.Ni)))).multiply(e)}return s}(t,e),h=new r.nt(.5).multiply(t.antialiasingControls.antialiasing),m=(0,r.T9)(d.add(h),new r.nt(.45)).add(new r.nt(.1).multiply(h)),y=ut(m).multiply(m).multiply(s),f=u.multiply(new r.eB(y,new r.nt(0))),g=l.multiply(new r.eB(n,new r.nt(1))).add(f),v=new r.nt(2).multiply((0,r.PM)(d,new r.nt(0))).add(t.clip(i,a)),b=new r.Zb(g.xy,v,1);return{color:c,opacity:p,halfWidth:m,normal:o,scaledOffset:y,scaledHalfWidth:d,glPosition:new r.Zb(b.xy,v,1)}}function dt(t,e){const{opacity:i,color:s}=t,n=ct(t,e);return i.multiply(s).multiply(n)}(0,n.Cg)([(0,o.Pi)(r.nt)],lt.prototype,"antialiasing",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],lt.prototype,"blur",void 0);class ht extends w{constructor(){super(...arguments),this.type="LineShader",this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){const i=pt(this,t);return(0,s.A)((0,s.A)({},i),this.maybeRunHittest(t,e,i.halfWidth))}fragment(t){const e=dt(t,this.antialiasingControls.blur);return this.getFragmentOutput(e,t)}hittest(t,e,i){const{viewMat3:s,tileMat3:n}=this.view,o=s.multiply(n),a=o.multiply(new r.eB(t.pos,1)),l=o.multiply(new r.eB(e.nextPos1,1)),u=o.multiply(new r.eB(e.nextPos2,1)),{distance:c,smallSymbolDistance:p,smallSymbolSizeThreshold:d}=this.hittestRequest,h=(0,r.PM)(i,d.multiply(.5)).multiply(c.subtract(p)),m=this.hittestRequest.position;return(0,r.jk)(q(m,a.xy,l.xy),q(m,a.xy,u.xy)).subtract(i).add(h)}}(0,n.Cg)([(0,o.Pi)(lt)],ht.prototype,"antialiasingControls",void 0),(0,n.Cg)([(0,o.uK)(V)],ht.prototype,"visualVariableColor",void 0),(0,n.Cg)([(0,o.uK)(A)],ht.prototype,"visualVariableOpacity",void 0),(0,n.Cg)([(0,o.uK)(M)],ht.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n.Cg)([(0,o.uK)(T)],ht.prototype,"visualVariableSizeScaleStops",void 0),(0,n.Cg)([(0,o.uK)(_)],ht.prototype,"visualVariableSizeStops",void 0),(0,n.Cg)([(0,o.uK)(R)],ht.prototype,"visualVariableSizeUnitValue",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(rt)),(0,n.Qj)(1,(0,o.hF)(b))],ht.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(at))],ht.prototype,"fragment",null);class mt extends U{}(0,n.Cg)([(0,o.C5)(10,r.nt)],mt.prototype,"accumulatedDistance",void 0),(0,n.Cg)([(0,o.C5)(11,r.ZY)],mt.prototype,"normal",void 0),(0,n.Cg)([(0,o.C5)(12,r.ZY)],mt.prototype,"segmentDirection",void 0);class yt extends Q{constructor(){super(...arguments),this.type="AnimatedLineShader"}vertex(t,e){const{animationPointerAndBaseSizeAndReferenceSize:i}=t,n=i.xy,{distanceToPx:o,ndc:a,z:l,color:u,isOutline:c,strokeWidth:p,isSDF:d,baseSize:h,scale:m,scaleSymbolsProportionally:y,evalParams:f}=this._vertexPoly(t),g=t.sizing.xy,v=g.x.multiply(h).divide(g.y),b=L(n,6,f).a,x=t.accumulatedDistance.subtract(b),{normal:w}=t,S=t.normal.y,C=x.divide(this.view.displayZoomFactor).add((0,r.Om)(t.segmentDirection,t.offset)).divide(v),z=S.add(1).divide(2),V=new r.ZY(C,z),A=t.tlbr.divide(this.mosaicInfo.size.xyxy),P=h.divide(2),M=new r.nt(.5).multiply(this.antialiasingControls.antialiasing),T=(0,r.T9)(P.add(M),new r.nt(.45)).add(new r.nt(.1).multiply(M));return(0,s.A)({glPosition:new r.Zb(a,l,1),tlbr:A,uv:V,color:u.multiply(new r.nt(1).subtract(c)),outlineColor:u.multiply(c),distanceToPx:o,strokeWidth:p.multiply((0,r.jh)(new r.nt(1),m,y)),isOutline:c,isSDF:d,halfWidth:T,normal:w},this.maybeRunHittest(t,e,T))}fragment(t){const e=this._fragmentPoly(t),i=ct(t,this.antialiasingControls.blur),{halfWidth:s,normal:n}=t,o=ut(s),a=(0,r.Bw)(n).multiply(s),l=(0,r.qE)(o.multiply(s.subtract(a)).divide(o.subtract(new r.nt(1))),new r.nt(0),new r.nt(1));return this.getFragmentOutput(e.multiply(l).multiply(i),t)}hittest(t,e,i){const{viewMat3:s,tileMat3:n}=this.view,o=s.multiply(n),a=o.multiply(new r.eB(t.pos,1)),l=o.multiply(new r.eB(e.nextPos1,1)),u=o.multiply(new r.eB(e.nextPos2,1)),{distance:c,smallSymbolDistance:p,smallSymbolSizeThreshold:d}=this.hittestRequest,h=(0,r.PM)(i,d.multiply(.5)).multiply(c.subtract(p)),m=this.hittestRequest.position;return(0,r.jk)(q(m,a.xy,l.xy),q(m,a.xy,u.xy)).subtract(i).add(h)}}(0,n.Cg)([(0,o.Pi)(lt)],yt.prototype,"antialiasingControls",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(mt)),(0,n.Qj)(1,(0,o.hF)(j))],yt.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends Y{}))],yt.prototype,"fragment",null);class ft extends Z{}(0,n.Cg)([(0,o.C5)(9,r.ZY)],ft.prototype,"uv",void 0),(0,n.Cg)([(0,o.C5)(10,r.nt)],ft.prototype,"angle",void 0);class gt extends o.Y7{}(0,n.Cg)([(0,o.C5)(11,r.ZY)],gt.prototype,"offsetNextVertex1",void 0),(0,n.Cg)([(0,o.C5)(12,r.ZY)],gt.prototype,"offsetNextVertex2",void 0),(0,n.Cg)([(0,o.C5)(13,r.ZY)],gt.prototype,"textureUVNextVertex1",void 0),(0,n.Cg)([(0,o.C5)(14,r.ZY)],gt.prototype,"textureUVNextVertex2",void 0);function vt(t,e,i,s){return e.multiply(t.x).add(i.multiply(t.y)).add(s.multiply(t.z))}class bt extends B{constructor(){super(...arguments),this.type="AnimatedMarkerShader",this.computeAttributes={offset:["offsetNextVertex1","offsetNextVertex2"],uv:["textureUVNextVertex1","textureUVNextVertex2"]}}vertex(t,e){const i=t.uv.divide(this.mosaicInfo.size),{position:n,animationPointer:o,evalParams:a,isOutline:l,unscaledDistanceToPx:u,vvScale:p,strokeWidth:d,scaleSymbolsProportionally:m,scale:y,isSDF:f,baseSize:g,clip:v}=this._vertexPreamble(t,t.angle,t.lineLength||new r.nt(0)),b=this._toNdc(n);let x=L(o,1,a);x=new r.Zb(x.rgb.multiply(x.a),x.a);let w=L(o,2,a);w=new r.Zb(w.rgb.multiply(w.a),w.a);let S=L(o,3,a);S=new r.Zb(S.rgb.multiply(S.a),S.a);const C=L(o,4,a).a,z=L(o,5,a).a,V=k(this,t.id,x,(0,r.or)((0,h.K5)(t.bitset,c.c.bitset.colorLocked),new r.x(l))),A=(0,r.jh)(V,w,S),P=O(this,t.id),M=(0,r.jh)(P,C,z),T=A.multiply(M),_=this.clip(t.id,t.zoomRange).add(v.multiply(2)),R=u.multiply(p);return(0,s.A)({glPosition:new r.Zb(b,_,1),uv:i,color:T.multiply(new r.nt(1).subtract(l)),outlineColor:T.multiply(l),distanceToPx:R,strokeWidth:d.multiply((0,r.jh)(new r.nt(1),y,m)),isOutline:l,isSDF:f},this.maybeRunHittest(t,e,{pos:t.pos,size:g,sizeCorrection:new r.nt(1),isMapAligned:new r.nt(1),vvRotationMat3:new r.U(1,0,0,0,1,0,0,0,1),placementMat3:new r.U(1,0,0,0,1,0,0,0,1),outlineSize:new r.nt(1),distanceToPx:R,isSDF:f}))}fragment(t){let e=this._getColor(t.uv,{color:t.color,distanceToPx:t.distanceToPx,isSDF:t.isSDF,outlineColor:t.outlineColor,outlineSize:t.strokeWidth});return a.H.spotlightAnimatedSymbols&&(e=e.add(new r.Zb(0,.3,0,.3))),this.getFragmentOutput(e,t)}hittest(t,e,i){return(0,r.Tk)((0,r.Xe)(i.size,this.hittestRequest.smallSymbolSizeThreshold),this._hittestSmallMarker(t,e,i),this._hittestMarker(t,e,i))}_hittestSmallMarker(t,e,i){const{position:s,distance:n,smallSymbolDistance:o}=this.hittestRequest,a=n.subtract(o),{viewMat3:l,tileMat3:u}=this.view,c=l.multiply(u).multiply(new r.eB(i.pos,1)).xy,p=i.size.multiply(.5);return(0,r.Io)(c,s).subtract(p).add(a)}_hittestMarker(t,e,i){const n=this._vertexPreamble((0,s.A)({},t),t.angle,new r.nt(0)).position,o=this._vertexPreamble((0,s.A)((0,s.A)({},t),{},{offset:e.offsetNextVertex1}),t.angle,new r.nt(0)).position,a=this._vertexPreamble((0,s.A)((0,s.A)({},t),{},{offset:e.offsetNextVertex2}),t.angle,new r.nt(0)).position,l=this.hittestRequest.position,u=this.hittestRequest.distance,c=W(l,n,o,a);return(0,r.Tk)((0,r.MM)(c,u),c,this._hittestSamples(n,o,a,t,e,i))}_hittestSamples(t,e,i,s,n,o){const{outlineSize:a,isSDF:l,distanceToPx:u}=o,c=this.hittestRequest.position,p=this.hittestRequest.distance,d=N(c.add(new r.ZY((0,r.ze)(p),(0,r.ze)(p))),t,e,i),h=N(c.add(new r.ZY(0,(0,r.ze)(p))),t,e,i),m=N(c.add(new r.ZY(p,(0,r.ze)(p))),t,e,i),y=N(c.add(new r.ZY((0,r.ze)(p),0)),t,e,i),f=N(c,t,e,i),g=N(c.add(new r.ZY(p,0)),t,e,i),v=N(c.add(new r.ZY((0,r.ze)(p),p)),t,e,i),b=N(c.add(new r.ZY(0,p)),t,e,i),x=N(c.add(new r.ZY(p,p)),t,e,i),w=s.uv.divide(this.mosaicInfo.size),S=n.textureUVNextVertex1.divide(this.mosaicInfo.size),C=n.textureUVNextVertex2.divide(this.mosaicInfo.size),z={color:new r.Zb(1,1,1,1),outlineSize:a,outlineColor:new r.Zb(1,1,1,1),isSDF:l,distanceToPx:u};let V=new r.nt(0);return V=V.add(H(d).multiply(this._getColor(vt(d,w,S,C),z).a)),V=V.add(H(h).multiply(this._getColor(vt(h,w,S,C),z).a)),V=V.add(H(m).multiply(this._getColor(vt(m,w,S,C),z).a)),V=V.add(H(y).multiply(this._getColor(vt(y,w,S,C),z).a)),V=V.add(H(f).multiply(this._getColor(vt(f,w,S,C),z).a)),V=V.add(H(g).multiply(this._getColor(vt(g,w,S,C),z).a)),V=V.add(H(v).multiply(this._getColor(vt(v,w,S,C),z).a)),V=V.add(H(b).multiply(this._getColor(vt(b,w,S,C),z).a)),V=V.add(H(x).multiply(this._getColor(vt(x,w,S,C),z).a)),(0,r.PM)(V,new r.nt(.05)).multiply(G(this.hittestRequest))}}(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(ft)),(0,n.Qj)(1,(0,o.hF)(gt))],bt.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends E{}))],bt.prototype,"fragment",null);var xt=i(86300),wt=i(85827),St=i(70479);class Ct extends St.j{constructor(){super(...arguments),this.symbologyPlane=0,this._input=null}}var zt=i(63584);function Vt(t){const e=1/t;return{antialiasing:e,blur:0+e}}class At extends Ct{render(t,e){const{context:i,painter:n,pixelRatio:o}=t,{target:r}=e,{freezeGlobalTime:l}=a.H,u=n.textureManager.animationStore.getTexture(i,0),c=[2/t.state.size[0],0,0,0,-2/t.state.size[1],0,-1,1,1],p=Array.from((0,xt.B8)((0,wt.vt)(),c)),d=Array.from((0,xt.lw)((0,wt.vt)(),p,r.transforms.displayViewScreenMat3)),h=e.instance.getInput(),m=n.textureManager.getMosaicInfo(t,e.textureKey,!1),{optionalAttributes:y}=h,f=y.zoomRange,g=y.value1Position2Value2,v="accumulatedDistance"in y&&y.accumulatedDistance,b="segmentDirection"in y&&y.segmentDirection,x="normal"in y&&y.normal;n.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,h.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(o),mosaicInfo:m,animationInfo:{globalTime:t.animationsEnabled?!1===l?t.time/1e3:l:0,animationTextureSize:[u.descriptor.width,u.descriptor.height],animationTexture:{unit:6,texture:u},toScreen:d,toNdc:c,mapRotation:t.state.rotation,pixelRatio:t.state.pixelRatio},localTileOffset:(0,zt.Pr)(e.target)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:{zoomRange:f,value1Position2Value2:g,accumulatedDistance:v,segmentDirection:b,normal:x},useComputeBuffer:(0,zt.Eq)(t)}),n.setPipelineState((0,s.A)({},(0,zt.Qu)(t))),n.submitDraw(t,e),!1===l&&t.animationsEnabled&&r.requestRender()}}class Pt extends o.ZA{}(0,n.Cg)([(0,o.C5)(0,r.ZY)],Pt.prototype,"pos",void 0);class Mt extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.nt)],Mt.prototype,"dotSize",void 0);class Tt extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.z7)],Tt.prototype,"locations",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],Tt.prototype,"pixelRatio",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],Tt.prototype,"tileZoomFactor",void 0);class _t extends o.A{constructor(){super(...arguments),this.type="DotDensityPointShader"}vertex(t){const e=new r.U(1,0,0,0,-1,0,0,1,1).multiply(new r.eB(t.pos.xy.divide(p.CQ),1)),i=(0,r.US)(this.draw.locations,e.xy),s=(0,r.T9)(this.instance.dotSize.divide(2),new r.nt(1));let n=new r.nt(0);n=n.add((0,r.PM)(i.a,new r.nt(1e-6)).multiply(2));let o=s.add(this.instance.dotSize);const a=this.view.displayViewScreenMat3.multiply(new r.eB(t.pos.add(.5),1)),l=new r.Zb(a.xy,n,1),u=this.instance.dotSize.divide(o),c=new r.nt(-1).divide(s.divide(o));return o=o.multiply(this.draw.pixelRatio.multiply(this.draw.tileZoomFactor)),{glPosition:l,glPointSize:o,color:i,ratio:u,invEdgeRatio:c}}fragment(t){const e=(0,r.Bw)(t.glPointCoord.subtract(.5)).multiply(2),i=(0,r.TF)(new r.nt(0),new r.nt(1),t.invEdgeRatio.multiply(e.subtract(t.ratio)).add(1)),s=new o.mm;return s.fragColor=t.color.multiply(i),s}}(0,n.Cg)([(0,o.Pi)(Mt)],_t.prototype,"instance",void 0),(0,n.Cg)([(0,o.Pi)(Tt)],_t.prototype,"draw",void 0),(0,n.Cg)([(0,o.Pi)(g)],_t.prototype,"view",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Pt))],_t.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],_t.prototype,"fragment",null);class Rt extends v{}(0,n.Cg)([(0,o.C5)(3,r.nt)],Rt.prototype,"inverseArea",void 0);class Ft extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.Zb,2))],Ft.prototype,"isActive",void 0),(0,n.Cg)([(0,o.Pi)(r.My.ofType(r.Zb,8))],Ft.prototype,"colors",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],Ft.prototype,"dotValue",void 0);class Dt extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.z7)],Dt.prototype,"dotTexture0",void 0),(0,n.Cg)([(0,o.Pi)(r.z7)],Dt.prototype,"dotTexture1",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],Dt.prototype,"tileZoomFactor",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],Dt.prototype,"pixelRatio",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],Dt.prototype,"tileDotsOverArea",void 0);class kt extends w{constructor(){super(...arguments),this.type="DotDensityPolygonShader"}_dotThreshold(t,e,i){return t.divide(e).divide(i)}vertex(t){const e=new r.U(2/p.CQ,0,0,0,-2/p.CQ,0,-1,1,1).multiply(new r.eB(t.pos,1)),i=this.clip(t.id),s=new r.Zb(e.xy,i,1),n=this.storage.getVVData(t.id).multiply(this.instance.isActive.get(0)).multiply(t.inverseArea),o=this.storage.getDataDrivenData0(t.id).multiply(this.instance.isActive.get(1)).multiply(t.inverseArea),a=this.draw.tileZoomFactor.multiply(p.CQ).divide(this.draw.pixelRatio),l=this._dotThreshold(n,this.instance.dotValue,this.draw.tileDotsOverArea),u=this._dotThreshold(o,this.instance.dotValue,this.draw.tileDotsOverArea),c=t.pos.add(.5).divide(a);return{glPosition:s,color:new r.Zb(0,0,0,0),textureCoords:c,thresholds0:l,thresholds1:u}}fragment(t){const e=new o.mm,i=(0,r.US)(this.draw.dotTexture0,t.textureCoords),s=(0,r.US)(this.draw.dotTexture1,t.textureCoords),n=t.thresholds0.subtract(i),a=t.thresholds1.subtract(s);let l;const u=r.$I.fromColumns(this.instance.colors[0],this.instance.colors[1],this.instance.colors[2],this.instance.colors[3]),c=r.$I.fromColumns(this.instance.colors[4],this.instance.colors[5],this.instance.colors[6],this.instance.colors[7]);if(this.blending){const t=(0,r.PM)(new r.nt(0),n),e=(0,r.PM)(new r.nt(0),a),i=(0,r.Om)(t,n).add((0,r.Om)(e,a)),s=(0,r.PM)(i,new r.nt(0)),o=new r.nt(1).subtract(s),p=i.add(s),d=n.multiply(t).divide(p),h=a.multiply(e).divide(p),m=u.multiply(d).add(c.multiply(h));l=o.multiply(m)}else{const t=(0,r.T9)((0,h.xf)(n),(0,h.xf)(a)),e=(0,r.PM)(t,new r.nt(0)),i=new r.nt(1).subtract(e),s=(0,r.PM)(t,n),o=(0,r.PM)(t,a),p=u.multiply(s).add(c.multiply(o));l=i.multiply(p)}return e.fragColor=l,e}hittest(t){return G(this.hittestRequest)}}(0,n.Cg)([o.E8],kt.prototype,"blending",void 0),(0,n.Cg)([(0,o.Pi)(Ft)],kt.prototype,"instance",void 0),(0,n.Cg)([(0,o.Pi)(Dt)],kt.prototype,"draw",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Rt))],kt.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(x))],kt.prototype,"fragment",null);var Ot=i(47249),It=i(16946),Zt=i(93345),Et=i(12331),Bt=i(62881),Lt=i(88800),Ut=i(80895),jt=i(96673);const Yt={pos:{count:2,type:Zt.pe.UNSIGNED_SHORT}};class Qt{constructor(){this._dotTextureSize=0,this._dotTextures=null,this._dotMesh=null}destroy(){this._disposeTextures(),this._dotFBO&&this._dotFBO.dispose(),this._dotMesh&&this._dotMesh.destroy()}getFBO(t){if(null==this._dotFBO){const e=p.CQ,i=p.CQ,s=new jt.R(e,i);s.samplingMode=9728,s.wrapMode=33071;const n=new Bt.l(t,new Lt.q(Zt.iE.DEPTH24_STENCIL8,e,i));this._dotFBO=new Et.H(t,s,n)}return this._dotFBO}getDotDensityMesh(t){if(null==this._dotMesh){const e=p.CQ,i=e*e,s=2,n=new Int16Array(i*s);for(let t=0;t<e;t++)for(let i=0;i<e;i++)n[s*(i+t*e)]=i,n[s*(i+t*e)+1]=t;this._dotMesh=It.g.create(t,{primitive:Zt.WR.POINTS,vertex:n,count:i,layout:Yt})}return this._dotMesh}getDotDensityTextures(t,e,i){if(this._dotTextureSize===e&&this._seed===i||(this._disposeTextures(),this._dotTextureSize=e,this._seed=i),null===this._dotTextures){const s=new Ot.A(i);this._dotTextures=[this._allocDotDensityTexture(t,e,s),this._allocDotDensityTexture(t,e,s)]}return this._dotTextures}_disposeTextures(){if(this._dotTextures){for(let t=0;t<this._dotTextures.length;t++)this._dotTextures[t].dispose();this._dotTextures=null}}_allocDotDensityTexture(t,e,i){const s=new Float32Array(e*e*4);for(let o=0;o<s.length;o++)s[o]=i.getFloat();const n=new jt.R(e);return n.dataType=Zt.ld.FLOAT,n.samplingMode=9728,new Ut.g(t,n,s)}}class qt extends v{}(0,n.Cg)([(0,o.C5)(3,r.ZY)],qt.prototype,"offset",void 0),(0,n.Cg)([(0,o.C5)(4,r.Zb)],qt.prototype,"color",void 0),(0,n.Cg)([(0,o.C5)(5,r.ZY)],qt.prototype,"normal",void 0),(0,n.Cg)([(0,o.C5)(6,r.nt)],qt.prototype,"halfWidth",void 0),(0,n.Cg)([(0,o.C5)(7,r.nt)],qt.prototype,"referenceHalfWidth",void 0),(0,n.Cg)([(0,o.C5)(8,r.ZY)],qt.prototype,"zoomRange",void 0);class Ht extends at{}function Nt(t,e,i){const{id:n,bitset:o}=e,a=(0,h.mh)(o,S.Xx),l=(0,r.MM)(a,new r.nt(.5)),u=pt(t,e),c=(0,r.Tk)(l,u.halfWidth,new r.nt(0)),p=O(t,n),d=k(t,n,e.color),m=(0,r.Tk)(l,(0,r.Tk)((0,h.K5)(o,S.bB),d,e.color),d.multiply(p)),y=t.view.displayViewScreenMat3.multiply(new r.eB(e.pos.xy,1)),f=t.clip(e.id),g=new r.Zb(y.xy,f,1),v=(0,r.Tk)(l,u.glPosition,g),b=i&&t.maybeRunHittest(e,i,l);return(0,s.A)({isOutline:a,color:m,opacity:new r.nt(1),halfWidth:c,normal:u.normal,glPosition:v},b)}class Kt extends w{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,n.Cg)([(0,o.Pi)(lt)],Kt.prototype,"antialiasingControls",void 0),(0,n.Cg)([(0,o.uK)(V)],Kt.prototype,"visualVariableColor",void 0),(0,n.Cg)([(0,o.uK)(A)],Kt.prototype,"visualVariableOpacity",void 0),(0,n.Cg)([(0,o.uK)(M)],Kt.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n.Cg)([(0,o.uK)(T)],Kt.prototype,"visualVariableSizeScaleStops",void 0),(0,n.Cg)([(0,o.uK)(_)],Kt.prototype,"visualVariableSizeStops",void 0),(0,n.Cg)([(0,o.uK)(R)],Kt.prototype,"visualVariableSizeUnitValue",void 0);class Wt extends Kt{constructor(){super(...arguments),this.type="OutlineFillShader"}vertex(t,e){return Nt(this,t,e)}fragment(t){const{color:e,isOutline:i}=t,s=(0,r.MM)(i,new r.nt(.5)),n=dt(t,this.antialiasingControls.blur),o=(0,r.Tk)(s,n,e),a=(0,r.Tk)(s,new r.nt(1/255),new r.nt(0));return this.getFragmentOutput(o,t,a)}hittest(t,e,i){return(0,r.Tk)(i,G(this.hittestRequest),X(this,t,e))}}(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(qt)),(0,n.Qj)(1,(0,o.hF)(b))],Wt.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Ht))],Wt.prototype,"fragment",null);class Gt extends ${}(0,n.Cg)([(0,o.C5)(5,r.Zb)],Gt.prototype,"tlbr",void 0),(0,n.Cg)([(0,o.C5)(6,r.nt)],Gt.prototype,"inverseRasterizationScale",void 0);function Xt(t,e){const i=e.tlbr.xy,s=e.tlbr.zw,n=s.x.subtract(i.x),o=i.y.subtract(s.y),a=new r.ZY(n,o).multiply(e.inverseRasterizationScale),l=a.multiply(t.view.requiredZoomFactor),u=function(t){const e=new r.nt(1),i=new r.nt(0);return new r.U(e.divide(t.x),i.divide(t.y),0,(0,r.ze)(i.divide(t.x)),e.divide(t.y),0,0,0,1)}(l),c=t.localTileOffset.getPatternOffsetAtTileOrigin(a).divide(l),p=new r.eB(e.pos,1);return{tileTextureCoord:u.multiply(p).xy.subtract(c),tlbr:e.tlbr.divide(t.mosaicInfo.size.xyxy)}}function $t(t,e){const i=(0,r.zi)(t.tileTextureCoord,new r.nt(1)),s=(0,r.jh)(t.tlbr.xy,t.tlbr.zw,i),n=(0,r.US)(e.texture,s);return t.color.multiply(n)}class Jt extends J{constructor(){super(...arguments),this.type="PatternFillShader"}vertex(t,e){return(0,s.A)((0,s.A)({},super.vertex(t,e)),Xt(this,t))}fragment(t){const e=$t(t,this.mosaicInfo);return this.getFragmentOutput(e,t,new r.nt(0))}}(0,n.Cg)([(0,o.Pi)(z)],Jt.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,o.Pi)(C)],Jt.prototype,"localTileOffset",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Gt)),(0,n.Qj)(1,(0,o.hF)(b))],Jt.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],Jt.prototype,"fragment",null);class te extends qt{}(0,n.Cg)([(0,o.C5)(9,r.Zb)],te.prototype,"tlbr",void 0),(0,n.Cg)([(0,o.C5)(10,r.nt)],te.prototype,"inverseRasterizationScale",void 0);class ee extends Ht{}class ie extends Wt{constructor(){super(...arguments),this.type="PatternOutlineFillShader"}vertex(t,e){return(0,s.A)((0,s.A)({},Nt(this,t,e)),Xt(this,t))}fragment(t){const{isOutline:e}=t,i=(0,r.MM)(e,new r.nt(.5)),s=dt(t,this.antialiasingControls.blur),n=$t(t,this.mosaicInfo),o=(0,r.Tk)(i,s,n),a=(0,r.Tk)(i,new r.nt(1/255),new r.nt(0));return this.getFragmentOutput(o,t,a)}}(0,n.Cg)([(0,o.Pi)(z)],ie.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,o.Pi)(C)],ie.prototype,"localTileOffset",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(te)),(0,n.Qj)(1,(0,o.hF)(b))],ie.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(ee))],ie.prototype,"fragment",null);const se=1/S.cZ;class ne extends v{}(0,n.Cg)([(0,o.C5)(3,r.Zb)],ne.prototype,"color",void 0),(0,n.Cg)([(0,o.C5)(4,r.Zb)],ne.prototype,"tlbr",void 0),(0,n.Cg)([(0,o.C5)(5,r.nt)],ne.prototype,"angle",void 0),(0,n.Cg)([(0,o.C5)(6,r.nt)],ne.prototype,"aux1",void 0),(0,n.Cg)([(0,o.C5)(7,r.nt)],ne.prototype,"aux2",void 0),(0,n.Cg)([(0,o.C5)(8,r.ZY)],ne.prototype,"aux3",void 0),(0,n.Cg)([(0,o.C5)(9,r.ZY)],ne.prototype,"aux4",void 0),(0,n.Cg)([(0,o.C5)(10,r.ZY)],ne.prototype,"zoomRange",void 0);class oe extends Kt{constructor(){super(...arguments),this.type="ComplexOutlineFillShader"}vertex(t,e){const{aux1:i,aux2:n,aux3:o,aux4:a}=t,l=(0,s.A)((0,s.A)({},t),{},{width:i,height:n,offset:o,scale:a.multiply(se)}),u=Nt(this,(0,s.A)((0,s.A)({},t),{},{halfWidth:i,referenceHalfWidth:n,offset:o,normal:a.subtract(S.v9).multiply(se)})),c=it(this,l),p=(0,r.MM)(u.isOutline,new r.nt(.5));return(0,s.A)((0,s.A)((0,s.A)({},u),c),Object.assign({},this.maybeRunHittest(t,e,p)))}fragment(t){const{isOutline:e}=t,i=(0,r.MM)(e,new r.nt(.5)),s=dt(t,this.antialiasingControls.blur),n=st(this,t),o=(0,r.Tk)(i,s,n),a=(0,r.Tk)(i,new r.nt(1/255),new r.nt(0));return this.getFragmentOutput(o,t,a)}hittest(t,e,i){return(0,r.Tk)(i,G(this.hittestRequest),X(this,t,e))}}(0,n.Cg)([(0,o.Pi)(z)],oe.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,o.Pi)(C)],oe.prototype,"localTileOffset",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(ne)),(0,n.Qj)(1,(0,o.hF)(b))],oe.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends ee{}))],oe.prototype,"fragment",null);var re=i(4037);class ae extends ${}(0,n.Cg)([(0,o.C5)(5,r.Zb)],ae.prototype,"tlbr",void 0),(0,n.Cg)([(0,o.C5)(6,r.ZY)],ae.prototype,"relativePosition",void 0),(0,n.Cg)([(0,o.C5)(7,r.nt)],ae.prototype,"gradientMethod",void 0),(0,n.Cg)([(0,o.C5)(8,r.ZY)],ae.prototype,"relativeGradientSize",void 0);class le extends J{constructor(){super(...arguments),this.type="GradientFillShader"}vertex(t,e){const{tlbr:i,relativePosition:n,gradientMethod:o,relativeGradientSize:a}=t,l=(0,r.Tk)((0,h.K5)(t.bitset,re.Q.isAbsolute),this.view.displayZoomFactor,new r.nt(1));return(0,s.A)((0,s.A)({},super.vertex(t,e)),{},{tlbr:i,relativePosition:n,gradientMethod:o,gradientSize:a.multiply(l),isDiscrete:(0,h.mh)(t.bitset,re.Q.isDiscrete)})}fragment(t){const{tlbr:e,relativePosition:i,gradientMethod:s,gradientSize:n,isDiscrete:o}=t,a=(0,r.Tk)((0,r.MM)(o,new r.nt(.5)),n.subtract(1),new r.ZY(0)),l=(0,r.j1)([(0,r.LC)(s,new r.nt(re.m.rectangular)),()=>{const t=(0,r.tn)(i).add(a).divide(n);return(0,h.zb)((0,r.T9)(t.x,t.y))}],[(0,r.LC)(s,new r.nt(re.m.circular)),(0,h.zb)((0,r.RZ)((0,r.Om)(i,i)).add(a.x).divide(n.x))],[!0,(0,h.zb)(i.x.add(a.x).divide(n.x))]),u=new r.ZY((0,r.qE)(l,new r.nt(0),new r.nt(1)),.5),c=(0,r.jh)(e.xy,e.zw,u).divide(this.mosaicInfo.size),p=(0,r.US)(this.mosaicInfo.texture,c),d=t.color.a;return this.getFragmentOutput(p.multiply(d),t,new r.nt(0))}}(0,n.Cg)([(0,o.Pi)(z)],le.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(ae)),(0,n.Qj)(1,(0,o.hF)(b))],le.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],le.prototype,"fragment",null);var ue=i(76460),ce=i(30726),pe=i(50076);class de{constructor(t,e,i,s){this.dataType=t,this.samplingMode=e,this.pixelFormat=i,this.internalFormat=s}}new de(Zt.ld.HALF_FLOAT,9728,6408,6408);class he{destroy(){this._accumulateFramebuffer=(0,ce.WD)(this._accumulateFramebuffer),this._resolveGradientTexture=(0,ce.WD)(this._resolveGradientTexture),this._prevGradientHash=null,this._qualityProfile=null}get initialized(){return null!=this._accumulateFramebuffer&&null!=this._resolveGradientTexture}get accumulateFramebuffer(){return this._accumulateFramebuffer}get resolveGradientTexture(){return this._resolveGradientTexture}loadQualityProfile(t){if(null==this._qualityProfile){const e=function(t,e){const{textureFloatLinear:i,colorBufferFloat:s}=t.capabilities,n=null===s||void 0===s?void 0:s.textureFloat,o=null===s||void 0===s?void 0:s.textureHalfFloat,r=null===s||void 0===s?void 0:s.floatBlend,a=t.driverTest.floatBufferBlend.result;if(!n&&!o)throw new pe.A("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");if(!(r&&a||o))throw new pe.A("heatmap:missing-float-blend","HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float."+(a?"":" This device claims support for EXT_float_blend, but does not actually support it."));const l=n&&r&&a,u=o,c=i,p=!(null===s||void 0===s||!s.R32F),d=!(null===s||void 0===s||!s.R16F);if(l&&c)return c||e.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),new de(Zt.ld.FLOAT,c?9729:9728,p?6403:6408,p?Zt.H0.R32F:6408);if(u)return new de(Zt.ld.HALF_FLOAT,9729,d?6403:6408,d?Zt.H0.R16F:6408);throw new pe.A("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.")}(t,ue.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.heatmap.HeatmapResources"));this._qualityProfile=(0,s.A)((0,s.A)({},e),{},{defines:{usesHalfFloatPrecision:e.dataType!==Zt.ld.FLOAT}})}return this._qualityProfile}ensureAccumulateFBO(t,e,i){if(null==this._accumulateFramebuffer){const{dataType:s,samplingMode:n,pixelFormat:o,internalFormat:r}=this.loadQualityProfile(t),a=new jt.R(e,i);a.pixelFormat=o,a.internalFormat=r,a.dataType=s,a.samplingMode=n,a.wrapMode=33071;const l=new Lt.q(Zt.iE.DEPTH24_STENCIL8,e,i);this._accumulateFramebuffer=new Et.H(t,a,l)}else{const{width:t,height:s}=this._accumulateFramebuffer;t===e&&s===i||this._accumulateFramebuffer.resize(e,i)}return this._accumulateFramebuffer}ensureResolveGradientTexture(t,e,i){if(null==this._resolveGradientTexture){const e=new jt.R;e.wrapMode=33071,this._resolveGradientTexture=new Ut.g(t,e),this._prevGradientHash=null}return this._prevGradientHash!==e&&(this._resolveGradientTexture.resize(i.length/4,1),this._resolveGradientTexture.setData(i),this._prevGradientHash=e),this._resolveGradientTexture}}function me(t){return t?.25:1}class ye extends v{}(0,n.Cg)([(0,o.C5)(5,r.ZY)],ye.prototype,"offset",void 0);class fe extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.nt)],fe.prototype,"radius",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],fe.prototype,"isFieldActive",void 0);class ge extends w{constructor(){super(...arguments),this.type="HeatmapAccumulateShader",this.usesHalfFloatPrecision=!1}vertex(t){const{radius:e,isFieldActive:i}=this.kernelControls,n=t.offset,o=i.multiply(this.storage.getVVData(t.id).x).add(new r.nt(1).subtract(i)),a=this.view.displayViewScreenMat3.multiply(new r.eB(t.pos,1)).add(this.view.displayViewMat3.multiply(new r.eB(n,0)).multiply(e)),l=this.clip(t.id);return(0,s.A)({glPosition:new r.Zb(a.xy,l,1),offset:n,fieldValue:o,color:new r.Zb(0)},this.maybeRunHittest(t,{},null))}fragment(t){const{offset:e,fieldValue:i}=t,s=(0,r.Bw)(e),n=(0,r.PM)(s,new r.nt(1)),o=new r.nt(1).subtract(s.multiply(s)),a=o.multiply(o),l=n.multiply(a).multiply(i).multiply(new r.nt(me(this.usesHalfFloatPrecision)));return this.getFragmentOutput(new r.Zb(l),t)}hittest(t){const{viewMat3:e,tileMat3:i}=this.view;return function(t,e,i){return(0,r.Io)(t,i).subtract(e)}(e.multiply(i).multiply(new r.eB(t.pos,1)).xy,this.kernelControls.radius,this.hittestRequest.position)}}(0,n.Cg)([o.E8],ge.prototype,"usesHalfFloatPrecision",void 0),(0,n.Cg)([(0,o.Pi)(fe)],ge.prototype,"kernelControls",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(ye))],ge.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],ge.prototype,"fragment",null);class ve extends o.ZA{}(0,n.Cg)([(0,o.C5)(0,r.ZY)],ve.prototype,"position",void 0);class be extends o.HS{}class xe extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.z7)],xe.prototype,"texture",void 0),(0,n.Cg)([(0,o.Pi)(r.ZY)],xe.prototype,"minAndInvRange",void 0),(0,n.Cg)([(0,o.Pi)(r.nt)],xe.prototype,"normalization",void 0);class we extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.z7)],we.prototype,"texture",void 0);class Se extends o.A{constructor(){super(...arguments),this.type="HeatmapResolveShader",this.usesHalfFloatPrecision=!1}vertex(t){return{glPosition:new r.Zb(t.position.multiply(2).subtract(1),1,1),uv:t.position}}fragment(t){const{accumulatedDensity:e,gradient:i}=this;let s=(0,r.US)(e.texture,t.uv).r.divide(new r.nt(me(this.usesHalfFloatPrecision)));s=s.multiply(e.normalization),s=s.subtract(e.minAndInvRange.x).multiply(e.minAndInvRange.y);const n=(0,r.US)(i.texture,new r.ZY(s,.5)),a=new o.mm;return a.fragColor=new r.Zb(n.rgb.multiply(n.a),n.a),a}}(0,n.Cg)([o.E8],Se.prototype,"usesHalfFloatPrecision",void 0),(0,n.Cg)([(0,o.Pi)(xe)],Se.prototype,"accumulatedDensity",void 0),(0,n.Cg)([(0,o.Pi)(we)],Se.prototype,"gradient",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(ve))],Se.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(be))],Se.prototype,"fragment",null);const Ce={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:{write:!1,test:{compare:518,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},ze=(0,s.A)((0,s.A)({},Ce),{},{stencil:!1}),Ve={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:!1};function Ae(t,e){const{referenceScale:i,radius:s}=t.uniforms;return s*(0!==i?i/e.scale:1)}const Pe=360/254;class Me extends v{}(0,n.Cg)([(0,o.C5)(3,r.Zb)],Me.prototype,"color",void 0),(0,n.Cg)([(0,o.C5)(4,r.ZY)],Me.prototype,"offset",void 0),(0,n.Cg)([(0,o.C5)(5,r.ZY)],Me.prototype,"textureUV",void 0),(0,n.Cg)([(0,o.C5)(6,r.ZY)],Me.prototype,"fontAndReferenceSize",void 0),(0,n.Cg)([(0,o.C5)(7,r.Zb)],Me.prototype,"outlineColor",void 0),(0,n.Cg)([(0,o.C5)(8,r.Zb)],Me.prototype,"haloColor",void 0),(0,n.Cg)([(0,o.C5)(9,r.ZY)],Me.prototype,"outlineAndHaloSize",void 0),(0,n.Cg)([(0,o.C5)(10,r.ZY)],Me.prototype,"zoomRange",void 0),(0,n.Cg)([(0,o.C5)(11,r.nt)],Me.prototype,"clipAngle",void 0),(0,n.Cg)([(0,o.C5)(12,r.Zb)],Me.prototype,"referenceSymbol",void 0),(0,n.Cg)([(0,o.C5)(15,r.nt)],Me.prototype,"visibility",void 0);class Te extends o.Y7{}(0,n.Cg)([(0,o.C5)(13,r.ZY)],Te.prototype,"offsetNextVertex1",void 0),(0,n.Cg)([(0,o.C5)(14,r.ZY)],Te.prototype,"offsetNextVertex2",void 0);class _e extends w{constructor(){super(...arguments),this.type="TextShader",this.computeAttributes={offset:["offsetNextVertex1","offsetNextVertex2"]},this.textRenderPassType=0,this.isBackgroundPass=!1,this.isLabel=!1}clipLabel(t,e){const{clipAngle:i,zoomRange:s,visibility:n}=t,o=i.multiply(Pe),a=(0,r.tn)(this.view.rotation.subtract(o)),l=(0,r.jk)(new r.nt(360).subtract(a),a);let u=new r.nt(0);const c=(0,r.RI)(this.view.currentZoom.multiply(p.fq)).divide(p.fq),d=s.x,h=s.y,m=new r.nt(1).subtract((0,r.PM)(d,c)).multiply(2),y=(0,r.PM)(new r.nt(90),l).multiply(2),f=new r.nt(2).multiply(new r.nt(1).subtract((0,r.PM)(c,h)));return u=u.add(e.multiply(m)),u=u.add(e.multiply(y)),u=u.add(f),n&&(u=u.add(n)),u}vertex(t,e){const i=(0,h.mh)(t.bitset,S.bg),n=new r.nt(1).subtract(i);let o=t.fontAndReferenceSize[0];const a=t.fontAndReferenceSize[1];let l=o.divide(S.au);const u=1===this.textRenderPassType?t.outlineColor:2===this.textRenderPassType?t.haloColor:this._getVertexColor(t),c=this.view.displayViewScreenMat3.multiply(new r.eB(t.pos,1));let d=t.offset,m=new r.nt(1),y=r.U.identity(),f=new r.ZY(0);if(this.isLabel){if(!t.referenceSymbol)throw new Error("InternalError: Optional attribute 'referenceSymbol' expected for labels");const e=t.referenceSymbol,i=e.xy,s=e.z,n=this._unpackDirection(e.w),o=D(this,t.id,s).divide(2),r=n.multiply(o.add(p.C2));f=i.add(r),d=d.add(f)}else m=D(this,t.id,a).divide(a),o=o.multiply(m),l=l.multiply(m),d=d.multiply(m),y=I(this,t.id),d=y.multiply(new r.eB(d,0)).xy;const g=(0,h.mh)(t.bitset,S.ti),v=this._getViewRotationMatrix(g).multiply(new r.eB(d,0));let b=this.isLabel?this.clipLabel(t,g):this.clip(t.id,t.zoomRange);b=this.isBackgroundPass?b.add(n.multiply(2)):b.add(i.multiply(2));let x=new r.nt(0);if(1===this.textRenderPassType&&(b=b.add((0,r.Tk)((0,r.LC)(t.outlineAndHaloSize.x,new r.nt(0)),new r.nt(2),new r.nt(0))),x=new r.nt(t.outlineAndHaloSize.x).divide(l).divide(S.$w)),2===this.textRenderPassType){const e=t.outlineAndHaloSize.x,i=new r.nt(t.outlineAndHaloSize.y);b=b.add((0,r.Tk)((0,r.LC)(i,new r.nt(0)),new r.nt(2),new r.nt(0))),x=i.add(e).divide(l).divide(S.$w)}const w=this.isLabel?(0,r.MM)(b,new r.nt(1)):new r.x(!1);return(0,s.A)({glPosition:new r.Zb(c.xy.add(v.xy),b,1),color:u,size:l,textureUV:t.textureUV.divide(this.mosaicInfo.size),antialiasingWidth:new r.nt(.105*S.au).divide(o).divide(this.view.pixelRatio),outlineDistanceOffset:x},this.maybeRunHittest(t,e,{vvSizeAdjustment:m,vvRotation:y,labelOffset:f,labelClipped:w}))}_getViewRotationMatrix(t){const e=this.view.displayViewMat3,i=this.view.displayMat3,s=new r.nt(1).subtract(t);return e.multiply(t).add(i.multiply(s))}fragment(t){const e=new r.nt(2/8),i=new r.nt(1).subtract(e),s=(0,r.US)(this.mosaicInfo.texture,t.textureUV).a;let n=i.subtract(t.outlineDistanceOffset);this.highlight&&(n=n.divide(2));const o=t.antialiasingWidth,a=(0,r.TF)(n.subtract(o),n.add(o),s);return this.getFragmentOutput(t.color.multiply(a),t)}hittest(t,e,i){let s,n,o,{vvSizeAdjustment:a,vvRotation:l,labelOffset:u,labelClipped:c}=i;this.isLabel?(s=new r.eB(t.offset.add(u),0),n=new r.eB(e.offsetNextVertex1.add(u),0),o=new r.eB(e.offsetNextVertex2.add(u),0)):(s=l.multiply(new r.eB(t.offset.multiply(a),0)),n=l.multiply(new r.eB(e.offsetNextVertex1.multiply(a),0)),o=l.multiply(new r.eB(e.offsetNextVertex2.multiply(a),0)));const{viewMat3:p,tileMat3:d}=this.view,h=p.multiply(d).multiply(new r.eB(t.pos,1)),m=h.add(d.multiply(s)).xy,y=h.add(d.multiply(n)).xy,f=h.add(d.multiply(o)).xy,g=W(this.hittestRequest.position,m.xy,y.xy,f.xy);return this.isLabel?(0,r.Tk)(c,G(this.hittestRequest),g):g}_unpackDirection(t){const e=new r.Ai(t),i=(0,r.Sj)(e,new r.Ai(2)),s=(0,r.nf)(e,new r.Ai(3));return new r.ZY(new r.nt(i).subtract(1),new r.nt(s).subtract(1))}_getVertexColor(t){let e=t.color;if(this.visualVariableColor){const i=this.storage.getColorValue(t.id);e=this.visualVariableColor.getColor(i,t.color,new r.x(!1))}if(this.visualVariableOpacity){const i=this.storage.getOpacityValue(t.id),s=this.visualVariableOpacity.getOpacity(i);e=e.multiply(s)}return e}}(0,n.Cg)([(0,o.uK)(V)],_e.prototype,"visualVariableColor",void 0),(0,n.Cg)([(0,o.uK)(A)],_e.prototype,"visualVariableOpacity",void 0),(0,n.Cg)([(0,o.uK)(P)],_e.prototype,"visualVariableRotation",void 0),(0,n.Cg)([(0,o.uK)(M)],_e.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n.Cg)([(0,o.uK)(T)],_e.prototype,"visualVariableSizeScaleStops",void 0),(0,n.Cg)([(0,o.uK)(_)],_e.prototype,"visualVariableSizeStops",void 0),(0,n.Cg)([(0,o.uK)(R)],_e.prototype,"visualVariableSizeUnitValue",void 0),(0,n.Cg)([(0,o.Pi)(z)],_e.prototype,"mosaicInfo",void 0),(0,n.Cg)([o.E8],_e.prototype,"textRenderPassType",void 0),(0,n.Cg)([o.E8],_e.prototype,"isBackgroundPass",void 0),(0,n.Cg)([o.E8],_e.prototype,"isLabel",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Me)),(0,n.Qj)(1,(0,o.hF)(Te))],_e.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],_e.prototype,"fragment",null);var Re=i(89657);class Fe extends rt{}(0,n.Cg)([(0,o.C5)(9,r.nt)],Fe.prototype,"accumulatedDistance",void 0),(0,n.Cg)([(0,o.C5)(10,r.nt)],Fe.prototype,"totalLength",void 0),(0,n.Cg)([(0,o.C5)(11,r.nt)],Fe.prototype,"gradientSize",void 0),(0,n.Cg)([(0,o.C5)(12,r.ZY)],Fe.prototype,"segmentDirection",void 0),(0,n.Cg)([(0,o.C5)(13,r.Zb)],Fe.prototype,"tlbr",void 0);class De extends o.k2{}(0,n.Cg)([(0,o.Pi)(r.nt)],De.prototype,"isColorPass",void 0);class ke extends ht{constructor(){super(...arguments),this.type="GradientStrokeShader"}vertex(t,e){const{totalLength:i,gradientSize:n,segmentDirection:o,tlbr:a}=t,l=pt(this,t),u=(0,h.mh)(t.bitset,Re.Q.isAlongLine),c=i.divide(this.view.displayZoomFactor),p=(0,r.Tk)((0,h.K5)(t.bitset,Re.Q.isAbsoluteSize),()=>{const t=(0,r.Tk)((0,r.MM)(u,new r.nt(.5)),c,l.halfWidth);return n.divide(t)},n),d=t.accumulatedDistance.add((0,r.Om)(o,l.scaledOffset).divide(c)),m=a.divide(this.mosaicInfo.size.xyxy);return(0,s.A)((0,s.A)({},l),{},{tlbr:m,relativePositionAlongLine:d,relativeGradientSize:p,isAlongLine:(0,h.mh)(t.bitset,Re.Q.isAlongLine),isDiscrete:(0,h.mh)(t.bitset,Re.Q.isDiscrete)},this.maybeRunHittest(t,e,l.halfWidth))}fragment(t){const{isAlongLine:e,isDiscrete:i,relativePositionAlongLine:s,relativeGradientSize:n,normal:o,tlbr:a}=t,l=ct(t,this.antialiasingControls.blur),u=function(t){return(0,r.PM)(new r.nt(0),t).multiply(2).subtract(1)}(o.y).multiply((0,r.jk)((0,r.Bw)(o),new r.nt(1))),c=new r.nt(.5).multiply(u).add(new r.nt(.5)),p=(0,r.Tk)((0,r.MM)(e,new r.nt(.5)),s,c),m=(0,r.Tk)((0,r.MM)(i,new r.nt(.5)),n.subtract(1),new r.nt(0));let y=p.add(m).divide(n);y=(0,r.Tk)((0,r.MM)(e,new r.nt(.5)),y,(0,h.zb)(y));const f=(0,r.jh)(a.xy,a.zw,new r.ZY((0,r.qE)(y,new r.nt(0),new r.nt(1)),.5)),g=(0,r.US)(this.mosaicInfo.texture,f),v=t.opacity.multiply(l),b=this.getFragmentOutput(g.multiply(v),t),x=(0,r.PM)(new r.nt(.5),this.technique.isColorPass).multiply((0,d.A)("gradient-depth-epsilon")),w=(0,r.PM)(new r.nt(0),o.y).multiply(new r.nt((0,d.A)("gradient-depth-bias")).subtract(x));return b.glFragDepth=(0,r.qE)((0,r.Bw)(o).add(w),new r.nt(0),new r.nt(1)),b}}(0,n.Cg)([(0,o.Pi)(z)],ke.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,o.Pi)(De)],ke.prototype,"technique",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Fe)),(0,n.Qj)(1,(0,o.hF)(b))],ke.prototype,"vertex",null);var Oe=i(76931),Ie=i(77555);class Ze extends rt{}(0,n.Cg)([(0,o.C5)(9,r.nt)],Ze.prototype,"accumulatedDistance",void 0),(0,n.Cg)([(0,o.C5)(10,r.ZY)],Ze.prototype,"segmentDirection",void 0),(0,n.Cg)([(0,o.C5)(11,r.nt)],Ze.prototype,"offsetAlongLine",void 0),(0,n.Cg)([(0,o.C5)(12,r.nt)],Ze.prototype,"capType",void 0),(0,n.Cg)([(0,o.C5)(13,r.Zb)],Ze.prototype,"tlbr",void 0);class Ee extends ht{constructor(){super(...arguments),this.type="TexturedLineShader"}_getDistanceRatio(t,e){const i=(0,h.mh)(t.bitset,S.kx);return i.multiply((0,r.T9)(e,new r.nt(.25)).multiply(new r.nt(2))).add(new r.nt(1).subtract(i).multiply((0,Oe.Lz)(1)))}_getSDFAlpha(t){const{halfWidth:e,normal:i,tlbr:s,patternSize:n,accumulatedDistance:o,offsetAlongLine:a,dashToPx:l,capType:u}=t,c=n.x.divide(Ie.zA).multiply(l),p=(0,r.jc)(o.add(a).divide(c)),d=(0,r.jh)(s.xy,s.zw,new r.ZY(p,.5)),m=(0,h.Rj)((0,r.US)(this.mosaicInfo.texture,d)).multiply(2).subtract(1).multiply(Ie.gR).multiply(l),y=i.y.multiply(e),f=(0,r.j1)([(0,r.LC)(u,new r.nt(1)),m.subtract(e)],[(0,r.LC)(u,new r.nt(2)),(0,r.RZ)((0,r.n7)((0,r.T9)(m,new r.nt(0)),new r.nt(2)).add(y.multiply(y))).subtract(e)],[!0,m]),g=(0,r.qE)(new r.nt(.25).subtract(f),new r.nt(0),new r.nt(1));return new r.Zb(g)}_getPatternColor(t){const{halfWidth:e,normal:i,color:s,accumulatedDistance:n,patternSize:o,sampleAlphaOnly:a,tlbr:l}=t,u=o.y.multiply(new r.nt(2).multiply(e).divide(o.x)),c=(0,r.jc)(n.divide(u)),p=new r.nt(.5).multiply(i.y).add(new r.nt(.5)),d=(0,r.jh)(l.xy,l.zw,new r.ZY(p,c));let h=(0,r.US)(this.mosaicInfo.texture,d);return null!=this.visualVariableColor&&(h=(0,r.Tk)((0,r.MM)(a,new r.nt(.5)),new r.Zb(s.a),s)),h}vertex(t,e){const{segmentDirection:i,tlbr:n,bitset:o}=t,a=pt(this,t),l=t.accumulatedDistance.divide(this.view.displayZoomFactor).add((0,r.Om)(i,a.scaledOffset)),u=new r.ZY(n.z.subtract(n.x),n.w.subtract(n.y)),c=n.divide(this.mosaicInfo.size.xyxy),p=(0,h.mh)(o,S.b5),d=(0,h.mh)(o,S.cn),m=(0,r.Tk)((0,r.MM)(p,new r.nt(.5)),this._getDistanceRatio(t,a.scaledHalfWidth),new r.nt(1));return(0,s.A)((0,s.A)({},a),{},{tlbr:c,patternSize:u,accumulatedDistance:l,isSDF:p,sampleAlphaOnly:d,dashToPx:m,offsetAlongLine:t.offsetAlongLine,capType:t.capType},this.maybeRunHittest(t,e,a.halfWidth))}fragment(t){const{color:e,opacity:i,isSDF:s}=t,n=ct(t,this.antialiasingControls.blur),o=(0,r.Tk)((0,r.MM)(s,new r.nt(.5)),this._getSDFAlpha(t),this._getPatternColor(t)),a=e.multiply(i).multiply(n).multiply(o);return this.getFragmentOutput(a,t)}}(0,n.Cg)([(0,o.Pi)(z)],Ee.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Ze)),(0,n.Qj)(1,(0,o.hF)(b))],Ee.prototype,"vertex",null);class Be extends v{}(0,n.Cg)([(0,o.C5)(3,r.Zb)],Be.prototype,"color",void 0),(0,n.Cg)([(0,o.C5)(4,r.Zb)],Be.prototype,"outlineColor",void 0),(0,n.Cg)([(0,o.C5)(5,r.ZY)],Be.prototype,"offset",void 0),(0,n.Cg)([(0,o.C5)(6,r.ZY)],Be.prototype,"textureUV",void 0),(0,n.Cg)([(0,o.C5)(7,r.Zb)],Be.prototype,"sizing",void 0),(0,n.Cg)([(0,o.C5)(8,r.nt)],Be.prototype,"placementAngle",void 0),(0,n.Cg)([(0,o.C5)(9,r.nt)],Be.prototype,"sdfDecodeCoeff",void 0),(0,n.Cg)([(0,o.C5)(10,r.ZY)],Be.prototype,"zoomRange",void 0);class Le extends o.Y7{}(0,n.Cg)([(0,o.C5)(11,r.ZY)],Le.prototype,"offsetNextVertex1",void 0),(0,n.Cg)([(0,o.C5)(12,r.ZY)],Le.prototype,"offsetNextVertex2",void 0),(0,n.Cg)([(0,o.C5)(13,r.ZY)],Le.prototype,"textureUVNextVertex1",void 0),(0,n.Cg)([(0,o.C5)(14,r.ZY)],Le.prototype,"textureUVNextVertex2",void 0);function Ue(t,e,i,s){return e.multiply(t.x).add(i.multiply(t.y)).add(s.multiply(t.z))}function je(t){return t.multiply(t).divide(128)}class Ye extends w{constructor(){super(...arguments),this.type="MarkerShader",this.computeAttributes={offset:["offsetNextVertex1","offsetNextVertex2"],textureUV:["textureUVNextVertex1","textureUVNextVertex2"]}}vertex(t,e){const i=je(t.sizing.x),n=je(t.sizing.y),o=je(t.sizing.z),a=t.placementAngle,l=(0,h.mh)(t.bitset,c.c.bitset.isSDF),u=(0,h.mh)(t.bitset,c.c.bitset.isMapAligned),p=(0,h.mh)(t.bitset,c.c.bitset.scaleSymbolsProportionally),d=(0,h.K5)(t.bitset,c.c.bitset.colorLocked),m=O(this,t.id),y=k(this,t.id,t.color,d).multiply(m),f=this.view.displayViewScreenMat3.multiply(new r.eB(t.pos.xy,1)),g=D(this,t.id,o).divide(o),v=i.multiply(g),b=t.offset.xy.multiply(g);let x=n.multiply(p.multiply(g.subtract(1)).add(1));x=(0,r.jk)(x,(0,r.T9)(v.subtract(.99),new r.nt(0)));const w=(0,r.T9)(x,new r.nt(1)),C=(0,r.jk)(x,new r.nt(1)),z=r.U.fromRotation(a.multiply(S.rp)),V=I(this,t.id),A=this._getViewRotationMatrix(u).multiply(V).multiply(z).multiply(new r.eB(b.xy,0)),P=this.clip(t.id,t.zoomRange),M=new r.Zb(f.xy.add(A.xy),P,1),T=t.textureUV.divide(this.mosaicInfo.size),_=t.outlineColor.multiply(C),R=(0,h.mh)(t.bitset,c.c.bitset.overrideOutlineColor),F=t.sdfDecodeCoeff.multiply(v);return(0,s.A)({glPosition:M,color:y,textureUV:T,outlineColor:_,outlineSize:w,distanceToPx:F,isSDF:l,overrideOutlineColor:R},this.maybeRunHittest(t,e,{pos:t.pos,size:v,sizeCorrection:g,isMapAligned:u,vvRotationMat3:V,placementMat3:z,outlineSize:w,distanceToPx:F,isSDF:l}))}fragment(t){const e=this._getColor(t.textureUV,t);return this.getFragmentOutput(e,t)}hittest(t,e,i){return(0,r.Tk)((0,r.Xe)(i.size,this.hittestRequest.smallSymbolSizeThreshold),this._hittestSmallMarker(t,e,i),this._hittestMarker(t,e,i))}_getViewRotationMatrix(t){const e=this.view.displayViewMat3,i=this.view.displayMat3,s=new r.nt(1).subtract(t);return e.multiply(t).add(i.multiply(s))}_getViewScreenMatrix(t){const e=this.view.viewMat3.multiply(this.view.tileMat3),i=this.view.tileMat3,s=new r.nt(1).subtract(t);return e.multiply(t).add(i.multiply(s))}_getColor(t,e){return(0,r.Tk)((0,r.LC)(e.isSDF,new r.nt(1)),this._getSDFColor(t,e),this._getSpriteColor(t,e))}_getSpriteColor(t,e){return(0,r.US)(this.mosaicInfo.texture,t).multiply(e.color)}_getSDFColor(t,e){const i=(0,r.US)(this.mosaicInfo.texture,t),s=new r.nt(.5).subtract((0,h.Rj)(i)).multiply(e.distanceToPx).multiply(S.V5),n=(0,r.qE)(new r.nt(.5).subtract(s),new r.nt(0),new r.nt(1)),o=e.color.multiply(n);let a=e.outlineSize;this.highlight&&(a=(0,r.T9)(a,e.overrideOutlineColor.multiply(4)));const l=a.multiply(.5),u=(0,r.tn)(s).subtract(l),c=(0,r.qE)(new r.nt(.5).subtract(u),new r.nt(0),new r.nt(1)),p=(0,r.jh)(e.outlineColor,e.color,e.overrideOutlineColor).multiply(c);return new r.nt(1).subtract(p.a).multiply(o).add(p)}_hittestSmallMarker(t,e,i){const{position:s,distance:n,smallSymbolDistance:o}=this.hittestRequest,a=n.subtract(o),{viewMat3:l,tileMat3:u}=this.view,c=l.multiply(u).multiply(new r.eB(i.pos,1)).xy,p=i.size.multiply(.5);return(0,r.Io)(c,s).subtract(p).add(a)}_hittestMarker(t,e,i){const{pos:s,sizeCorrection:n,isMapAligned:o}=i,a=new r.eB(t.offset.multiply(n),0),l=new r.eB(e.offsetNextVertex1.multiply(n),0),u=new r.eB(e.offsetNextVertex2.multiply(n),0),{viewMat3:c,tileMat3:p}=this.view,d=c.multiply(p).multiply(new r.eB(s,1)),h=this._getViewScreenMatrix(o).multiply(i.vvRotationMat3).multiply(i.placementMat3),m=d.add(h.multiply(a)).xy,y=d.add(h.multiply(l)).xy,f=d.add(h.multiply(u)).xy,g=this.hittestRequest.position,v=this.hittestRequest.distance,b=W(g,m,y,f);return(0,r.Tk)((0,r.MM)(b,v),b,this._hittestSamples(m,y,f,t,e,i))}_hittestSamples(t,e,i,s,n,o){const{outlineSize:a,isSDF:l,distanceToPx:u}=o,c=this.hittestRequest.position,p=this.hittestRequest.distance,d=N(c.add(new r.ZY((0,r.ze)(p),(0,r.ze)(p))),t,e,i),h=N(c.add(new r.ZY(0,(0,r.ze)(p))),t,e,i),m=N(c.add(new r.ZY(p,(0,r.ze)(p))),t,e,i),y=N(c.add(new r.ZY((0,r.ze)(p),0)),t,e,i),f=N(c,t,e,i),g=N(c.add(new r.ZY(p,0)),t,e,i),v=N(c.add(new r.ZY((0,r.ze)(p),p)),t,e,i),b=N(c.add(new r.ZY(0,p)),t,e,i),x=N(c.add(new r.ZY(p,p)),t,e,i),w=s.textureUV.divide(this.mosaicInfo.size),S=n.textureUVNextVertex1.divide(this.mosaicInfo.size),C=n.textureUVNextVertex2.divide(this.mosaicInfo.size),z={color:new r.Zb(1),outlineColor:new r.Zb(1),overrideOutlineColor:new r.nt(1),outlineSize:a,distanceToPx:u,isSDF:l};let V=new r.nt(0);return V=V.add(H(d).multiply(this._getColor(Ue(d,w,S,C),z).a)),V=V.add(H(h).multiply(this._getColor(Ue(h,w,S,C),z).a)),V=V.add(H(m).multiply(this._getColor(Ue(m,w,S,C),z).a)),V=V.add(H(y).multiply(this._getColor(Ue(y,w,S,C),z).a)),V=V.add(H(f).multiply(this._getColor(Ue(f,w,S,C),z).a)),V=V.add(H(g).multiply(this._getColor(Ue(g,w,S,C),z).a)),V=V.add(H(v).multiply(this._getColor(Ue(v,w,S,C),z).a)),V=V.add(H(b).multiply(this._getColor(Ue(b,w,S,C),z).a)),V=V.add(H(x).multiply(this._getColor(Ue(x,w,S,C),z).a)),(0,r.PM)(V,new r.nt(.05)).multiply(G(this.hittestRequest))}}(0,n.Cg)([(0,o.uK)(V)],Ye.prototype,"visualVariableColor",void 0),(0,n.Cg)([(0,o.uK)(A)],Ye.prototype,"visualVariableOpacity",void 0),(0,n.Cg)([(0,o.uK)(P)],Ye.prototype,"visualVariableRotation",void 0),(0,n.Cg)([(0,o.uK)(M)],Ye.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n.Cg)([(0,o.uK)(T)],Ye.prototype,"visualVariableSizeScaleStops",void 0),(0,n.Cg)([(0,o.uK)(_)],Ye.prototype,"visualVariableSizeStops",void 0),(0,n.Cg)([(0,o.uK)(R)],Ye.prototype,"visualVariableSizeUnitValue",void 0),(0,n.Cg)([(0,o.Pi)(z)],Ye.prototype,"mosaicInfo",void 0),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(Be)),(0,n.Qj)(1,(0,o.hF)(Le))],Ye.prototype,"vertex",null),(0,n.Cg)([(0,n.Qj)(0,(0,o.hF)(class extends x{}))],Ye.prototype,"fragment",null);var Qe=i(78492);class qe{constructor(){this.computeAttributes={}}get locationsMap(){const t=new Map;for(const e in this.locations)t.set(e,this.locations[e].index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set(Object.keys(this.options));this._optionPropertyKeys=t}return this._optionPropertyKeys}get _transformFeedbackBindings(){return[]}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map(t=>{let[e,i]=t;return"".concat(e,".").concat(i)}).join(".");this._locationInfo={stringHash:e,locations:t,computeAttributeMap:this.computeAttributes}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const[e,i]of this.locationsMap.entries())t.set("a_"+e,i);return t}getShaderKey(t,e,i){return"".concat(Object.keys(t).map(e=>"".concat(e,".").concat(t[e])).join("."),".").concat(Object.keys(i).filter(t=>i[t]).map(t=>"".concat(t,"_").concat(i[t].toString())).join("."),".").concat(Object.keys(e).filter(t=>this.optionPropertyKeys.has(t)).join("."))}getProgram(t,e,i,s){let n="",o="";for(const r in i)if(i[r]){const t="boolean"==typeof i[r]?"#define ".concat(r,"\n"):"#define ".concat(r," ").concat(i[r],"\n");n+=t,o+=t}return n+=this.vertexShader,o+=this.fragmentShader,new Qe.K(n,o,this.renamedLocationsMap,this._getUniformBindings(e),this._transformFeedbackBindings)}_getUniformBindings(t){const e=[];for(const i in this.required){const t=this.required[i];e.push({uniformHydrated:null,shaderModulePath:i,uniformName:i,uniformType:t.type,uniformArrayElementType:He(t),uniformArrayLength:Ne(t)})}for(const i in t){const s=this.options[i];if(t[i])for(const t in s){const n=s[t];e.push({uniformHydrated:null,shaderModulePath:"".concat(i,".").concat(t),uniformName:t,uniformType:n.type,uniformArrayElementType:He(n),uniformArrayLength:Ne(n)})}}return e}}const He=t=>{var e;return"array"===t.type?null===(e=t.elementType)||void 0===e?void 0:e.type:void 0},Ne=t=>"array"===t.type?t.size:void 0;var Ke=i(35206);const We={hittestDist:r.nt,hittestPos:r.ZY},Ge={filterFlags:r.z7,animation:r.z7,visualVariableData:r.z7,dataDriven0:r.z7,dataDriven1:r.z7,dataDriven2:r.z7,gpgpu:r.z7,size:r.nt},Xe={displayViewScreenMat3:r.U,displayViewMat3:r.U,displayMat3:r.U,viewMat3:r.U,tileMat3:r.U,displayZoomFactor:r.nt,requiredZoomFactor:r.nt,tileOffset:r.ZY,currentScale:r.nt,currentZoom:r.nt,metersPerSRUnit:r.nt};class $e extends qe{constructor(){super(...arguments),this.vertexShader=(0,Ke.Q)("materials/pie/pie.vert"),this.fragmentShader=(0,Ke.Q)("materials/pie/pie.frag"),this.required=(0,s.A)((0,s.A)((0,s.A)({},Ge),Xe),{},{outlineWidth:r.nt,colors:r.My,defaultColor:r.Zb,othersColor:r.Zb,outlineColor:r.Zb,donutRatio:r.nt,sectorThreshold:r.nt}),this.options={hittestUniforms:We,visualVariableSizeMinMaxValue:{minMaxValueAndSize:r.Zb},visualVariableSizeScaleStops:{sizes:{type:"array",elementType:r.nt,size:8},values:{type:"array",elementType:r.nt,size:8}},visualVariableSizeStops:{sizes:{type:"array",elementType:r.nt,size:8},values:{type:"array",elementType:r.nt,size:8}},visualVariableSizeUnitValue:{unitValueToPixelsRatio:r.nt},visualVariableOpacity:{opacities:{type:"array",elementType:r.nt,size:8},opacityValues:{type:"array",elementType:r.nt,size:8}},highlightUniforms:{highlightAll:r.nt,activeReasons:r.nt}},this.locations={pos:{index:0,type:r.ZY},id:{index:1,type:r.eB},bitset:{index:2,type:r.nt},offset:{index:3,type:r.ZY},texCoords:{index:4,type:r.ZY},size:{index:5,type:r.ZY},referenceSize:{index:6,type:r.nt},zoomRange:{index:7,type:r.ZY}},this.defines={VV_SIZE_MIN_MAX_VALUE:"boolean",VV_SIZE_SCALE_STOPS:"boolean",VV_SIZE_FIELD_STOPS:"boolean",VV_SIZE_UNIT_VALUE:"boolean",VV_OPACITY:"boolean",HITTEST:"boolean",numberOfFields:"number",highlight:"boolean",inside:"boolean",outside:"boolean"}}setNumberOfFields(t){this.required.colors={type:"array",elementType:r.Zb,size:t}}}const Je={fill:new class extends Ct{constructor(){super(...arguments),this.type=13,this.shaders={geometry:new J}}render(t,e){const{painter:i}=t,n=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,n.uniforms)),(0,zt.QA)(t,e.target)),defines:(0,zt.vT)(t),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},patternFill:new class extends Ct{constructor(){super(...arguments),this.type=26,this.shaders={geometry:new Jt}}render(t,e){const{painter:i}=t,n=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,n.uniforms)),(0,zt.QA)(t,e.target)),{},{mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey),localTileOffset:(0,zt.Pr)(e.target)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},complexFill:new class extends Ct{constructor(){super(...arguments),this.type=9,this.shaders={geometry:new nt}}render(t,e){const{painter:i}=t,n=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,n.uniforms)),(0,zt.QA)(t,e.target)),{},{mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey),localTileOffset:(0,zt.Pr)(e.target)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},gradientFill:new class extends Ct{constructor(){super(...arguments),this.type=14,this.shaders={geometry:new le},this.symbologyPlane=0}render(t,e){const{painter:i}=t,n=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,n.uniforms)),(0,zt.QA)(t,e.target)),{},{mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},outlineFill:new class extends Ct{constructor(){super(...arguments),this.type=24,this.shaders={geometry:new Wt}}render(t,e){const{painter:i,pixelRatio:n}=t,o=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,o.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(n)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},patternOutlineFill:new class extends Ct{constructor(){super(...arguments),this.type=27,this.shaders={geometry:new ie}}render(t,e){const{painter:i,pixelRatio:n}=t,o=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,o.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(n),mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey),localTileOffset:(0,zt.Pr)(e.target)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},complexOutlineFill:new class extends Ct{constructor(){super(...arguments),this.type=10,this.shaders={geometry:new oe}}render(t,e){const{painter:i,pixelRatio:n}=t,o=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,o.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(n),mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey),localTileOffset:(0,zt.Pr)(e.target)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},marker:new class extends Ct{constructor(){super(...arguments),this.type=21,this.shaders={geometry:new Ye},this.symbologyPlane=2}render(t,e){const{painter:i}=t,n=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,n.uniforms)),(0,zt.QA)(t,e.target)),{},{mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey,!0)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},pieChart:new class extends Ct{constructor(){super(...arguments),this.type=28,this.shaders={geometry:new $e},this.symbologyPlane=2}render(t,e){var i,n;const{painter:o}=t,{instance:r,target:a}=e,l=this.shaders.geometry,u=r.getInput(),c=u.uniforms.numberOfFields,p=(0,zt.Eq)(t),d=(0,zt.QA)(t,a),h=(0,zt.vT)(t);l.setNumberOfFields(c),o.setShader({shader:l,uniforms:(0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,u.uniforms.shader)),d.storage),d.view),d.highlight),{},{highlightUniforms:d.highlight,hittestUniforms:d.hittestRequest?{hittestDist:null===(i=d.hittestRequest)||void 0===i?void 0:i.distance,hittestPos:null===(n=d.hittestRequest)||void 0===n?void 0:n.position}:null}),defines:(0,s.A)((0,s.A)({VV_SIZE_MIN_MAX_VALUE:!!u.uniforms.shader.visualVariableSizeMinMaxValue,VV_SIZE_SCALE_STOPS:!!u.uniforms.shader.visualVariableSizeScaleStops,VV_SIZE_FIELD_STOPS:!!u.uniforms.shader.visualVariableSizeStops,VV_SIZE_UNIT_VALUE:!!u.uniforms.shader.visualVariableSizeUnitValue,VV_OPACITY:!!u.uniforms.shader.visualVariableOpacity,HITTEST:p,highlight:d.highlight?1:0},h),{},{numberOfFields:c}),optionalAttributes:{},useComputeBuffer:p}),o.setPipelineState((0,zt.Qu)(t)),o.submitDraw(t,e)}},line:new class extends Ct{constructor(){super(...arguments),this.type=19,this.shaders={geometry:new ht},this.symbologyPlane=1}render(t,e){const{painter:i,pixelRatio:n}=t,o=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,o.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(n)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},texturedLine:new class extends Ct{constructor(){super(...arguments),this.type=31,this.shaders={geometry:new Ee},this.symbologyPlane=1}render(t,e){const{painter:i,pixelRatio:n}=t,o=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,o.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(n),mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey)}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}},gradientStroke:new class extends Ct{constructor(){super(...arguments),this.type=15,this.shaders={geometry:new ke},this.symbologyPlane=1}_getShaderOptions(t,e,i){const{painter:n,pixelRatio:o}=t,r=e.instance.getInput();return{shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,r.uniforms)),(0,zt.QA)(t,e.target)),{},{antialiasingControls:Vt(o),mosaicInfo:n.textureManager.getMosaicInfo(t,e.textureKey),technique:{isColorPass:i}}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:r.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)}}render(t,e){const{painter:i}=t;if((0,zt.Eq)(t)||(0,zt.dJ)(t)){const s=(0,zt.Qu)(t);return i.setPipelineState(s),i.setShader(this._getShaderOptions(t,e,1)),void i.submitDraw(t,e)}t.context.setClearDepth(1),t.context.clear(256);i.setShader(this._getShaderOptions(t,e,0)),i.setPipelineState({color:!1,depth:{write:{zNear:0,zFar:1},test:513},stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7680}}}}),i.submitDraw(t,e);i.setShader(this._getShaderOptions(t,e,1)),i.setPipelineState({color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:{write:!1,test:515},stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7680}}}}),i.submitDraw(t,e)}},text:new class extends Ct{constructor(){super(...arguments),this.type=30,this.shaders={geometry:new _e},this.symbologyPlane=3}render(t,e){const{painter:i}=t,n=(0,zt.vT)(t),o=e.instance.getInput(),r={shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,o.uniforms)),(0,zt.QA)(t,e.target)),{},{mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey)}),defines:(0,s.A)((0,s.A)({},n),{},{isBackgroundPass:!0,isLabel:!1,textRenderPassType:0}),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)};i.setShader(r),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e),i.setShader((0,s.A)((0,s.A)({},r),{},{defines:(0,s.A)((0,s.A)({},n),{},{isBackgroundPass:!1,isLabel:!1,textRenderPassType:2})})),i.submitDraw(t,e),i.setShader((0,s.A)((0,s.A)({},r),{},{defines:(0,s.A)((0,s.A)({},n),{},{isBackgroundPass:!1,isLabel:!1,textRenderPassType:1})})),i.submitDraw(t,e),i.setShader((0,s.A)((0,s.A)({},r),{},{defines:(0,s.A)((0,s.A)({},n),{},{isBackgroundPass:!1,isLabel:!1,textRenderPassType:0})})),i.submitDraw(t,e)}},label:new class extends Ct{constructor(){super(...arguments),this.type=18,this.shaders={geometry:new _e},this.drawPhase=14,this.symbologyPlane=3}render(t,e){const{painter:i}=t,n=(0,zt.vT)(t),o=(0,s.A)((0,s.A)({},(0,zt.Qu)(t)),{},{stencil:{write:!1,test:{compare:516,mask:255,op:{fail:7680,zFail:7680,zPass:7680}}}}),r=e.instance.getInput(),a={shader:this.shaders.geometry,uniforms:(0,s.A)((0,s.A)((0,s.A)({},(0,zt.r3)(t,e.target,r.uniforms)),(0,zt.QA)(t,e.target)),{},{mosaicInfo:i.textureManager.getMosaicInfo(t,e.textureKey)}),defines:(0,s.A)((0,s.A)({},n),{},{textRenderPassType:0,isBackgroundPass:!0,isLabel:!0}),optionalAttributes:r.optionalAttributes,useComputeBuffer:(0,zt.Eq)(t)};i.setPipelineState(o),i.setShader(a),i.submitDraw(t,e,{stencilRef:255}),i.setShader((0,s.A)((0,s.A)({},a),{},{defines:(0,s.A)((0,s.A)({},n),{},{textRenderPassType:2,isBackgroundPass:!1,isLabel:!0})})),i.submitDraw(t,e,{stencilRef:255}),i.setShader((0,s.A)((0,s.A)({},a),{},{defines:(0,s.A)((0,s.A)({},n),{},{textRenderPassType:0,isBackgroundPass:!1,isLabel:!0})})),i.submitDraw(t,e,{stencilRef:255})}},heatmap:new class extends Ct{constructor(){super(...arguments),this.type=17,this.drawPhase=73,this.shaders={accumulate:new ge,resolve:new Se},this._isBound=!1,this._resources=new Map}shutdown(t){var e;super.shutdown(t),null!==(e=this._resources.get(t))&&void 0!==e&&e.destroy(),this._resources.delete(t),this._prevFBO=null,this._unbind()}render(t,e){const{context:i,painter:n,state:o}=t,r=e.instance.getInput(),{isFieldActive:a}=r.uniforms,l=this._getOrCreateResourcesRecord(i),u=l.loadQualityProfile(i);(0,zt.Eq)(t)||this._bind(t,l,r),n.setShader({shader:this.shaders.accumulate,uniforms:(0,s.A)((0,s.A)({},(0,zt.QA)(t,e.target)),{},{kernelControls:{radius:Ae(r,o),isFieldActive:a?1:0}}),defines:(0,s.A)((0,s.A)({},(0,zt.vT)(t)),u.defines),optionalAttributes:{},useComputeBuffer:(0,zt.Eq)(t)});const c=(0,zt.Eq)(t)?ze:Ce;n.setPipelineState(c),n.submitDraw(t,e)}getStencilReference(t){return function(t){return t.key.level+1}(t)}renderResolvePass(t,e){if((0,zt.Eq)(t))return;const{context:i,painter:s}=t,n=this._resources.get(i);if(null==this._prevFBO||null==this._prevViewport||null===n||void 0===n||!n.initialized)return;const{defines:o}=n.loadQualityProfile(i),{minDensity:r,maxDensity:a,radius:l}=e.getInput().uniforms,u=n.accumulateFramebuffer,c=n.resolveGradientTexture,p={shader:this.shaders.resolve,uniforms:{accumulatedDensity:{texture:{unit:8,texture:u.colorTexture},minAndInvRange:[r,1/(a-r)],normalization:3/(l*l*Math.PI)},gradient:{texture:{unit:9,texture:c}}},defines:o,optionalAttributes:{},useComputeBuffer:!1};i.bindFramebuffer(this._prevFBO),i.setViewport(0,0,this._prevViewport.width,this._prevViewport.height),i.bindTexture(u.colorTexture,8),i.bindTexture(c,9),s.setPipelineState(Ve),s.submitDrawMesh(i,p,s.quadMesh),this._unbind()}_getOrCreateResourcesRecord(t){let e=this._resources.get(t);return null==e&&(e=new he,this._resources.set(t,e)),e}_unbind(){this._prevFBO=null,this._prevViewport=null,this._isBound=!1}_bind(t,e,i){if(this._isBound)return;const{context:s,state:n,pixelRatio:o}=t,r=s.getBoundFramebufferObject(),a=s.getViewport();this._prevFBO=r,this._prevViewport=a;const{gradient:l,gradientHash:u}=i.uniforms;e.ensureResolveGradientTexture(s,u,l);const{width:c,height:p}=a,d=function(t,e){const i=e>1.5?.25:.5;return t<1/(2*i)?1:i}(Ae(i,n),o),h=c*d,m=p*d,y=e.ensureAccumulateFBO(s,h,m);s.blitFramebuffer(r,y,1024),s.bindFramebuffer(y),s.setViewport(0,0,y.width,y.height),s.setColorMask(!0,!0,!0,!0),s.setClearColor(0,0,0,0),s.clear(16384),this._isBound=!0}},dotDensity:new class extends Ct{constructor(){super(...arguments),this.type=11,this.shaders={polygon:new kt,point:new _t,fill:new J},this._resources=new Map}render(t,e){(0,zt.dJ)(t)||(0,zt.Eq)(t)?this._renderPolygons(t,e):this._renderDotDensity(t,e)}_renderPolygons(t,e){const{painter:i}=t;i.setShader({shader:this.shaders.fill,uniforms:(0,s.A)((0,s.A)({},(0,zt.QA)(t,e.target)),{},{visualVariableColor:null,visualVariableOpacity:null}),defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:{zoomRange:!1},useComputeBuffer:(0,zt.Eq)(t)}),i.setPipelineState((0,zt.Qu)(t)),i.submitDraw(t,e)}_renderDotDensity(t,e){const{context:i,painter:n,requiredLevel:o}=t,r=e.instance.getInput().uniforms,a=this._getOrCreateResourcesRecord(i),l=a.getDotDensityTextures(i,p.CQ,r.seed),u=1/2**(o-e.target.key.level),c=p.CQ,d=c*window.devicePixelRatio*c*window.devicePixelRatio,h=1/u*(1/u),m=r.dotScale?t.state.scale/r.dotScale:1,y=r.dotValue*m*h;n.setShader({shader:this.shaders.polygon,uniforms:(0,s.A)((0,s.A)({},(0,zt.QA)(t,e.target)),{},{instance:{isActive:r.isActive,colors:r.colors,dotValue:Math.max(1,y)},draw:{dotTexture0:{unit:p.Cp,texture:l[0]},dotTexture1:{unit:p.vN,texture:l[1]},tileZoomFactor:u,pixelRatio:window.devicePixelRatio,tileDotsOverArea:d/(p.CQ*window.devicePixelRatio*p.CQ*window.devicePixelRatio)}}),defines:(0,s.A)((0,s.A)({},(0,zt.vT)(t)),{},{blending:r.blending}),optionalAttributes:{},useComputeBuffer:!1});const f=i.getViewport();i.setViewport(0,0,p.CQ,p.CQ);const g=i.getBoundFramebufferObject(),v=a.getFBO(i);i.bindFramebuffer(v),i.setClearColor(0,0,0,0),i.clear(16384),n.setPipelineState({color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:!1}),n.updatePipelineState(i),n.submitDraw(t,e),i.bindFramebuffer(g),i.setViewport(f.x,f.y,f.width,f.height);const b=a.getFBO(i).colorTexture,x={shader:this.shaders.point,uniforms:{view:(0,zt.L4)(t,e.target),instance:{dotSize:r.dotSize},draw:{locations:{unit:p.Cp,texture:b},tileZoomFactor:1,pixelRatio:window.devicePixelRatio}},defines:(0,s.A)({},(0,zt.vT)(t)),optionalAttributes:{},useComputeBuffer:!1};n.setPipelineState((0,zt.Qu)(t)),n.submitDrawMesh(i,x,a.getDotDensityMesh(i),{stencilRef:e.getStencilReference()})}shutdown(t){var e;super.shutdown(t),null!==(e=this._resources.get(t))&&void 0!==e&&e.destroy(),this._resources.delete(t)}_getOrCreateResourcesRecord(t){let e=this._resources.get(t);return null==e&&(e=new Qt,this._resources.set(t,e)),e}},animatedMarker:new class extends At{constructor(){super(...arguments),this.type=2,this.symbologyPlane=2,this.shaders={geometry:new bt}}},animatedMarkerShift:new class extends At{constructor(){super(...arguments),this.type=3,this.symbologyPlane=2,this.shaders={geometry:new bt}}},animatedFill:new class extends At{constructor(){super(...arguments),this.type=0,this.symbologyPlane=0,this.shaders={geometry:new ot}}},animatedLine:new class extends At{constructor(){super(...arguments),this.type=1,this.symbologyPlane=1,this.shaders={geometry:new yt}}}};function ti(){for(const t in Je)Je[t].startup()}function ei(t){for(const e in Je)Je[e].shutdown(t)}},60401:(t,e,i)=>{i.d(e,{j:()=>a});var s=i(50346),n=i(34429),o=i(33817);class r{constructor(){this.type="override-batch",this.messages=[],this._resovler=(0,s.Tw)()}get promise(){return this._resovler.promise}resolve(){this._resovler.resolve()}add(t){this.messages.push(t)}}class a{constructor(t){this.updateTracking=new o.F({debugName:"FeatureCommandQueue"}),this.process=t.process,this._queueProcessor=new n.QueueProcessor({concurrency:1,process:async t=>{if("override-batch"===t.type){const t=this._nextOverrideBatch;if(null==t)throw new Error("InternalError: Override should be defined");return this._nextOverrideBatch=null,await this.process(t),void t.resolve()}return this.process(t)}})}destroy(){this.updateTracking.destroy(),this._queueProcessor.destroy(),this.clear()}clear(){this._queueProcessor.clear()}async push(t){return(0,s.QZ)(this.updateTracking.addPromise(this._doPush(t)))}async _doPush(t){const e=this._queueProcessor,i=e.last();switch(t.type){case"update":case"highlight":if((null===i||void 0===i?void 0:i.type)===t.type)return;return e.push(t);case"override":case"edit":return this._pushOverride(t)}}_pushOverride(t){return null==this._nextOverrideBatch&&(this._nextOverrideBatch=new r,this._queueProcessor.push(this._nextOverrideBatch)),this._nextOverrideBatch.add(t),this._nextOverrideBatch.promise}}},60853:(t,e,i)=>{i.d(e,{K5:()=>p,Kt:()=>m,M8:()=>a,Rj:()=>y,_9:()=>r,i6:()=>d,mh:()=>c,nb:()=>u,p8:()=>v,tL:()=>l,xf:()=>f,yS:()=>h,y_:()=>x,zb:()=>g,zy:()=>b});var s=i(5095),n=i(60984),o=i(90113);function r(t){const e=(0,n.fV)(12.9898),i=(0,n.fV)(78.233),s=(0,n.fV)(43758.5453),o=(0,n.Om)(t,(0,n.Zc)(e,i)),r=(0,n.zi)(o,(0,n.fV)(3.14));return(0,n.jc)((0,n.F8)(r).multiply(s))}function a(t){return(0,n.LC)(t,(0,n.fV)(o.qM))}function l(t,e){return t.x.multiply(e.y).subtract(e.x.multiply(t.y))}function u(t){return t.multiply(2).subtract(1)}function c(t,e){const i=(0,n.fV)(2**e);return(0,n.zi)((0,n.RI)(t.divide(i)),(0,n.fV)(2))}function p(t,e){return(0,n.MM)(c(t,e),(0,n.fV)(.5))}function d(t,e){return c(t,e+s.U5)}function h(t,e){return c(t,e)}function m(t){const e=c(t.z,7),i=(0,n.fV)(1).subtract(e),s=t.xyz.subtract((0,n.eR)(0,0,(0,n.fV)(128)));return i.multiply(t).add(e.multiply(s))}function y(t){const e=(0,n.ln)(255/256,255/65536,255/16777216,255/4294967296);return(0,n.Om)(t,e)}function f(t){return(0,n.T9)((0,n.T9)((0,n.T9)(t.x,t.y),t.z),t.w)}function g(t){return new n.nt(1).subtract(t)}function v(t){return t.subtract(new n.nt(1))}function b(t,e){return t.subtract(new n.nt(e))}function x(t,e,i,s){let o=new n.Zb(0);const r=new n.Zb(0);return o=w(o,t,r),o=w(o,e,r),o=w(o,i,r),o=w(o,s,r),o}function w(t,e,i){const s=e.subtract(i),n=t.add(s);return i=n.subtract(t).subtract(s),n}},64780:(t,e,i)=>{i.d(e,{e:()=>u});var s=i(89379),n=i(4212),o=i(76718),r=(i(12331),i(44488),i(81806),i(62881),i(80895),i(36911)),a=i(89339),l=i(9243);class u{constructor(t,e){this._boundPart=null,this.vertexBuffers=new Map,this.indexBuffers=new Map,this.groups=[];for(const i in e.vertex){const{data:s,layout:n}=e.vertex[i],o=new l.R(t,n,s);this.vertexBuffers.set(i,o)}for(const i in e.index){const{data:s}=e.index[i],n=o.g.createIndex(t,35044,s);this.indexBuffers.set(i,n)}for(const i of e.groups)this.groups.push((0,s.A)((0,s.A)({},i),{},{vertexArrays:new Map}));this.parts=e.parts}bind(t,e,i){this._boundPart=i;const{group:s}=this.parts[this._boundPart],o=this.groups[s];if(!o)throw new Error("Missing group ".concat(s,"."));let a=o.vertexArrays.get(e.stringHash);if(!a){const i=(0,n.zI)(new Set(e.locations.keys())),s=o.index?this.indexBuffers.get(o.index):null,l=new Map;for(const[t,e]of this.vertexBuffers)e.layout.filter(t=>i.has(t.name)).length>0&&l.set(t,e);a=new r.Z(t,l,s),o.vertexArrays.set(e.stringHash,a)}t.bindVAO(a)}draw(t){if(null==this._boundPart)throw new Error("Mesh.bind() has not been called.");const{start:e,count:i}=this.parts[this._boundPart],{group:s}=this.parts[this._boundPart],{primitive:n,index:o}=this.groups[s];if(o){const s=this.indexBuffers.get(o);if(!s)throw new Error('Missing index buffer "'.concat(o,'".'));const{indexType:r}=s;if(!r)throw new Error("Buffer type error.");t.drawElements(n,i,r,e*a.I[r])}else t.drawArrays(n,e,i)}unbind(t){this._boundPart=null,t.bindVAO(null)}destroy(){this.groups.forEach(t=>{let{vertexArrays:e}=t;return e.forEach(t=>t.disposeVAOOnly())}),this.vertexBuffers.forEach(t=>t.dispose()),this.indexBuffers.forEach(t=>t.dispose())}}},65753:(t,e,i)=>{i.d(e,{G:()=>C});var s=i(89379),n=i(51235),o=i(52796),r=i(10484),a=i(19393),l=i(83658),u=i(64241);const c={maxSegmentLength:1/0,maxDeviation:1/0,maxSegmentsPerCurve:12e3,minSegmentsPerCurve:1},p=1e-6,d=[0,0];function h(t){var e,i,s,n;return{maxSegmentLength:null!==(e=t.maxSegmentLength)&&void 0!==e?e:c.maxSegmentLength,maxDeviation:null!==(i=t.maxDeviation)&&void 0!==i?i:c.maxDeviation,maxSegmentsPerCurve:null!==(s=t.maxSegmentsPerCurve)&&void 0!==s?s:c.maxSegmentsPerCurve,minSegmentsPerCurve:Math.max(null!==(n=t.minSegmentsPerCurve)&&void 0!==n?n:c.minSegmentsPerCurve,1)}}class m{constructor(t,e){this.curveStart=t,this.curveEnd=e,this.tStart=0,this.tEnd=0,this.tEndStack=[],this.arcEndStack=[]}get stackSize(){return this.tEndStack.length}initialize(t,e){this.tStart=0,this.arcStart=t,this.tEndStack.push(1),this.arcEndStack.push(e)}splitAt(t){this.tEndStack.push(this.tEnd),this.arcEndStack.push(this.arcEnd),this.tEndStack.push(t),this.arcEndStack.push(this.interpolate(t))}splitInHalf(){return this.splitAt((this.tStart+this.tEnd)/2)}pop(){this.tEnd=this.tEndStack.pop(),this.arcEnd=this.arcEndStack.pop()}next(){this.tStart=this.tEnd,this.arcStart=this.arcEnd}densify(t,e){let{maxDeviation:i,maxSegmentLength:s,maxSegmentsPerCurve:n,minSegmentsPerCurve:o}=e;const r=s*s,a=i*i,l=1/n,c=this.interpolate(0),d=this.interpolate(1);(0,u.kb)(this.curveStart,c)>p&&t.push(c),this.initialize(c,d);const h=1/o;for(let u=o-1;u>0;u--){const t=u*h;this.pop(),this.splitAt(t)}for(;this.stackSize>0;)this.pop(),this.tStart===this.tEnd||this.tEnd-this.tStart<l||(0===r||!isFinite(r)||(0,u.kb)(this.arcStart,this.arcEnd)<r)&&(0===a||!isFinite(a)||this.getDeviation2()<a)?(t.push(this.arcEnd),this.next()):this.splitInHalf();return(0,u.kb)(this.curveEnd,d)>p&&t.push([...this.curveEnd]),t}}class y extends m{constructor(t,e){const[i,s,n]=e.b;super(t,i),this._controlPointsStack=[],this._curveControlPoints=[s,n],this._arcControlPoints=[s,n],this._controlPointsStack.push(this._arcControlPoints)}splitAt(t){const{arcStart:e,arcEnd:i,tStart:s,tEnd:n}=this,[o,r]=this._arcControlPoints,a=(t-s)/(n-s),l=(0,u.RS)([],e,o,a),c=(0,u.RS)(d,o,r,a),p=(0,u.RS)([],r,i,a),h=(0,u.RS)([],l,c,a),m=(0,u.RS)([],c,p,a),y=(0,u.RS)([],h,m,a);this.tEndStack.push(this.tEnd),this.arcEndStack.push(this.arcEnd),this._controlPointsStack.push([m,p]),this.tEndStack.push(t),this.arcEndStack.push(y),this._arcControlPoints[0]=l,this._arcControlPoints[1]=h,this._controlPointsStack.push(this._arcControlPoints)}pop(){super.pop(),this._arcControlPoints=this._controlPointsStack.pop()}interpolate(t){const{curveStart:e,curveEnd:i}=this,[s,o]=this._curveControlPoints;return(0,n.B4)(e,s,o,i,t)}getDeviation2(){const{arcStart:t,arcEnd:e}=this,[i,s]=this._arcControlPoints;return Math.max((0,u.yE)(i,t,e),(0,u.yE)(s,t,e))}}class f extends m{constructor(t,e){const[i]=e.a;super(t,i),this._derivedEllipse=(0,l.SW)(t,e)}pop(){super.pop(),this._tMid=(this.tStart+this.tEnd)/2,this._arcMid=this.interpolate(this._tMid)}splitInHalf(){this.tEndStack.push(this.tEnd),this.arcEndStack.push(this.arcEnd),this.tEndStack.push(this._tMid),this.arcEndStack.push(this._arcMid)}interpolate(t){return(0,l.Uk)(this._derivedEllipse,t)}getDeviation2(){return(0,u.yE)(this._arcMid,this.arcStart,this.arcEnd)}}function g(t,e,i,s,n){let{cx:o,cy:r,radius:a,thetaStart:l,thetaEnd:c,isInvalid:d}=s,{maxDeviation:h,maxSegmentLength:m,maxSegmentsPerCurve:y,minSegmentsPerCurve:f}=n;if(d)return t.push([...i]),t;const g=2*a,v=[o+a*Math.cos(l),r+a*Math.sin(l)],b=[o+a*Math.cos(c),r+a*Math.sin(c)];(0,u.kb)(e,v)>p&&t.push(v);const x=Math.abs(c-l),w=m<g?2*Math.asin(m/g):x,S=h<=a?2*Math.acos(1-h/a):x,C=Math.min(w,S),z=Math.min(y,Math.max(f,Math.ceil(Math.abs(x/C)))),V=1/z;for(let u=1;u<z;u++){const e=u*V,i=l*(1-e)+c*e;t.push([o+a*Math.cos(i),r+a*Math.sin(i)])}return t.push(b),(0,u.kb)(i,b)>p&&t.push([...i]),t}function v(t,e,i,s){return new y(e,i).densify(t,s)}function b(t,e,i,s){const n=(0,o.pM)(e,i),[r]=i.c;return g(t,e,r,n,s)}function x(t,e,i,s){const n=(0,a.i)(e,i),[o]=i.a;return g(t,e,o,n,s)}function w(t,e,i,s){const[n,o,r,a,l,u,c]=i.a;return 0===u||0===c?(t.push([...n]),t):new f(e,i).densify(t,s)}function S(t,e,i,s){return(0,r.Xq)(i)?(t.push([...i]),t):(0,r.n1)(i)?v(t,e,i,s):(0,r.aO)(i)?b(t,e,i,s):(0,r.DA)(i)?x(t,e,i,s):w(t,e,i,s)}function C(t,e){if(!(0,r.Ed)(t))return t;const i=h(e),n=(0,r.FD)(t),o=[];for(const s of n){const t=[];for(let e=0;e<s.length-1;e++){const n=e+1,o=[...(0,r.yP)(s[e])];0===e&&t.push(o),S(t,o,s[n],i)}o.push(t)}return"curvePaths"in t?(0,s.A)((0,s.A)((0,s.A)({},void 0!==t.hasZ?{hasZ:t.hasZ}:{}),void 0!==t.hasM?{hasM:t.hasM}:{}),{},{paths:o,spatialReference:t.spatialReference}):(0,s.A)((0,s.A)((0,s.A)({},void 0!==t.hasZ?{hasZ:t.hasZ}:{}),void 0!==t.hasM?{hasM:t.hasM}:{}),{},{rings:o,spatialReference:t.spatialReference})}},74075:(t,e,i)=>{function s(t){return!!(t.visualVariableSizeMinMaxValue||t.visualVariableSizeScaleStops||t.visualVariableSizeStops||t.visualVariableSizeUnitValue||t.visualVariableSizeOutlineScaleStops)}function n(t){return!!t.visualVariableRotation}function o(t){return t.spriteRasterizationParam?t.spriteRasterizationParam:{type:"sprite-rasterization-param",resource:{type:"CIMPictureMarker",url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAAAAsSURBVEhL7c0xAQAwDASh+jf9lcCU7TDA27ECKqACKqACKqACKqACKqDjYPuLVfSmMPfafQAAAABJRU5ErkJggg==",size:16,invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture"},overrides:[]}}i.d(e,{IY:()=>s,N7:()=>n,xi:()=>o})},81608:(t,e,i)=>{function s(t,e){const i=t.slice(0,e),s=e-i.length;for(let n=0;n<s;n++){const t=i[i.length-1];i.push(t)}return i}function n(t){if(!t)return[0,0,0,0];const{r:e,g:i,b:s,a:n}=t;return[e*(n/255),i*(n/255),s*(n/255),n]}i.d(e,{p:()=>n,r:()=>s})},89339:(t,e,i)=>{i.d(e,{I:()=>n});var s=i(93345);const n={[s.pe.BYTE]:1,[s.pe.UNSIGNED_BYTE]:1,[s.pe.SHORT]:2,[s.pe.UNSIGNED_SHORT]:2,[s.pe.HALF_FLOAT]:2,[s.pe.INT]:4,[s.pe.UNSIGNED_INT]:4,[s.pe.FLOAT]:4}}}]);
//# sourceMappingURL=5910.a5122946.chunk.js.map