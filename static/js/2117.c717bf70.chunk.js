"use strict";(self.webpackChunkmmsp_land_hl=self.webpackChunkmmsp_land_hl||[]).push([[2117],{2687:(t,e,n)=>{n.d(e,{N5:()=>u});var r,i,o=n(50076),s=(n(81806),n(76460));const c=()=>s.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class a{constructor(){this._includedModules=new Map}include(t,e){this._includedModules.has(t)?this._includedModules.get(t):(this._includedModules.set(t,e),t(this.builder,e))}}class u extends a{constructor(){super(...arguments),this.vertex=new p,this.fragment=new p,this.attributes=new f,this.varyings=new m,this.extensions=new g,this.outputs=new y}get fragmentUniforms(){return this.fragment.uniforms.entries}get attributeNames(){return this.attributes.names}get builder(){return this}generate(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.extensions.generateSource(t),r=this.attributes.generateSource(t),i=this.varyings.generateSource(t),o="vertex"===t?this.vertex:this.fragment,s=o.uniforms.generateSource(),c=o.code.generateSource(),a=o.main.generateSource(e),u="vertex"===t?_:b,h=o.constants.generateSource(),l=this.outputs.generateSource(t);return"#version 300 es\n".concat(n.join("\n"),"\n").concat(u,"\n").concat(h.join("\n"),"\n").concat(s.join("\n"),"\n").concat(r.join("\n"),"\n").concat(i.join("\n"),"\n").concat(l.join("\n"),"\n").concat(c.join("\n"),"\n").concat(a.join("\n"))}generateBind(t){const e=new Map;this.vertex.uniforms.entries.forEach(t=>{const n=t.bind[0];n&&e.set(t.name,n)}),this.fragment.uniforms.entries.forEach(t=>{const n=t.bind[0];n&&e.set(t.name,n)});const n=Array.from(e.values()),r=n.length;return e=>{for(let i=0;i<r;++i)n[i](t,e)}}generateBindPass(t){const e=new Map;this.vertex.uniforms.entries.forEach(t=>{const n=t.bind[1];n&&e.set(t.name,n)}),this.fragment.uniforms.entries.forEach(t=>{const n=t.bind[1];n&&e.set(t.name,n)});const n=Array.from(e.values()),r=n.length;return(e,i)=>{for(let o=0;o<r;++o)n[o](t,e,i)}}generateBindDraw(t){const e=new Map;this.vertex.uniforms.entries.forEach(t=>{const n=t.bind[2];n&&e.set(t.name,n)}),this.fragment.uniforms.entries.forEach(t=>{const n=t.bind[2];n&&e.set(t.name,n)});const n=Array.from(e.values()),r=n.length;return(e,i,o)=>{for(let s=0;s<r;++s)n[s](t,o,e,i)}}}class h{constructor(t){this._stage=t,this._entries=new Map}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)this._add(r);return this._stage}get(t){return this._entries.get(t)}_add(t){if(null!=t){if(this._entries.has(t.name)&&!this._entries.get(t.name).equals(t))throw new o.A("shaderbuilder:duplicate-uniform","Duplicate uniform name ".concat(t.name," for different uniform type"));this._entries.set(t.name,t)}else c().error("Trying to add null Uniform from ".concat((new Error).stack,"."))}generateSource(){return Array.from(this._entries.values()).map(t=>{let{name:e,arraySize:n,type:r}=t;return null!=n?"uniform ".concat(r," ").concat(e,"[").concat(n,"];"):"uniform ".concat(r," ").concat(e,";")})}get entries(){return Array.from(this._entries.values())}}class l{constructor(t){this._stage=t,this._bodies=new Array}add(t){return this._bodies.push(t),this._stage}generateSource(t){if(this._bodies.length>0)return["void main() {\n ".concat(this._bodies.join("\n")||""," \n}")];if(t)throw new o.A("shaderbuilder:missing-main","Shader does not contain main function body.");return[]}}class d{constructor(t){this._stage=t,this._entries=new Array}add(t){return this._entries.push(t),this._stage}generateSource(){return this._entries}}class p extends a{constructor(){super(...arguments),this.uniforms=new h(this),this.main=new l(this),this.code=new d(this),this.constants=new v(this)}get builder(){return this}}class f{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map(t=>"in ".concat(t[1]," ").concat(t[0],";"))}get names(){return this._entries.map(t=>{let[e]=t;return e})}}class m{constructor(){this._entries=new Map}add(t,e,n){var r;this._entries.has(t)?c().warn("Ignoring duplicate varying ".concat(e," ").concat(t)):this._entries.set(t,{type:e,invariant:null!==(r=null===n||void 0===n?void 0:n.invariant)&&void 0!==r&&r})}generateSource(t){const e=new Array;return this._entries.forEach((n,r)=>e.push((n.invariant&&"vertex"===t?"invariant ":"")+("int"===n.type?"flat ":"")+("vertex"===t?"out":"in")+" ".concat(n.type," ").concat(r,";"))),e}}class g{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?g.ALLOWLIST_VERTEX:g.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(t=>e.includes(t)).map(t=>"#extension ".concat(t," : enable"))}}(r=g).ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],r.ALLOWLIST_VERTEX=[];class y{constructor(){this._entries=new Map}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this._entries.get(n);(null===r||void 0===r?void 0:r.name)!==t||(null===r||void 0===r?void 0:r.type)!==e?this._entries.set(n,{name:t,type:e}):c().warn("Fragment shader output location ".concat(n," occupied"))}generateSource(t){if("vertex"===t)return[];0===this._entries.size&&this._entries.set(0,{name:y.DEFAULT_NAME,type:y.DEFAULT_TYPE});const e=new Array;return this._entries.forEach((t,n)=>e.push("layout(location = ".concat(n,") out ").concat(t.type," ").concat(t.name,";"))),e}}(i=y).DEFAULT_TYPE="vec4",i.DEFAULT_NAME="fragColor";class v{constructor(t){this._stage=t,this._entries=new Set}add(t,e,n){let r="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":r=v._numberToFloatStr(n);break;case"int":r=v._numberToIntStr(n);break;case"bool":r=n.toString();break;case"vec2":r="vec2(".concat(v._numberToFloatStr(n[0]),",                            ").concat(v._numberToFloatStr(n[1]),")");break;case"vec3":r="vec3(".concat(v._numberToFloatStr(n[0]),",                            ").concat(v._numberToFloatStr(n[1]),",                            ").concat(v._numberToFloatStr(n[2]),")");break;case"vec4":r="vec4(".concat(v._numberToFloatStr(n[0]),",                            ").concat(v._numberToFloatStr(n[1]),",                            ").concat(v._numberToFloatStr(n[2]),",                            ").concat(v._numberToFloatStr(n[3]),")");break;case"ivec2":r="ivec2(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),")");break;case"ivec3":r="ivec3(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),",                             ").concat(v._numberToIntStr(n[2]),")");break;case"ivec4":r="ivec4(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),",                             ").concat(v._numberToIntStr(n[2]),",                             ").concat(v._numberToIntStr(n[3]),")");break;case"uvec2":r="uvec2(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),")");break;case"uvec3":r="uvec3(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),",                             ").concat(v._numberToIntStr(n[2]),")");break;case"uvec4":r="uvec4(".concat(v._numberToIntStr(n[0]),",                             ").concat(v._numberToIntStr(n[1]),",                             ").concat(v._numberToIntStr(n[2]),",                             ").concat(v._numberToIntStr(n[3]),")");break;case"mat2":case"mat3":case"mat4":r="".concat(e,"(").concat(Array.prototype.map.call(n,t=>v._numberToFloatStr(t)).join(", "),")")}return this._entries.add("const ".concat(e," ").concat(t," = ").concat(r,";")),this._stage}static _numberToIntStr(t){return t.toFixed(0)}static _numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}const b="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp int;\n  precision highp sampler2D;\n  precision highp usampler2D;\n  precision highp sampler2DArray;\n  precision highp sampler2DShadow;\n#else\n  precision mediump float;\n  precision mediump int;\n  precision mediump sampler2D;\n  precision mediump usampler2D;\n  precision mediump sampler2DArray;\n  precision mediump sampler2DShadow;\n#endif",_="precision highp float;\n precision highp sampler2D;\n precision highp usampler2D;\n precision highp sampler2DArray;\n precision highp sampler2DShadow;\n\n\n invariant gl_Position;\n "},6951:(t,e,n)=>{n.d(e,{Y7:()=>A,HS:()=>N,mm:()=>I,A:()=>F,k2:()=>E,ZA:()=>S,E8:()=>x,hF:()=>b,C5:()=>v,uK:()=>w,Pi:()=>_});var r=n(89379),i=n(6326),o=(n(81806),n(76460)),s=n(60984);function c(t,e,n){const r=e.split("\n");for(const i of r)if(i.trim().length){{let e="";null!=n&&(e+="/*id:".concat(null!==n&&void 0!==n?n:"000","*/   ")),t.body+=e.padEnd(14)}t.body+=" ".repeat(t.indent)+i+"\n"}}class a{write(t){for(const e of t.rootOutputNodes())t.shouldPruneOutputNode(e)||(e.variableName=this._write(t,e.node));return t}_createVarName(t,e){let n="";return"boolean"!=typeof e&&"number"!=typeof e&&e.debugInfo.name&&(n="".concat(e.debugInfo.name,"_")),"".concat(n,"v").concat(t.varCount++)}_write(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e)return e.toString();if("boolean"==typeof e)return e.toString();let r=t.getEmit(e);if(r)return r;switch(e.shaderType){case"scope-node":r=this._writeScopeNode(t,e);break;case"primitive-node":r=this._writePrimitiveNode(t,e,n);break;case"function-node":r=this._writeFunctionNode(t,e);break;case"property-access-node":r=this._writePropertyAccessNode(t,e);break;case"property-access-2d-node":r=this._writePropertyAccess2DNode(t,e);break;case"text-node":r=e.text;break;case"block-node":r=this._writeBlockNode(t,e);break;case"condition-node":r=this._writeConditionNode(t,e)}return t.setEmit(e,r),r}_writeScopeNode(t,e){const n=new e.child.constructor;n.setDebugName(e.debugInfo.name);const r=this._write(t,n,!0);return c(t,"{ /*ScopeStart: ".concat(e.uid," ").concat(e.debugInfo.name,"*/")),t.indent+=2,c(t,"".concat(r," = ").concat(this._write(t,e.child),";")),t.indent-=2,c(t,"} /*ScopeEnd: ".concat(e.uid," ").concat(e.debugInfo.name,"*/")),r}_writeConditionNode(t,e){const n=new e.ifTrue.constructor,r=this._write(t,n,!0);c(t,"if (".concat(this._write(t,e.condition),") {")),t.indent+=2;const i=t.createSubgraphContext(),o=this._write(i,e.ifTrue);if(t.body+=i.body,o&&c(t,"".concat(r," = ").concat(o,";")),t.indent-=2,c(t,"}"),e.ifFalse){c(t,"else {"),t.indent+=2;const n=t.createSubgraphContext(),i=this._write(n,e.ifFalse);t.body+=n.body,i&&c(t,"".concat(r," = ").concat(i,";")),t.indent-=2,c(t,"}")}return r}_writeBlockNode(t,e){const{captureList:n,generator:r,returnType:i}=e,o={};for(const c in n){if(!n[c])continue;const e=this._write(t,n[c]);o[c]=e}const s=new i,a=this._write(t,s,!0);if(o.out=a,e.subgraph){const n=t.createSubgraphContext(),r=this._write(n,e.subgraph.child),i=n.body;o.subgraph={varName:r,body:i}}const u=r(o);return c(t,"{\n"),t.indent+=2,c(t,u),t.indent-=2,c(t,"}\n"),a}_writePropertyAccessNode(t,e){const n=this._write(t,e.target);return"string"==typeof e.property&&e.property.includes("[")?"".concat(n).concat(e.property):"string"!=typeof e.property?"".concat(n,"[").concat(this._write(t,e.property),"]"):"".concat(n,".").concat(e.property)}_writePropertyAccess2DNode(t,e){return"".concat(this._write(t,e.target),"[").concat(this._write(t,e.x),"][").concat(this._write(t,e.y),"]")}_writeFunctionNode(t,e){const n=e.returnType.type;if(e.isInfix){const[r,i]=e.children.map(e=>this._write(t,e)),o=this._createVarName(t,e);return c(t,"".concat(n.padEnd(5)," ").concat(o," = ").concat(r," ").concat(e.token," ").concat(i,";"),e.uid),o}const r=e.children.map(e=>this._write(t,e)).join(", "),i=this._createVarName(t,e);return c(t,"".concat(n.padEnd(5)," ").concat(i," = ").concat(e.token,"(").concat(r,");"),e.uid),i}_writePrimitiveNode(t,e){var n;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t.getInput(e);if(i)return i.isUsed=!0,i.variableName;const o=1===e.children.length&&(null===(n=e.children[0])||void 0===n?void 0:n.type)===e.type;if(!e.isMutable&&(e.isImplicit||o))return this._write(t,e.children[0]);const s=this._createVarName(t,e);if(r)return c(t,"".concat(e.type.padEnd(5)," ").concat(s,";"),e.uid),s;const a=!e.debugInfo.name&&!e.isMutable;if(a&&"float"===e.type&&"number"==typeof e.children[0])return Number.isInteger(e.children[0])?e.children[0].toFixed(1):e.children[0].toString();if(a&&"int"===e.type&&"number"==typeof e.children[0]&&Number.isInteger(e.children[0]))return e.children[0].toString();const u=e.children.map(e=>this._write(t,e)).join(", ");return"array"===e.type?(c(t,"".concat(e.type.padEnd(5)," ").concat(s," = [").concat(u,"];"),e.uid),s):a?"".concat(e.type,"(").concat(u,")"):(c(t,"".concat(e.type.padEnd(5)," ").concat(s," = ").concat(e.type,"(").concat(u,");"),e.uid),s)}}var u=n(22881);class h{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.variableName=t,this.variableInputType=e,this.node=n,this.qualifiers=r,this.type="shader-input",this.isUsed=!1}clone(){return new h(this.variableName,this.variableInputType,(0,u.vA)(this.node),[...this.qualifiers])}}class l{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.outVariableName=t,this.outVariableType=e,this.node=n,this.qualifiers=r,this.type="shader-output"}clone(){const t=new l(this.outVariableName,this.outVariableType,(0,u.vA)(this.node),[...this.qualifiers]);return t.variableName=this.variableName,t}}class d{static createVertex(t,e,n,r,i,o){const s=[];for(const a in t){const e=t[a],r=n.get(a);r?s.push(new h(r,"builtin",e)):s.push(new h("a_"+a,"in",e))}for(const a of r){const t=a.uniformHydrated;s.push(new h(a.uniformName,"uniform",t))}const c=[];for(const a in e){const t=e[a];if("glPosition"===a)c.push(new l("gl_Position","builtin",t));else if("glPointSize"===a)c.push(new l("gl_PointSize","builtin",t));else{const e=p(t),n=[];e&&n.push(e),c.push(new l("v_"+a,"out",t,n))}}return new d(s,c,i,o)}static createFragment(t,e,n,r,i,o){const s=[],c=Array.from(i.rootOutputNodes());for(const u in t){const e=t[u],r=n.get(u);if(r){s.push(new h(r,"builtin",e));continue}const i=c.find(t=>t.node===e);i&&s.push(new h(i.outVariableName,"in",e))}for(const u of r){const t=u.uniformHydrated;s.push(new h(u.uniformName,"uniform",t))}const a=[];for(const u in e){const t=e[u],r=n.get(u);switch(u){case"discard":a.push(new l(null,"discard",t));break;case"fragData0":a.push(new l("fragData0","fragData0",t));break;case"fragData1":a.push(new l("fragData1","fragData1",t));break;case"fragData2":a.push(new l("fragData2","fragData2",t));break;case"fragData3":a.push(new l("fragData3","fragData3",t));break;default:r?a.push(new l(r,"builtin",t)):a.push(new l(u,"out",t))}}return new d(s,a,o)}constructor(t,e,n,r){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const i of t)this._inputShaderTypesByNodeUid.set(i.node.uid,i);this._outputShaderTypes=e,this._transformFeedbackBindings=n,this._transformFeedbackNames=new Set(n.map(t=>"v_"+t.propertyKey)),this._usedInFragmentShader=r}shouldPruneOutputNode(t){return!!this._usedInFragmentShader&&"builtin"!==t.outVariableType&&!this._transformFeedbackNames.has(t.outVariableName)&&!this._usedInFragmentShader.has(t.node.uid)}setEmit(t,e){this._nodeEmitMap.set(t.uid,e)}getEmit(t){return this._nodeEmitMap.get(t.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(t){return this._inputShaderTypesByNodeUid.get(t.uid)}*rootOutputNodes(){for(const t of this._outputShaderTypes)yield t}*nodes(){const t=[];for(const e of this._outputShaderTypes.values())t.push(e.node);for(;t.length;){const e=t.pop();"number"!=typeof e&&"boolean"!=typeof e&&t.push(...e.children.filter(Boolean)),yield e}}*nodesOfTypeOrFunction(){for(const t of this.nodes())"number"!=typeof t&&"boolean"!=typeof t&&(yield t)}createSubgraphContext(){const t=this.clone();return t.body="",t.indent=this.indent+2,t._nodeEmitMap=new Map(this._nodeEmitMap),t}clone(){const t=new d([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return t._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,t.indent=this.indent,t.body=this.body,t.varCount=this.varCount,t._nodeEmitMap=this._nodeEmitMap,t}insertVertexShader(t){t.vertex.code.add(""),this._insertInputs(t,"vertex"),t.vertex.code.add(""),t.vertex.code.add("// OUTPUTS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this.rootOutputNodes()){const n="builtin"===e.outVariableType;if(!this.shouldPruneOutputNode(e))if(n)t.vertex.code.add("// ".concat(e.outVariableType.padEnd(7)," ").concat(e.node.type.padEnd(9)," ").concat(e.outVariableName,";"));else{const n=[...e.qualifiers,e.outVariableType].join(" ");t.vertex.code.add("".concat(n.padEnd(10)," ").concat(e.node.type.padEnd(9)," ").concat(e.outVariableName,";"))}}t.vertex.code.add(""),t.vertex.code.add("void main() {"),t.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const e of this.rootOutputNodes())this.shouldPruneOutputNode(e)||t.vertex.code.add("  ".concat(e.outVariableName," = ").concat(e.variableName,";"));t.vertex.code.add("}")}insertFragmentShader(t){this._insertInputs(t,"fragment"),t.fragment.code.add(""),t.fragment.code.add("// OUTPUTS: "),t.fragment.code.add("// --------------------------------------------------------- ");let e=0;for(const n of this.rootOutputNodes())"builtin"===n.outVariableType?t.fragment.code.add("// ".concat(n.outVariableType.padEnd(7)," ").concat(n.node.type.padEnd(9)," ").concat(n.outVariableName,";")):t.outputs.add(n.outVariableName,n.node.type,e++);t.fragment.code.add(""),t.fragment.code.add("void main() {"),t.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const n of this.rootOutputNodes())"discard"===n.outVariableType?(t.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),t.fragment.code.add("  if (".concat(n.variableName,") {")),t.fragment.code.add("    discard;"),t.fragment.code.add("  }"),t.fragment.code.add("  ")):t.fragment.code.add("  ".concat(n.outVariableName," = ").concat(n.variableName,";"));t.fragment.code.add("}")}_insertInputs(t,e){t[e].code.add("// INPUTS: "),t[e].code.add("// --------------------------------------------------------- ");for(const n of this.inputs())if(n.isUsed&&"builtin"!==n.variableInputType)if("array"===n.node.type)t[e].code.add("".concat(n.variableInputType.padEnd(10)," ").concat(n.node.elementType.type.padEnd(9)," ").concat(n.variableName,"[").concat(n.node.size,"];"));else if("array-2d"===n.node.type)t[e].code.add("".concat(n.variableInputType.padEnd(10)," ").concat(n.node.elementType.type.padEnd(9)," ").concat(n.variableName,"[").concat(n.node.size,"]; // Emulated 2D Array. Not supported by ES3.0"));else{const r=[...n.qualifiers,n.variableInputType].join(" ");t[e].code.add(" ".concat(r.padEnd(10)," ").concat(n.node.type.padEnd(9)," ").concat(n.variableName,";"))}}}function p(t){switch(t.type){case"float":case"vec2":case"vec3":case"vec4":return null;case"int":case"ivec2":case"ivec3":case"ivec4":case"uint":case"uvec2":case"uvec3":case"uvec4":case"bool":case"bvec2":case"bvec3":case"bvec4":return"flat";case"mat2":case"mat3":case"mat4":case"array":case"sampler2D":case"array-2d":throw new Error("InternalError: ".concat(t.type," is not a valid output type"))}}var f=n(78492),m=n(2687);function g(t){return new t}function y(t,e,n){var r;const i=null!==(r=t.constructor[e])&&void 0!==r?r:[];t.constructor.hasOwnProperty(e)||Object.defineProperty(t.constructor,e,{value:i.slice()}),t.constructor[e].push(n)}function v(t,e){return(n,r)=>{y(n,"locations",{typeCtor:e,propertyKey:r,parameterIndex:null,index:t})}}const b=t=>(e,n,r)=>{y(e,"inputs",{inputCtor:t,propertyKey:n,parameterIndex:r})},_=t=>(e,n)=>{y(e,"uniforms",{typeCtor:t,propertyKey:n})},w=t=>(e,n)=>{y(e,"options",{typeCtor:t,propertyKey:n})},x=(t,e)=>{y(t,"defines",{propertyKey:e})};const T=(t,e)=>(n,r)=>{n.constructor.builtins.push({builtin:t,propertyKey:r,typeCtor:e})};class S{}S.builtins=[],(0,i.Cg)([T("gl_VertexID",s.Ai)],S.prototype,"glVertexID",void 0);class A{}class N{}N.builtins=[],(0,i.Cg)([T("gl_FragCoord",s.Zb)],N.prototype,"glFragCoord",void 0),(0,i.Cg)([T("gl_PointCoord",s.ZY)],N.prototype,"glPointCoord",void 0);class I{}(0,i.Cg)([(t=>(e,n)=>{y(e,"builtins",{builtin:t,propertyKey:n})})("gl_FragDepth")],I.prototype,"glFragDepth",void 0);class E{constructor(){this.type="uniform-group"}get _uniforms(){var t;return null!==(t=this.constructor.uniforms)&&void 0!==t?t:[]}}class F{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const t=this._shaderModuleClass.inputs.findLast(t=>"vertex"===t.propertyKey&&0===t.parameterIndex);if(!t)throw new Error("Unable to find vertex input parameter");return t}get computeInput(){return this._shaderModuleClass.inputs.findLast(t=>"vertex"===t.propertyKey&&1===t.parameterIndex)}get fragmentInput(){const t=this._shaderModuleClass.inputs.findLast(t=>"fragment"===t.propertyKey);if(!t)throw new Error("Unable to find fragment input parameter");return t}get transformFeedbackBindings(){var t;return null!==(t=this.fragmentInput.inputCtor.transformFeedbackBindings)&&void 0!==t?t:[]}get locations(){var t,e;return[...this.vertexInput.inputCtor.locations,...null!==(t=null===(e=this.computeInput)||void 0===e?void 0:e.inputCtor.locations)&&void 0!==t?t:[]]}get locationsMap(){const t=new Map,e=new Set;for(const n of this.locations)e.has(n.index)?o.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering","Unable to assigned attribute ".concat(n.propertyKey," to ").concat(n.index,". Index already in use"),{locationsMap:t}):(t.set(n.propertyKey,n.index),e.add(n.index));return t}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map(t=>{let[e,n]=t;return"".concat(e,".").concat(n)}).join("."),n=this.computeAttributes;this._locationInfo={stringHash:e,locations:t,computeAttributeMap:n}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const e of this.locations)t.set("a_"+e.propertyKey,e.index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set;for(const e of this._options)t.add(e.propertyKey);this._optionPropertyKeys=t}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){var t;return null!==(t=this._shaderModuleClass.defines)&&void 0!==t?t:[]}get _options(){var t;return null!==(t=this._shaderModuleClass.options)&&void 0!==t?t:[]}get _uniforms(){var t;return null!==(t=this._shaderModuleClass.uniforms)&&void 0!==t?t:[]}getProgram(t,e,n,r){try{const{vertex:i,fragment:o,uniformBindings:s}=this._generateShaders(t,e,n,r);return new f.K(i,o,this.renamedLocationsMap,s,this.transformFeedbackBindings)}catch(i){return new f.K("","",this.renamedLocationsMap,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(t){const e=this._options.find(e=>e.propertyKey===t);if(e)return{type:"option",className:e.typeCtor};const n=this._uniforms.find(e=>e.propertyKey===t);if(!n)throw new Error("Unable to find uniform class type for property: ".concat(t));return{type:"required",className:n.typeCtor}}getShaderKey(t,e,n,r){const i=Object.keys(t).map(e=>"".concat(e,".").concat(t[e])).join("."),o=Object.keys(n).map(t=>"".concat(t,".").concat(n[t])).join("."),s=Object.keys(r).map(t=>"".concat(t,".").concat(r[t])).join("."),c=Object.keys(e).filter(t=>this.optionPropertyKeys.has(t)&&e[t]).join(".");return"".concat(this.type,".").concat(i,".").concat(o,".").concat(s,".").concat(c)}_generateShaders(t,e,n,r){const i=[];this._setDefines(n),this._setOptionalUniforms(i,e),this._setRequiredUniforms(i);const o=this._hydrateVertexInput(r),s=this._injectPackPrecisionFactor(o,t),c=this._hydrateComputeInput(),h=c&&this._injectComputePackPrecisionFactor(c,t),l=this.vertex(s,h),p=this._hydrateFragmentInput(l),f=this.fragment(p),m=new Set;for(const a in f){const t=f[a];(0,u.rz)(m,t)}const g=this._getVertexInputBuiltins(),y={};for(const[a,u]of Object.entries(o))y[a]=u;if(null!=c)for(const[a,u]of Object.entries(c))y[a]=u;const v=d.createVertex(y,l,g,i,this.transformFeedbackBindings,m);(new a).write(v);const b=this._getFragmentInputBuiltins(f);b.set("glPointCoord","gl_PointCoord"),b.set("glFragCoord","gl_FragCoord");const _=d.createFragment(p,f,b,i,v,this.transformFeedbackBindings);(new a).write(_);const w=this._createShaderBuilder(v,_),x=w.generate("vertex"),T=w.generate("fragment");return this.logShader&&(console.log(x),console.log(T)),{vertex:x,fragment:T,uniformBindings:i}}_setDefines(t){for(const e in t)this[e]=t[e]}_setOptionalUniforms(t,e){for(const n of this._options)e[n.propertyKey]?this[n.propertyKey]=this._hydrateUniformGroup(t,n):this[n.propertyKey]=null}_setRequiredUniforms(t){for(const e of this._uniforms)this[e.propertyKey]=this._hydrateUniformGroup(t,e)}_hydrateUniformGroup(t,e){const n=new(0,e.typeCtor);for(const i of null!==(r=n._uniforms)&&void 0!==r?r:[]){var r;const o=g(i.typeCtor),s="u_".concat(e.propertyKey,"_").concat(i.propertyKey),c=o.type,a=[e.propertyKey,i.propertyKey].join(".");if("type"in i.typeCtor&&"array"===i.typeCtor.type){const e=o;t.push({shaderModulePath:a,uniformName:s,uniformType:c,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:o})}else if("type"in i.typeCtor&&"array-2d"===i.typeCtor.type){const e=o;t.push({shaderModulePath:a,uniformName:s,uniformType:c,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:o})}else t.push({shaderModulePath:a,uniformName:s,uniformType:c,uniformHydrated:o});n[i.propertyKey]=o}return n}_hydrateVertexInput(t){const e=this.vertexInput.inputCtor,n=e.locations.reduce((e,n)=>!1===t[n.propertyKey]?e:(0,r.A)((0,r.A)({},e),{},{[n.propertyKey]:g(n.typeCtor)}),{});for(const{propertyKey:r,typeCtor:i}of e.builtins){const t=g(i);n[r]=t}return n}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce((t,e)=>(0,r.A)((0,r.A)({},t),{},{[e.propertyKey]:g(e.typeCtor)}),{})}_injectPackPrecisionFactor(t,e){const n={};for(const r in t){const i=t[r],o=e[r];if(o){if("float"!==i.type&&"vec2"!==i.type&&"vec3"!==i.type&&"vec4"!==i.type)throw new Error("InternalError: packPrecisionFactor requires GenType, but found ".concat(i.type));n[r]=i.divide(new s.nt(o))}else n[r]=i}return n}_injectComputePackPrecisionFactor(t,e){const n={},r=new Map;for(const o in this.computeAttributes)for(const t of null!==(i=this.computeAttributes[o])&&void 0!==i?i:[]){var i;r.set(t,o)}for(const o in t){const i=t[o],c=r.get(o);if(!c)continue;const a=e[c];if(a){if("float"!==i.type&&"vec2"!==i.type&&"vec3"!==i.type&&"vec4"!==i.type)throw new Error("InternalError: packPrecisionFactor requires GenType, but found ".concat(i.type));n[o]=i.divide(new s.nt(a))}else n[o]=i}return n}_hydrateFragmentInput(t){const e={};for(const n in t)e[n]=t[n];for(const{propertyKey:n,typeCtor:r}of N.builtins){const t=g(r);e[n]=t}return e}_getVertexInputBuiltins(){const t=this.vertexInput.inputCtor,e=new Map;for(const{builtin:n,propertyKey:r}of t.builtins)e.set(r,n);return e}_getFragmentInputBuiltins(t){const e=t.constructor,n=new Map;for(const i of null!==(r=e.builtins)&&void 0!==r?r:[]){var r;n.set(i.propertyKey,i.builtin)}return n}_createShaderBuilder(t,e){const n=new m.N5;return this._insertDebugInfo(n),t.insertVertexShader(n),e.insertFragmentShader(n),n}_insertDebugInfo(t){t.vertex.code.add("// DEFINES: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._defines)this[e.propertyKey]?t.vertex.code.add("//   ".concat(e.propertyKey,": true")):t.vertex.code.add("//   ".concat(e.propertyKey,": false"));t.vertex.code.add(""),t.vertex.code.add("// OPTIONS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._options)this[e.propertyKey]?t.vertex.code.add("//   ".concat(e.propertyKey,": true")):t.vertex.code.add("//   ".concat(e.propertyKey,": false"))}}},12331:(t,e,n)=>{n.d(e,{H:()=>h});n(81806);var r=n(76460),i=n(30726),o=n(76718),s=n(61678),c=n(93345),a=n(62881),u=n(80895);class h{constructor(t,e,n){if(this._context=t,this._glName=null,this._colorAttachments=new Map,this._depthStencilBuffer=null,this._depthStencilTexture=null,this._initialized=!1,t.instanceCounter.increment(c.vt.FramebufferObject,this),null!=e){const n=function(t,e){return l(e)||d(e)?e:p(e)?new u.g(t,e):function(t){return 3===f(t)||null!=t&&"samples"in t}(e)?new a.l(t,e):null}(t,e);null!=n&&(this._colorAttachments.set(c.r6,n),l(n)?this._validateTextureDescriptor(n.descriptor):this._validateRenderbufferDescriptor(n.descriptor)),this._validateColorAttachmentPoint(c.r6)}if(null!=n)if(function(t){return l(t)||p(t)}(n))this._depthStencilTexture=l(n)?n:new u.g(t,n),this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else{const e=d(n)?n:new a.l(t,n);this._depthStencilBuffer=e,this._validateRenderbufferDescriptor(e.descriptor)}}dispose(){var t,e;const{_colorAttachments:n,_glName:r}=this;if(0===n.size&&!this._depthStencilBuffer&&!this._depthStencilTexture&&!r)return;const{_context:i}=this,o=i.getBoundFramebufferObject();n.forEach((t,e)=>{var n;return null===(n=this.detachColorTexture(e))||void 0===n?void 0:n.dispose()}),null!==(t=this.detachDepthStencilBuffer())&&void 0!==t&&t.dispose(),null!==(e=this.detachDepthStencilTexture())&&void 0!==e&&e.dispose(),i.gl.deleteFramebuffer(r),this._glName=null,i.bindFramebuffer(o===this?null:o),i.instanceCounter.decrement(c.vt.FramebufferObject,this)}get glName(){return this._glName}get colorTexture(){const t=this._colorAttachments.get(c.r6);return l(t)?t:null}get depthStencil(){return this._depthStencilTexture||this._depthStencilBuffer}get depthStencilTexture(){return this._depthStencilTexture}get width(){var t,e,n,r;const i=null!==(t=null!==(e=this._colorAttachments.get(c.r6))&&void 0!==e?e:this._depthStencilTexture)&&void 0!==t?t:this._depthStencilBuffer;return null!==(n=null===i||void 0===i||null===(r=i.descriptor)||void 0===r?void 0:r.width)&&void 0!==n?n:0}get height(){var t,e,n,r;const i=null!==(t=null!==(e=this._colorAttachments.get(c.r6))&&void 0!==e?e:this._depthStencilTexture)&&void 0!==t?t:this._depthStencilBuffer;return null!==(n=null===i||void 0===i||null===(r=i.descriptor)||void 0===r?void 0:r.height)&&void 0!==n?n:0}get usedMemory(){var t,e;return[...this._colorAttachments].reduce((t,e)=>{let[n,r]=e;return t+r.usedMemory},null!==(t=null===(e=this.depthStencil)||void 0===e?void 0:e.usedMemory)&&void 0!==t?t:0)}getColorTexture(t){const e=this._colorAttachments.get(t);return e&&l(e)?e:null}get colorAttachments(){return[...this._colorAttachments.keys()]}attachColorTexture(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.r6;if(!t)return;this._validateColorAttachmentPoint(n);const{descriptor:r}=t;this._validateTextureDescriptor(r),null!==(e=this.detachColorTexture(n))&&void 0!==e&&e.dispose(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,n)),this._colorAttachments.set(n,t)}detachColorTexture(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.r6;const e=this._colorAttachments.get(t);if(!e)return;const n=l(e);return this._initialized&&this._context.temporaryBindFramebufferObject(this,()=>{if(n)this._framebufferTexture2D(null,t);else{const e=this._context.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,null)}}),this._colorAttachments.delete(t),n?e:void 0}setColorTextureTarget(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.r6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this._colorAttachments.get(e);r&&(35866===t?this._framebufferTextureLayer(r.glName,e,36160,0,n):this._framebufferTexture2D(r.glName,e,t,36160,0))}attachDepthStencil(t){if(t)switch(t.type){case 1:return this._attachDepthStencilTexture(t);case 2:return this._attachDepthStencilBuffer(t)}}_attachDepthStencilTexture(t){var e;if(null==t)return;const{descriptor:n}=t,{pixelFormat:r,dataType:i}=n;34041===r||6402===r?34041!==r||i===c.ld.UNSIGNED_INT_24_8?6402!==r||i===c.ld.UNSIGNED_INT||i===c.ld.UNSIGNED_SHORT?(this._validateTextureDescriptor(n),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,y(r))),null!==(e=this._depthStencilTexture)&&void 0!==e&&e.dispose(),this._depthStencilTexture=t):console.error("Depth texture must have data type of UNSIGNED_INT or UNSIGNED_SHORT!"):console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"):console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!")}detachDepthStencilTexture(){const t=this._depthStencilTexture;return t&&this._initialized&&this._context.temporaryBindFramebufferObject(this,()=>{this._framebufferTexture2D(null,y(t.descriptor.pixelFormat))}),this._depthStencilTexture=null,t}_attachDepthStencilBuffer(t){if(null==t)return;const e=t.descriptor;if(this._validateRenderbufferDescriptor(e),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);const{gl:n}=this._context,r=this._getGLAttachmentPoint(e);n.framebufferRenderbuffer(36160,r,n.RENDERBUFFER,t.glName)}this._depthStencilBuffer=t}detachDepthStencilBuffer(){const t=this._depthStencilBuffer;if(t&&this._initialized){const{_context:e}=this,n=e.getBoundFramebufferObject();e.bindFramebuffer(this);const{gl:r}=e,i=this._getGLAttachmentPoint(t.descriptor);r.framebufferRenderbuffer(36160,i,r.RENDERBUFFER,null),e.bindFramebuffer(n)}return this._depthStencilBuffer=null,t}invalidateAttachments(t){const{_context:e}=this;e.temporaryBindFramebufferObject(this,()=>e.gl.invalidateFramebuffer(36160,t),!0)}copyToTexture(t,e,n,r,i,o,s){(t<0||e<0||i<0||o<0)&&console.error("Offsets cannot be negative!"),(n<=0||r<=0)&&console.error("Copy width and height must be greater than zero!");const c=s.descriptor;3553!==s.descriptor.target&&console.error("Texture target must be TEXTURE_2D!"),(null==(null===c||void 0===c?void 0:c.width)||null==(null===c||void 0===c?void 0:c.height)||t+n>this.width||e+r>this.height||i+n>c.width||o+r>c.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");const a=this._context,h=a.bindTexture(s,u.g.TEXTURE_UNIT_FOR_UPDATES);a.setActiveTexture(u.g.TEXTURE_UNIT_FOR_UPDATES),a.bindFramebuffer(this),a.gl.copyTexSubImage2D(3553,0,i,o,t,e,n,r),a.bindTexture(h,u.g.TEXTURE_UNIT_FOR_UPDATES)}readPixels(t,e,n,r,i,o,s){(n<=0||r<=0)&&console.error("Copy width and height must be greater than zero!"),s||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(t,e,n,r,i,o,s)}async readPixelsAsync(t,e,n,r,i,s,c){const{gl:a}=this._context,u=o.g.createPixelPack(this._context,35041,c.byteLength);this._context.bindBuffer(u);const h=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),a.readPixels(t,e,n,r,i,s,0),this._context.unbindBuffer(35051),this._context.bindFramebuffer(h),await u.getSubDataAsync(c),u.dispose()}resize(t,e){var n,r;if(this.width===t&&this.height===e)return;const i={width:t,height:e};if(m(i,this._context.parameters.maxTextureSize),this._colorAttachments.forEach(t=>t.resize(i.width,i.height)),null!==(n=this._depthStencilTexture)&&void 0!==n&&n.resize(i.width,i.height),this._initialized&&(m(i,this._context.parameters.maxRenderbufferSize),null!==(r=this._depthStencilBuffer)&&void 0!==r&&r.resize(i.width,i.height),(0,s.en)())){const{gl:t}=this._context;t.checkFramebufferStatus(36160)!==t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!")}}initializeAndBind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36160;const{gl:e}=this._context;if(this._initialized)return void e.bindFramebuffer(t,this.glName);this._glName&&e.deleteFramebuffer(this._glName);const n=e.createFramebuffer();if(e.bindFramebuffer(t,n),this._colorAttachments.forEach((e,n)=>{if(l(e)){const r=g(e);35866===r?this._framebufferTextureLayer(e.glName,n,t,0,0):this._framebufferTexture2D(e.glName,n,r,t)}else if(d(e)){const r=this._context.gl;r.framebufferRenderbuffer(t,n,r.RENDERBUFFER,e.glName)}}),this._depthStencilBuffer){const n=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);e.framebufferRenderbuffer(t,n,e.RENDERBUFFER,this._depthStencilBuffer.glName)}else if(this._depthStencilTexture){const e=y(this._depthStencilTexture.descriptor.pixelFormat);this._framebufferTexture2D(this._depthStencilTexture.glName,e,g(this._depthStencilTexture),t)}(0,s.en)()&&e.checkFramebufferStatus(t)!==e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=n,this._initialized=!0}_framebufferTexture2D(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.r6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3553,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:36160,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this._context.gl.framebufferTexture2D(r,e,n,t,i)}_framebufferTextureLayer(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.r6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36160,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this._context.gl.framebufferTextureLayer(n,e,t,r,i)}_disposeDepthStencilAttachments(){const t=this._context.gl;if(this._depthStencilBuffer){if(this._initialized){this._context.bindFramebuffer(this);const e=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);t.framebufferRenderbuffer(36160,e,t.RENDERBUFFER,null)}this._depthStencilBuffer=(0,i.WD)(this._depthStencilBuffer)}this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,y(this._depthStencilTexture.descriptor.pixelFormat))),this._depthStencilTexture=(0,i.WD)(this._depthStencilTexture))}_validateTextureDescriptor(t){3553!==t.target&&34067!==t.target&&35866!==t.target&&console.error("Texture type must be TEXTURE_2D, TEXTURE_2D_ARRAY or TEXTURE_CUBE_MAP!"),m(t,this._context.parameters.maxTextureSize),this._validateBufferDimensions(t)}_validateRenderbufferDescriptor(t){m(t,this._context.parameters.maxRenderbufferSize),this._validateBufferDimensions(t)}_validateBufferDimensions(t){t.width<=0&&(t.width=this.width),t.height<=0&&(t.height=this.height),this.width>0&&this.height>0&&(this.width===t.width&&this.height===t.height||console.error("Attachment size must match framebuffer size!"))}_getGLAttachmentPoint(t){switch(t.internalFormat){case c.SB.DEPTH_COMPONENT16:case c.SB.DEPTH_COMPONENT24:case c.SB.DEPTH_COMPONENT32F:return c.xL;case c.iE.DEPTH24_STENCIL8:case c.iE.DEPTH32F_STENCIL8:return c.nI;case 36168:return c.uH;default:return c.r6}}_validateColorAttachmentPoint(t){if(-1===h._MAX_COLOR_ATTACHMENTS){const{gl:t}=this._context;h._MAX_COLOR_ATTACHMENTS=t.getParameter(t.MAX_COLOR_ATTACHMENTS)}const e=t-c.r6;e+1>h._MAX_COLOR_ATTACHMENTS&&r.A.getLogger("esri.views.webgl.FrameBufferObject").error("esri.FrameBufferObject","illegal attachment point for color attachment: ".concat(e+1,". Implementation supports up to ").concat(h._MAX_COLOR_ATTACHMENTS," color attachments"))}}function l(t){return 1===f(t)}function d(t){return 2===f(t)}function p(t){return 0===f(t)}function f(t){return null!=t&&"type"in t?t.type:null}function m(t,e){const n=Math.max(t.width,t.height);if(n>e){r.A.getLogger("esri.views.webgl.FramebufferObject").warnOnce("Resizing FBO attachment size ".concat(t.width,"x").concat(t.height," to device limit ").concat(e));const i=e/n;return t.width=Math.round(t.width*i),t.height=Math.round(t.height*i),!1}return!0}function g(t){return 34067===t.descriptor.target?34069:35866===t.descriptor.target?35866:3553}function y(t){return 6402===t?c.xL:c.nI}h._MAX_COLOR_ATTACHMENTS=-1},22881:(t,e,n)=>{function r(t,e){const n=[];for(n.push(e);n.length;){const e=n.pop();if("object"==typeof e&&!t.has(e.uid)){t.add(e.uid);for(const t of e.children)n.push(t)}}}n.d(e,{XL:()=>h,aw:()=>d,ff:()=>u,rR:()=>l,rz:()=>r,vA:()=>o,vL:()=>s,zg:()=>a});class i{constructor(){this.uid=i.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(t){return t=function(t){return t.split(" ").map((t,e)=>e>0?t.charAt(0).toUpperCase()+t.slice(1):t).join("")}(t),this._debugName=t,this.isImplicit&&this.children[0]instanceof i&&this.children[0].setDebugName(t),this}get debugInfo(){var t;return{name:null!==(t=this._debugName)&&void 0!==t?t:""}}cloneInto(t){t._debugName=this._debugName,t._isMutable=this._isMutable,t.isImplicit=this.isImplicit,t.uid=this.uid}}function o(t){return"object"==typeof t?t.clone():t}i.NodeCount=0;class s extends i{constructor(){super(...arguments),this.shaderType="primitive-node"}}class c extends i{constructor(t){super(),this.child=t,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const t=new c(o(this.child));return this.cloneInto(t),t}}class a extends i{constructor(t,e,n){super(),this.property=t,this.target=e,this.returnType=n,this.shaderType="property-access-node"}get children(){const t=[this.target];return"string"!=typeof this.property&&t.push(this.property),t}clone(){const t=new a(this.property,o(this.target),this.returnType);return this.cloneInto(t),t}}class u extends i{constructor(t,e,n,r){super(),this.x=t,this.y=e,this.target=n,this.returnType=r,this.shaderType="property-access-2d-node"}get children(){return[this.target,this.x,this.y]}clone(){const t=new u(this.x,this.y,o(this.target),this.returnType);return this.cloneInto(t),t}}class h extends i{constructor(t,e,n){super(),this.condition=t,this.ifTrue=e,this.ifFalse=n,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const t=o(this.ifTrue),e=this.ifFalse?o(this.ifFalse):null,n=new h(this.condition,t,e);return this.cloneInto(n),n}}class l extends i{constructor(t,e,n,r){super(),this.captureList=t,this.returnType=e,this.generator=r,this.shaderType="block-node",n&&(this.subgraph=new c(n))}get children(){var t;return Object.keys(this.captureList).map(t=>this.captureList[t]).concat(null!==(t=this.subgraph)&&void 0!==t?t:[])}clone(){const t={};for(const n in this.captureList)t[n]=o(this.captureList[n]);const e=new l(t,this.returnType,this.subgraph?o(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(e),e}}class d extends i{constructor(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(),this.token=t,this._children=e,this.isInfix=n,this.isPropertyAccess=r,this.returnType=i,this.isTernary=o,this.shaderType="function-node"}get children(){return this._children}clone(){const t=new d(this.token,this._children.map(o),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(t),t}}},60984:(t,e,n)=>{n.d(e,{$5:()=>kt,$I:()=>it,$T:()=>Ie,AU:()=>fe,Ai:()=>Q,Bw:()=>se,Cq:()=>J,Ec:()=>Pt,F8:()=>ve,FM:()=>Ct,Gb:()=>Nt,HQ:()=>Vt,I8:()=>zt,Io:()=>ee,L0:()=>be,LC:()=>Rt,LI:()=>ge,MM:()=>Lt,Ml:()=>Te,My:()=>k,Ny:()=>nt,Om:()=>ne,PM:()=>xe,RI:()=>ie,RZ:()=>we,Rm:()=>ce,S8:()=>pe,Sj:()=>Et,T9:()=>ue,TF:()=>_e,Tk:()=>_t,U:()=>rt,US:()=>Ne,Uo:()=>jt,Wh:()=>st,Xe:()=>Bt,YN:()=>Gt,ZY:()=>z,Zb:()=>K,Zc:()=>at,_S:()=>ye,_i:()=>L,aX:()=>Ut,eB:()=>j,eR:()=>ut,fV:()=>ct,gn:()=>Jt,hC:()=>Mt,j1:()=>wt,jc:()=>oe,jh:()=>le,jk:()=>he,ln:()=>ht,lw:()=>xt,mk:()=>$t,n7:()=>me,nP:()=>Ae,nf:()=>Ft,nt:()=>O,oN:()=>re,om:()=>bt,or:()=>Ot,p6:()=>ae,pu:()=>Dt,qE:()=>Qt,qR:()=>qt,rY:()=>Wt,rf:()=>Zt,tn:()=>Kt,w0:()=>lt,wH:()=>It,x:()=>q,yH:()=>Yt,yI:()=>te,ym:()=>Se,z7:()=>U,ze:()=>vt,zi:()=>de});var r,i,o,s,c,a,u,h,l,d,p,f,m,g,y,v,b,_,w,x,T,S,A,N,I,E,F,D,M=n(6326),C=n(22881);function R(t){return new Proxy(t,{get(e,n){if("constructor"===n)return new Proxy(e.constructor,{construct:(t,e,n)=>R(new t(...e))});if(n in e)return e[n];if("string"==typeof n){const e=function(t){const e=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const n of e)if(n.includes(t))return n.map(t=>ot[t]);throw new Error("Unable to find type family")}(t.type);return dt(t,n,e[n.length-1])}}})}function P(t){return new Proxy(t,{construct:(t,e,n)=>R(new t(...e))})}class B extends Error{}let k=(r=class extends C.vL{constructor(t,e){super(),this.elementType=t,this.size=e,this.children=[],this.type="array"}clone(){const t=new y(this.elementType,this.size);return super.cloneInto(t),t}get(t,e){const n=new Q(t),r=null!=e?new Q(e):null;return null!=r?pt(this,n,r,function(t){switch(t.type){case"bool":case"bvec2":case"bvec3":case"bvec4":return q;case"float":case"vec2":case"vec3":case"vec4":return O;case"int":case"ivec2":case"ivec3":case"ivec4":return Q;case"uint":case"uvec2":case"uvec3":case"uvec4":return V;default:throw new Error("Unable to handle type")}}(this.elementType.constructor)):dt(this,n,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(t,e,n){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.size;const i=new Q(n).setMutable().setDebugName("FindIndexIterator"),o=e(t.get(i)).setDebugName("FindIndexPredicate"),s=bt({iter:i},Q,o,t=>{let{out:e,iter:n,subgraph:i}=t;return"\n".concat(e," = -1;\n\nfor (; ").concat(n," < ").concat(r,"; ").concat(n,"++) {\n\n").concat(i.body,"\n\n  if (").concat(i.varName,") {\n    ").concat(e," = ").concat(n,";\n    break;\n  }\n\n}\n")}).setDebugName("FindIndexBlock");return s}(this,t,e,n)}glslFindIndex(t,e,n){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.size;const i=bt({array:t},Q,null,t=>{let{out:i,array:o}=t;return"\n".concat(i," = -1;\nfor (int i = ").concat(n,"; i < ").concat(r,"; i++) {\n  bool condition;\n  ").concat(e({array:o,i:"i",out:"condition"}),"\n  if (condition) {\n    ").concat(i," = i;\n    break;\n  }\n}\n")}).setDebugName("GlslFindIndexBlock");return i}(this,t,e,n)}static ofType(t,e){const n={construct:(n,r)=>new y(new t,e)};return new Proxy(y,n)}},y=r,r.type="array",r);k=y=(0,M.Cg)([function(t){return new Proxy(t,{construct:(t,e,n)=>function(t){return new Proxy(t,{get(e,n){if(n in e)return e[n];if("string"==typeof n){const e=parseInt(n,10);if(!isNaN(e))return dt(t,"[".concat(e,"]"),t.elementType.constructor)}}})}(new t(...e))})}],k);class L extends C.vL{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.elementType=t,this.xSize=e,this.ySize=n,this.isRowMajor=r,this.children=[],this.type="array-2d"}clone(){const t=new L(this.elementType,this.xSize,this.ySize,this.isRowMajor);return super.cloneInto(t),t}get size(){return this.xSize*this.ySize}get(t,e){return this.isRowMajor?this._getRowMajor(t,e):this._getColumnMajor(t,e)}_getColumnMajor(t,e){const n=new Q(t);return dt(this,new Q(e).add(n.multiply(this.xSize)),this.elementType.constructor)}_getRowMajor(t,e){const n=new Q(t),r=new Q(e);return dt(this,n.add(r.multiply(this.ySize)),this.elementType.constructor)}static ofType(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Proxy(k,{construct:(i,o)=>new L(new t,e,n,r)})}}L.type="array-2d";class U extends C.vL{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){const t=new U;return t.children=this.children.map(C.vA),super.cloneInto(t),t}}U.type="sampler2D";class O extends C.vL{constructor(t){super(),this.type="float",this.children=[t]}clone(){const t=new O((0,C.vA)(this.children[0]));return super.cloneInto(t),t}multiply(t){return xt(this,"number"==typeof t?Z(t,O):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,O):t)}add(t){return St(this,"number"==typeof t?Z(t,O):t)}subtract(t){return At(this,"number"==typeof t?Z(t,O):t)}}O.type="float";let z=(i=class extends C.vL{constructor(t,e){super(),this.type="vec2",this.children=[t,e].filter(t=>null!=t)}clone(){const t=new v((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",O)}get 1(){return dt(this,"[1]",O)}get 2(){throw new B}get 3(){throw new B}multiply(t){return xt(this,"number"==typeof t?Z(t,O):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,O):t)}add(t){return St(this,"number"==typeof t?Z(t,O):t)}subtract(t){return At(this,"number"==typeof t?Z(t,O):t)}},v=i,i.type="vec2",i);z=v=(0,M.Cg)([P],z);let j=(o=class extends C.vL{constructor(t,e,n){super(),this.type="vec3",this.children=[t,e,n].filter(t=>null!=t)}get 0(){return dt(this,"[0]",O)}get 1(){return dt(this,"[1]",O)}get 2(){return dt(this,"[2]",O)}get 3(){throw new B}clone(){const t=new b((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]));return super.cloneInto(t),t}multiply(t){return xt(this,"number"==typeof t?Z(t,O):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,O):t)}add(t){return St(this,"number"==typeof t?Z(t,O):t)}subtract(t){return At(this,"number"==typeof t?Z(t,O):t)}},b=o,o.type="vec3",o);j=b=(0,M.Cg)([P],j);let K=(s=class extends C.vL{constructor(t,e,n,r){super(),this.type="vec4",this.children=[t,e,n,r].filter(t=>null!=t)}clone(){const t=new _((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",O)}get 1(){return dt(this,"[1]",O)}get 2(){return dt(this,"[2]",O)}get 3(){return dt(this,"[3]",O)}multiply(t){return xt(this,"number"==typeof t?Z(t,O):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,O):t)}add(t){return St(this,"number"==typeof t?Z(t,O):t)}subtract(t){return At(this,"number"==typeof t?Z(t,O):t)}},_=s,s.type="vec4",s);K=_=(0,M.Cg)([P],K);let V=(c=class extends C.vL{constructor(t){super(),this.type="uint",this.children=[t]}clone(){const t=new w((0,C.vA)(this.children[0]));return super.cloneInto(t),t}multiply(t){return xt(this,Z(t,w))}add(t){return St(this,Z(t,w))}subtract(t){return At(this,Z(t,w))}divide(t){return Tt(this,Z(t,w))}},w=c,c.type="uint",c);V=w=(0,M.Cg)([P],V);let G=(a=class extends C.vL{constructor(t,e){super(),this.type="uvec2",this.children=[t,e].filter(t=>null!=t)}clone(){const t=new x((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",Q)}get 1(){return dt(this,"[1]",Q)}get 2(){throw new B}get 3(){throw new B}multiply(t){return xt(this,"number"==typeof t?Z(t,V):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,V):t)}add(t){return St(this,"number"==typeof t?Z(t,V):t)}subtract(t){return At(this,"number"==typeof t?Z(t,V):t)}},x=a,a.type="uvec2",a);G=x=(0,M.Cg)([P],G);let H=(u=class extends C.vL{constructor(t,e,n){super(),this.type="uvec3",this.children=[t,e,n].filter(t=>null!=t)}clone(){const t=new T((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",V)}get 1(){return dt(this,"[1]",V)}get 2(){return dt(this,"[2]",V)}get 3(){throw new B}multiply(t){return xt(this,"number"==typeof t?Z(t,V):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,V):t)}add(t){return St(this,"number"==typeof t?Z(t,V):t)}subtract(t){return At(this,"number"==typeof t?Z(t,V):t)}},T=u,u.type="uvec3",u);H=T=(0,M.Cg)([P],H);let X=(h=class extends C.vL{constructor(t,e,n,r){super(),this.type="uvec4",this.children=[t,e,n,r].filter(t=>null!=t)}clone(){const t=new S((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",V)}get 1(){return dt(this,"[1]",V)}get 2(){return dt(this,"[2]",V)}get 3(){return dt(this,"[3]",V)}multiply(t){return xt(this,"number"==typeof t?Z(t,V):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,V):t)}add(t){return St(this,"number"==typeof t?Z(t,V):t)}subtract(t){return At(this,"number"==typeof t?Z(t,V):t)}},S=h,h.type="uvec4",h);X=S=(0,M.Cg)([P],X);class q extends C.vL{constructor(t){super(),this.type="bool",this.children=[t]}and(t){return jt(this,t)}or(t){return Ot(this,t)}xor(t){return zt(this,t)}clone(){const t=new q((0,C.vA)(this.children[0]));return super.cloneInto(t),t}}q.type="bool";let Y=(l=class extends C.vL{constructor(t,e){super(),this.type="bvec2",this.children=[t,e].filter(t=>null!=t)}all(){return Ht(this)}any(){return Xt(this)}clone(){const t=new A((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]));return super.cloneInto(t),t}},A=l,l.type="bvec2",l);Y=A=(0,M.Cg)([P],Y);let W=(d=class extends C.vL{constructor(t,e,n){super(),this.type="bvec3",this.children=[t,e,n].filter(t=>null!=t)}all(){return Ht(this)}any(){return Xt(this)}clone(){const t=new N((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]));return super.cloneInto(t),t}},N=d,d.type="bvec3",d);function Z(t,e){return"number"==typeof t?new e(t):t}W=N=(0,M.Cg)([P],W);let $=(p=class extends C.vL{constructor(t,e,n,r){super(),this.type="bvec4",this.children=[t,e,n,r].filter(t=>null!=t)}all(){return Ht(this)}any(){return Xt(this)}clone(){const t=new I((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]));return super.cloneInto(t),t}},I=p,p.type="bvec4",p);$=I=(0,M.Cg)([P],$);class Q extends C.vL{constructor(t){super(),this.type="int",this.children=[t]}multiply(t){return xt(this,Z(t,Q))}add(t){return St(this,Z(t,Q))}subtract(t){return At(this,Z(t,Q))}divide(t){return Tt(this,Z(t,Q))}clone(){const t=new Q((0,C.vA)(this.children[0]));return super.cloneInto(t),t}}Q.type="int";let J=(f=class extends C.vL{constructor(t,e){super(),this.type="ivec2",this.children=[t,e].filter(t=>null!=t)}clone(){const t=new E((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",Q)}get 1(){return dt(this,"[1]",Q)}get 2(){throw new B}get 3(){throw new B}multiply(t){return xt(this,"number"==typeof t?Z(t,Q):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,Q):t)}add(t){return St(this,"number"==typeof t?Z(t,Q):t)}subtract(t){return At(this,"number"==typeof t?Z(t,Q):t)}},E=f,f.type="ivec2",f);J=E=(0,M.Cg)([P],J);let tt=(m=class extends C.vL{constructor(t,e,n){super(),this.type="ivec3",this.children=[t,e,n].filter(t=>null!=t)}clone(){const t=new F((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",Q)}get 1(){return dt(this,"[1]",Q)}get 2(){return dt(this,"[2]",Q)}get 3(){throw new B}multiply(t){return xt(this,"number"==typeof t?Z(t,Q):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,Q):t)}add(t){return St(this,"number"==typeof t?Z(t,Q):t)}subtract(t){return At(this,"number"==typeof t?Z(t,Q):t)}},F=m,m.type="ivec3",m);tt=F=(0,M.Cg)([P],tt);let et=(g=class extends C.vL{constructor(t,e,n,r){super(),this.type="ivec4",this.children=[t,e,n,r].filter(t=>null!=t)}clone(){const t=new D((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]));return super.cloneInto(t),t}get 0(){return dt(this,"[0]",Q)}get 1(){return dt(this,"[1]",Q)}get 2(){return dt(this,"[2]",Q)}get 3(){return dt(this,"[3]",Q)}multiply(t){return xt(this,"number"==typeof t?Z(t,Q):t)}divide(t){return Tt(this,"number"==typeof t?Z(t,Q):t)}add(t){return St(this,"number"==typeof t?Z(t,Q):t)}subtract(t){return At(this,"number"==typeof t?Z(t,Q):t)}},D=g,g.type="ivec4",g);et=D=(0,M.Cg)([P],et);class nt extends C.vL{constructor(t,e,n,r){super(),this.type="mat2",this.children=[t,e,n,r]}clone(){const t=new nt((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]));return super.cloneInto(t),t}get(t,e){return pt(this,new Q(t),new Q(e),O)}multiply(t){return xt(this,t)}}nt.type="mat2";class rt extends C.vL{static identity(){return new rt(1,0,0,0,1,0,0,0,1)}static fromRotation(t){const e=ve(t),n=Jt(t);return new rt(n,e,0,vt(e),n,0,0,0,1)}constructor(t,e,n,r,i,o,s,c,a){super(),this.type="mat3",this.children=[t,e,n,r,i,o,s,c,a]}add(t){return St(this,t)}multiply(t){return xt(this,t)}get(t,e){return pt(this,new Q(t),new Q(e),O)}clone(){const t=new rt((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]),(0,C.vA)(this.children[4]),(0,C.vA)(this.children[5]),(0,C.vA)(this.children[6]),(0,C.vA)(this.children[7]),(0,C.vA)(this.children[8]));return super.cloneInto(t),t}}rt.type="mat3";class it extends C.vL{static identity(){return new it(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(t,e,n,r,i,o,s,c,a,u,h,l,d,p,f,m){super(),this.type="mat4",this.children=[t,e,n,r,i,o,s,c,a,u,h,l,d,p,f,m]}static fromColumns(t,e,n,r){return new it(t.x,t.y,t.z,t.w,e.x,e.y,e.z,e.w,n.x,n.y,n.z,n.w,r.x,r.y,r.z,r.w)}multiply(t){return xt(this,t)}get(t,e){return pt(this,new Q(t),new Q(e),O)}clone(){const t=new it((0,C.vA)(this.children[0]),(0,C.vA)(this.children[1]),(0,C.vA)(this.children[2]),(0,C.vA)(this.children[3]),(0,C.vA)(this.children[4]),(0,C.vA)(this.children[5]),(0,C.vA)(this.children[6]),(0,C.vA)(this.children[7]),(0,C.vA)(this.children[8]),(0,C.vA)(this.children[9]),(0,C.vA)(this.children[10]),(0,C.vA)(this.children[11]),(0,C.vA)(this.children[12]),(0,C.vA)(this.children[13]),(0,C.vA)(this.children[14]),(0,C.vA)(this.children[15]));return super.cloneInto(t),t}}it.type="mat4";const ot={float:O,vec2:z,vec3:j,vec4:K,int:Q,ivec2:J,ivec3:tt,ivec4:et,uint:V,uvec2:G,uvec3:H,uvec4:X,bool:q,bvec2:Y,bvec3:W,bvec4:$},st=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Q(...e)},ct=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new O(...e)},at=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new z(...e)},ut=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new j(...e)},ht=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new K(...e)},lt=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new rt(...e)};function dt(t,e,n){const r=new n(new C.zg(e,t,n));return r.isImplicit=!0,r}function pt(t,e,n,r){const i=new r(new C.ff(e,n,t,r));return i.isImplicit=!0,i}function ft(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){const i=new r,o=new r(new C.aw(t,[e,n],!0,!1,i));return o.isImplicit=!0,o}if("float"===e.type||"int"===e.type){const r=new n.constructor(new C.aw(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}if(("mat2"===e.type||"mat3"===e.type||"mat4"===e.type)&&"float"!==n.type){const r=new n.constructor(new C.aw(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}const i=new e.constructor(new C.aw(t,[e,n],!0,!1,e.constructor));return i.isImplicit=!0,i}function mt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.constructor;const r=new n(new C.aw(t,[e],!1,!1,n));return r.isImplicit=!0,r}function gt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.constructor;const i=new r(new C.aw(t,[e,n],!1,!1,r));return i.isImplicit=!0,i}function yt(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.constructor;const o=new i(new C.aw(t,[e,n,r],!1,!1,i));return o.isImplicit=!0,o}function vt(t){return xt(t,ct(-1))}function bt(t,e,n,r){return new e(new C.rR(t,e,n,r))}function _t(t,e,n){const r="function"==typeof e?e():e,i="function"==typeof n?n():n,o=new r.constructor(new C.XL(t,r,i));return o.isImplicit=!0,o}function wt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(t=>{let[e,n]=t;return"function"==typeof n?[e,n()]:[e,n]}),i=r[0][1].constructor,o=r.findIndex(t=>!0===t[0]);if(-1===o)throw new Error("A cond must have a fallthrough case with `true`/; ");const s=r.slice(0,o),c=r[o][1],a=new i(s.reduceRight((t,e)=>_t(e[0],e[1],t),c));return a.isImplicit=!0,a}function xt(t,e){return ft("*",t,e)}function Tt(t,e){return ft("/",t,e)}function St(t,e){return ft("+",t,e)}function At(t,e){return ft("-",t,e)}function Nt(t,e){return ft("%",t,e)}function It(t,e){return ft("<<",t,e)}function Et(t,e){return ft(">>",t,e)}function Ft(t,e){return ft("&",t,e)}function Dt(t,e){return ft("|",t,e)}function Mt(t,e){return ft("^",t,e)}function Ct(t){return mt("~",t)}function Rt(t,e){return ft("==",t,e,q)}function Pt(t,e){return ft("!=",t,e,q)}function Bt(t,e){return ft("<",t,e,q)}function kt(t,e){return ft("<=",t,e,q)}function Lt(t,e){return ft(">",t,e,q)}function Ut(t,e){return ft(">=",t,e,q)}function Ot(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce((t,e)=>function(t,e){return ft("||",t,e,q)}(t,e),e[0])}function zt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce((t,e)=>function(t,e){return ft("^^",t,e,q)}(t,e),e[0])}function jt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce((t,e)=>function(t,e){return ft("&&",t,e,q)}(t,e),e[0])}function Kt(t){return mt("abs",t)}function Vt(t){return mt("acos",t)}function Gt(t){return mt("acosh",t)}function Ht(t){return mt("all",t,q)}function Xt(t){return mt("any",t,q)}function qt(t){return mt("asin",t)}function Yt(t){return mt("asinh",t)}function Wt(t,e){return null==e?mt("atan",t):gt("atan",t,e,t.constructor)}function Zt(t){return mt("atanh",t)}function $t(t){return mt("ceil",t)}function Qt(t,e,n){return yt("clamp",t,e,n,t.constructor)}function Jt(t){return mt("cos",t)}function te(t){return mt("cosh",t)}function ee(t,e){return gt("distance",t,e,O)}function ne(t,e){return gt("dot",t,e,O)}function re(t){return mt("exp",t)}function ie(t){return mt("floor",t)}function oe(t){return mt("fract",t)}function se(t){return mt("length",t,O)}function ce(t){return mt("log",t)}function ae(t){return mt("log2",t)}function ue(t,e){return gt("max",t,e)}function he(t,e){return gt("min",t,e)}function le(t,e,n){return yt("mix",t,e,n)}function de(t,e){return gt("mod",t,e)}function pe(t){return mt("normalize",t)}function fe(t){return"bool"===t.type?mt("!",t):mt("not",t)}function me(t,e){return gt("pow",t,e)}function ge(t){return mt("round",t)}function ye(t){return mt("sign",t)}function ve(t){return mt("sin",t)}function be(t){return mt("sinh",t)}function _e(t,e,n){return yt("smoothstep",t,e,n)}function we(t){return mt("sqrt",t)}function xe(t,e){return gt("step",t,e,e.constructor)}function Te(t){return mt("tan",t)}function Se(t){return mt("tanh",t)}function Ae(t,e,n){return yt("texelFetch",t,e,n,K)}function Ne(t,e){return gt("texture",t,e,K)}function Ie(t,e){const{initialValue:n,xRange:r,yRange:i,callback:o}=e,[s,c]=r,[a,u]=i,h=new Q(0).setMutable().setDebugName("iterX"),l=new Q(0).setMutable().setDebugName("iterY"),d=n.setMutable().setDebugName("accumulator"),p=o(d,t.get(h,l),h,l).setDebugName("callback"),f=bt({iterX:h,iterY:l,accumulator:d},n.constructor,p,t=>{let{out:e,iterX:n,iterY:r,accumulator:i,subgraph:o}=t;return"\nfor (".concat(r," = ").concat(a,"; ").concat(r," < ").concat(u,"; ").concat(r,"++) {\n  for (").concat(n," = ").concat(s,"; ").concat(n," < ").concat(c,"; ").concat(n,"++) {\n\n  ").concat(o.body,"\n\n  ").concat(i," = ").concat(o.varName,";\n  }\n}\n").concat(e," = ").concat(i,";\n")}).setDebugName("reduce2DBody");return f}},62881:(t,e,n)=>{n.d(e,{l:()=>c});var r=n(81806),i=n(93345),o=n(88800);const s=!!(0,r.A)("esri-tests-disable-gpu-memory-measurements");class c{constructor(t,e){this._context=t,this._descriptor=e,this.type=2,this._context.instanceCounter.increment(i.vt.Renderbuffer,this);const n=this._context.gl;this.glName=n.createRenderbuffer(),this._context.bindRenderbuffer(this);const{width:r,height:o,internalFormat:s,multisampled:c}=e;c?n.renderbufferStorageMultisample(n.RENDERBUFFER,this.samples,s,r,o):n.renderbufferStorage(n.RENDERBUFFER,s,r,o),this._context.bindRenderbuffer(null)}get descriptor(){return this._descriptor}get samples(){const t=this._descriptor.samples,e=this._context.parameters.maxSamples;return t?Math.min(t,e):e}get usedMemory(){return s?0:(0,o.e)(this._descriptor)}resize(t,e){const n=this._descriptor;if(n.width===t&&n.height===e)return;n.width=t,n.height=e;const r=this._context.gl;this._context.bindRenderbuffer(this),n.multisampled?r.renderbufferStorageMultisample(r.RENDERBUFFER,this.samples,n.internalFormat,n.width,n.height):r.renderbufferStorage(r.RENDERBUFFER,n.internalFormat,n.width,n.height),this._context.bindRenderbuffer(null)}dispose(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(i.vt.Renderbuffer,this),this._context=null)}}},70479:(t,e,n)=>{n.d(e,{j:()=>r});class r{constructor(){this.drawPhase=89}startup(){}shutdown(t){}}},78492:(t,e,n)=>{n.d(e,{K:()=>d});var r=n(50076),i=n(76460),o=n(30726),s=n(48611),c=(n(76718),n(12331),n(44488)),a=(n(81806),n(62881),n(80895)),u=(n(93345),n(61678),n(96673));function h(t,e,n){const r=new u.R(e.width,e.height);return r.dataType=e.dataType,e.depth&&(r.depth=e.depth),e.flipped&&(r.flipped=e.flipped),e.hasMipmap&&(r.hasMipmap=e.hasMipmap),r.internalFormat=e.internalFormat,e.isImmutable&&(r.isImmutable=e.isImmutable),e.isOpaque&&(r.isOpaque=e.isOpaque),e.maxAnisotropy&&(r.maxAnisotropy=e.maxAnisotropy),r.pixelFormat=e.pixelFormat,e.preMultiplyAlpha&&(r.preMultiplyAlpha=e.preMultiplyAlpha),e.samplingMode&&(r.samplingMode=e.samplingMode),e.target&&(r.target=e.target),r.uniform=e.uniform,e.unpackAlignment&&(r.unpackAlignment=e.unpackAlignment),e.wrapMode&&(r.wrapMode=e.wrapMode),new a.g(t,r,n)}function l(t,e,n){const o=e.length;if(o!==n){const s=new r.A("Invalid Uniform","Invalid length, expected ".concat(n," but got ").concat(o),{uniformName:t,values:e});i.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(s)}}class d{constructor(t,e,n,r,i){this.vertexShader=t,this.fragmentShader=e,this._locations=n,this._uniformBindings=r,this._transformFeedbackBindings=i,this._vao=null,this._temporaryTextures=[]}destroy(){this._program=(0,o.WD)(this._program),this.cleanupTemporaryTextures()}setUniforms(t){this._uniforms=t}cleanupTemporaryTextures(){for(const t of this._temporaryTextures)t.dispose();this._temporaryTextures=[]}bind(t){const e=this._uniforms;if(!this._program){const e=[];for(const t of null!==(n=this._transformFeedbackBindings)&&void 0!==n?n:[]){var n;const{index:r,propertyKey:i}=t;e[r]="v_".concat(i)}this._program=new c.B(t,this.vertexShader,this.fragmentShader,this._locations,new Map,e)}const r=this._program;t.useProgram(r);for(const i of this._uniformBindings){const{shaderModulePath:n,uniformName:o,uniformType:c,uniformArrayLength:a}=i,u=(0,s.wc)(n,e);if(null==u){if("sampler2D"===c)continue;throw new Error("Failed to find uniform value for ".concat(n))}switch("array"===c||"array-2d"===c?i.uniformArrayElementType:c){case"sampler2D":{const{unit:e,texture:n}=u;if(r.setUniform1i(o,e),"type"in n)t.bindTexture(n,e);else{const r=h(t,n.descriptor,n.data);t.bindTexture(r,e)}break}case"int":if(!a){r.setUniform1i(o,u);break}l(i.uniformName,u,a),r.setUniform1iv(o,u);break;case"float":if(!a){r.setUniform1f(o,u);break}l(i.uniformName,u,a),r.setUniform1fv(o,u);break;case"vec2":if(!a){r.setUniform2f(o,u[0],u[1]);break}l(i.uniformName,u,a),r.setUniform2fv(o,u.flat());break;case"vec3":if(!a){r.setUniform3f(o,u[0],u[1],u[2]);break}l(i.uniformName,u,a),r.setUniform3fv(o,u.flat());break;case"vec4":if(!a){r.setUniform4f(o,u[0],u[1],u[2],u[3]);break}l(i.uniformName,u,a),r.setUniform4fv(o,u.flat());break;case"mat3":r.setUniformMatrix3fv(o,u);break;case"mat4":r.setUniformMatrix4fv(o,u);break;default:throw new Error("Unable to set uniform for type ".concat(c))}}}}},88800:(t,e,n)=>{n.d(e,{e:()=>o,q:()=>i});var r=n(27207);class i{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.internalFormat=t,this.width=e,this.height=n,this.multisampled=r,this.samples=i}}function o(t){return t.width<=0||t.height<=0||null==t.internalFormat?0:t.width*t.height*(0,r.MW)(t.internalFormat)}}}]);
//# sourceMappingURL=2117.c717bf70.chunk.js.map