"use strict";(self.webpackChunkmmsp_land_hl=self.webpackChunkmmsp_land_hl||[]).push([[6790],{12482:(e,t,o)=>{o.d(t,{$7:()=>E,B:()=>R,Fo:()=>w,M7:()=>T,Q5:()=>S,Tq:()=>P,Up:()=>b,XF:()=>I,Ze:()=>y,bK:()=>a,bh:()=>h,id:()=>A,ky:()=>c,qt:()=>k,tW:()=>M,v9:()=>f,w7:()=>u,wF:()=>l,wS:()=>x,x:()=>v,xS:()=>_,ze:()=>d});var n=o(56002),i=o(31633),r=o(81478);function s(e){return e?k:P}function l(e,t){return null!==t&&void 0!==t&&t.mode?t.mode:s(e).mode}function a(e,t){return null!=t?t:s(e)}function u(e,t){var o;return l(null==e||null!==(o=e.hasZ)&&void 0!==o&&o,t)}function d(e,t){var o;return a(null==e||null!==(o=e.hasZ)&&void 0!==o&&o,t)}function c(e){const t=g(e);return u(e.geometry,t)}function h(e){const t=g(e),o=u(e.geometry,t);return{mode:o,offset:null!=t&&"on-the-ground"!==o?T(t):0,featureExpressionInfo:null===t||void 0===t?void 0:t.featureExpressionInfo}}function f(e){return p(e)||v(e)}function v(e){var t;return"0"===(null===e||void 0===e||null===(t=e.featureExpressionInfo)||void 0===t?void 0:t.expression)}function p(e){if(!e)return!1;if("on-the-ground"===e.mode)return!1;const t=null!==e&&void 0!==e&&e.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||"0"===t)}function g(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}const m=(0,n.B)((e,t,o)=>{if(!e)return 0;if("decimal-degrees"===t)return 0;const n="unknown"!==t&&t?t:"meters",r=(0,i.mq)(o);return r?(0,i.oU)(e,n,r):0});function y(e,t){return m(null===e||void 0===e?void 0:e.offset,null===e||void 0===e?void 0:e.unit,t)}function A(e,t,o){var n,i;if(null===o||void 0===o||!o.mode)return;const r=e.hasZ?e.z:0,s=y(o,e.spatialReference);switch(o.mode){case"absolute-height":return r-s;case"on-the-ground":return 0;case"relative-to-ground":return r-((null!==(n=t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"ground"))&&void 0!==n?n:0)+s);case"relative-to-scene":return r-((null!==(i=t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"scene"))&&void 0!==i?i:0)+s)}}function x(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return w(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,o,n)}function _(e,t,o,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return w(e,t[0],t[1],t.length>2?t[2]:0,o,n,i)}function w(e,t,o,n,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(null==r)return;const l=null!=s?s.mode:"absolute-height";if("on-the-ground"===l)return 0;const{absoluteZ:a}=S(t,o,n,i,e,r);return function(e,t,o,n,i,r,s,l){var a,u;const d=y(s,i);switch(l){case"absolute-height":return e-d;case"relative-to-ground":return e-((null!==(a=r.elevationProvider.getElevation(t,o,n,i,"ground"))&&void 0!==a?a:0)+d);case"relative-to-scene":return e-((null!==(u=r.elevationProvider.getElevation(t,o,n,i,"scene"))&&void 0!==u?u:0)+d)}}(a,t,o,n,i,e,s,l)}function S(e,t,o,n,i,r){const s=y(r,n);switch(r.mode){case"absolute-height":return{absoluteZ:o+s,elevation:0};case"on-the-ground":{var l;const o=null!==(l=i.elevationProvider.getElevation(e,t,0,n,"ground"))&&void 0!==l?l:0;return{absoluteZ:o,elevation:o}}case"relative-to-ground":{var a;const r=null!==(a=i.elevationProvider.getElevation(e,t,o,n,"ground"))&&void 0!==a?a:0;return{absoluteZ:o+r+s,elevation:r}}case"relative-to-scene":{var u;const r=null!==(u=i.elevationProvider.getElevation(e,t,o,n,"scene"))&&void 0!==u?u:0;return{absoluteZ:o+r+s,elevation:r}}}}function b(e,t){if(null==t)return!1;const{mode:o}=t;return null!=o&&("scene"===e&&"relative-to-scene"===o||"ground"===e&&"absolute-height"!==o)}function R(e,t,o){return o&&o.mode!==t?"".concat(e," only support ").concat(t," elevation mode"):null}function E(e,t,o){return(null===o||void 0===o?void 0:o.mode)===t?"".concat(e," do not support ").concat(t," elevation mode"):null}function M(e,t){return null!=(null===t||void 0===t?void 0:t.featureExpressionInfo)&&"0"!==t.featureExpressionInfo.expression?"".concat(e," do not support featureExpressionInfo"):null}function I(e,t){t&&e.warn(".elevationInfo=",t)}function T(e){var t;return(null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t?t:0)*(0,r.Ao)(null===e||void 0===e?void 0:e.unit)}const k={mode:"absolute-height",offset:0},P={mode:"on-the-ground",offset:null}},23456:(e,t,o)=>{o.d(t,{_8:()=>p,uB:()=>g});var n=o(89379),i=o(15941),r=o(20664),s=o(9392),l=o(34111),a=o(76797),u=o(91605),d=o(13312),c=o(45308);function h(e,t){if(!Array.isArray(e)||e.length<t)return!1;for(const o of e)if("number"!=typeof o)return!1;return!0}const f=7645211,v={xmin:-180,ymin:-90,zmin:-450,xmax:180,ymax:90,zmax:8850};new Map([[5773,new u.A({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"EGM96_Geoid"})],[3855,new u.A({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"EGM2008_Geoid"})],[115700,new u.A({heightModel:"ellipsoidal",heightUnit:"meters",vertCRS:"WGS_1984"})],[115701,new u.A({heightModel:"ellipsoidal",heightUnit:"meters",vertCRS:"ETRS_1989"})],[6360,new u.A({heightModel:"gravity-related-height",heightUnit:"us-feet",vertCRS:"NAVD88_height_(ftUS)"})],[7837,new u.A({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"DHHN2016_(height) "})]]);function p(e){var t,o,n,i,r;return!(!(null!==(t=e.extensions)&&void 0!==t&&null!==(t=t.ESRI_crs)&&void 0!==t&&t.wkid||null!==(o=e.extensions)&&void 0!==o&&null!==(o=o.ESRI_crs)&&void 0!==o&&o.latestWkid||null!==(n=e.extensions)&&void 0!==n&&null!==(n=n.ESRI_crs)&&void 0!==n&&n.wkt)||(null===(i=e.root)||void 0===i||null===(i=i.extensions)||void 0===i||null===(i=i.ESRI_crs)||void 0===i||null===(i=i.boundingVolume)||void 0===i||!i.box)&&(null===(r=e.root)||void 0===r||null===(r=r.extensions)||void 0===r||null===(r=r.ESRI_crs)||void 0===r||null===(r=r.boundingVolume)||void 0===r||!r.sphere))}function g(e){var t,o,u,p,g,m,y,A,x,_;let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1],S=new d.A({wkid:4326,vcsWkid:115700}),b=null===(t=e.root)||void 0===t?void 0:t.boundingVolume,R=!1,E=null===e||void 0===e||null===(o=e.root)||void 0===o?void 0:o.transform;if(w&&(null!==(u=e.extensions)&&void 0!==u&&null!==(u=u.ESRI_crs)&&void 0!==u&&u.wkid||null!==(p=e.extensions)&&void 0!==p&&null!==(p=p.ESRI_crs)&&void 0!==p&&p.latestWkid||null!==(g=e.extensions)&&void 0!==g&&null!==(g=g.ESRI_crs)&&void 0!==g&&g.wkt)&&(null!==(m=e.root)&&void 0!==m&&null!==(m=m.extensions)&&void 0!==m&&null!==(m=m.ESRI_crs)&&void 0!==m&&null!==(m=m.boundingVolume)&&void 0!==m&&m.box||null!==(y=e.root)&&void 0!==y&&null!==(y=y.extensions)&&void 0!==y&&null!==(y=y.ESRI_crs)&&void 0!==y&&null!==(y=y.boundingVolume)&&void 0!==y&&y.sphere))S=new d.A(null===(A=e.extensions)||void 0===A?void 0:A.ESRI_crs),b=null===(x=e.root)||void 0===x||null===(x=x.extensions)||void 0===x||null===(x=x.ESRI_crs)||void 0===x?void 0:x.boundingVolume,E=null===(_=e.root)||void 0===_?void 0:_.transform,R=!0;else if(!b)return new a.A(-180,-90,180,90,S);if(b.box){var M;const e=null===(M=b)||void 0===M?void 0:M.box;if(e[3]>f&&e[7]>f&&e[11]>f)return new a.A((0,n.A)((0,n.A)({},v),{},{spatialReference:S}))}const I=(0,s.vt)();if(!R&&b.region&&h(b.region,6)){const e=b.region,t=(0,i.KJ)(e[0]),o=(0,i.KJ)(e[1]),n=e[4],r=(0,i.KJ)(e[2]),s=(0,i.KJ)(e[3]),l=e[5];return new a.A({xmin:t,ymin:o,zmin:n,xmax:r,ymax:s,zmax:l,spatialReference:S})}if(b.sphere&&h(b.sphere,4)){const e=b.sphere,t=(0,s.fA)(e[0],e[1],e[2]),o=e[3]/Math.sqrt(3),n=(0,s.vt)();(0,r.e)(n,t,(0,s.fA)(o,o,o));const i=(0,s.vt)();if((0,r.g)(i,t,(0,s.fA)(o,o,o)),E&&h(E,16)){const e=E;(0,r.t)(I,n,e),(0,r.d)(n,I),(0,r.t)(I,i,e),(0,r.d)(i,I)}R||((0,c.projectBuffer)(n,l.Ro,0,n,d.A.WGS84,0),(0,c.projectBuffer)(i,l.Ro,0,i,d.A.WGS84,0));const u=(0,s.vt)(),f=(0,s.vt)();return(0,r.A)(u,n,i),(0,r.z)(f,n,i),new a.A({xmin:u[0],ymin:u[1],zmin:u[2],xmax:f[0],ymax:f[1],zmax:f[2],spatialReference:S})}if(b.box&&h(b.box,12)){const e=b.box,t=(0,s.fA)(e[0],e[1],e[2]),o=(0,s.fA)(e[3],e[4],e[5]),n=(0,s.fA)(e[6],e[7],e[8]),i=(0,s.fA)(e[9],e[10],e[11]),u=[];for(let r=0;r<8;++r)u.push((0,s.vt)());if((0,r.g)(u[0],t,o),(0,r.g)(u[0],u[0],n),(0,r.g)(u[0],u[0],i),(0,r.a)(u[1],t,o),(0,r.g)(u[1],u[1],n),(0,r.g)(u[1],u[1],i),(0,r.g)(u[2],t,o),(0,r.a)(u[2],u[2],n),(0,r.g)(u[2],u[2],i),(0,r.a)(u[3],t,o),(0,r.a)(u[3],u[3],n),(0,r.g)(u[3],u[3],i),(0,r.g)(u[4],t,o),(0,r.g)(u[4],u[4],n),(0,r.a)(u[4],u[4],i),(0,r.a)(u[5],t,o),(0,r.g)(u[5],u[5],n),(0,r.a)(u[5],u[5],i),(0,r.g)(u[6],t,o),(0,r.a)(u[6],u[6],n),(0,r.a)(u[6],u[6],i),(0,r.a)(u[7],t,o),(0,r.a)(u[7],u[7],n),(0,r.a)(u[7],u[7],i),E&&h(E,16)){const e=E;for(let t=0;t<8;++t)(0,r.t)(u[t],u[t],e)}const f=(0,s.fA)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),v=(0,s.fA)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let s=0;s<8;++s)R||(0,c.projectBuffer)(u[s],l.Ro,0,u[s],d.A.WGS84,0),(0,r.A)(v,v,u[s]),(0,r.z)(f,f,u[s]);return new a.A({xmin:v[0],ymin:v[1],zmin:v[2],xmax:f[0],ymax:f[1],zmax:f[2],spatialReference:S})}return new a.A(-180,-90,180,90,S)}},56002:(e,t,o)=>{function n(e){let t,o,n=[],i=!1;return function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return i&&t===this&&function(e,t){if(e.length!==t.length)return!1;for(let o=0;o<e.length;++o)if(e[o]!==t[o])return!1;return!0}(s,n)||(o=e.apply(this,s),t=this,n=s,i=!0),o}}o.d(t,{B:()=>n})},59518:(e,t,o)=>{o.d(t,{A:()=>x});var n,i=o(89379),r=o(6326),s=o(3825),l=o(19276),a=o(42553),u=o(90534),d=o(46053),c=(o(81806),o(76460),o(47249),o(87990)),h=o(53084),f=o(62754),v=o(17707),p=o(37546),g=o(65215),m=o(56611);let y=n=class extends a.o{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,o,n){var i;if(null!==(i=n.layer)&&void 0!==i&&i.spatialReference&&!n.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,m.canProjectWithoutEngine)(e.spatialReference,n.layer.spatialReference))return void((null===n||void 0===n?void 0:n.messages)&&n.messages.push(new f.A("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:n.layer.spatialReference,context:n})));const i=new g.A;(0,m.projectPolygon)(e,i,n.layer.spatialReference),t[o]=i.toJSON(n)}else t[o]=e.toJSON(n)}clone(){return new n({geometry:(0,h.o8)(this.geometry),type:this.type})}};var A;(0,r.Cg)([(0,d.MZ)({type:g.A}),(0,p.P)()],y.prototype,"geometry",void 0),(0,r.Cg)([(0,v.K)(["web-scene","portal-item"],"geometry")],y.prototype,"writeGeometry",null),(0,r.Cg)([(0,d.MZ)({type:["clip","mask","replace"],nonNullable:!0}),(0,p.P)()],y.prototype,"type",void 0),y=n=(0,r.Cg)([(0,c.$)("esri.layers.support.SceneModification")],y);let x=A=class extends((0,a.T)(l.A.ofType(y))){constructor(e){super(e),this.url=null}clone(){return new A({url:this.url,items:this.items.map(e=>e.clone())})}toJSON(e){return this.toArray().map(t=>t.toJSON(e)).filter(e=>!!e.geometry)}static fromJSON(e,t){const o=new A;for(const n of e)o.add(y.fromJSON(n,t));return o}static async fromUrl(e,t,o){const n={url:(0,u.An)(e),origin:"service"},r=await(0,s.A)(e,{responseType:"json",signal:null===o||void 0===o?void 0:o.signal}),l=t.toJSON(),a=[];for(const s of r.data)a.push(y.fromJSON((0,i.A)((0,i.A)({},s),{},{geometry:(0,i.A)({spatialReference:l},s.geometry)}),n));return new A({url:e,items:a})}};(0,r.Cg)([(0,d.MZ)({type:String})],x.prototype,"url",void 0),x=A=(0,r.Cg)([(0,c.$)("esri.layers.support.SceneModifications")],x)},76790:(e,t,o)=>{o.r(t),o.d(t,{default:()=>P});var n=o(6326),i=o(3825),r=o(50076),s=o(76460),l=o(77717),a=o(50346),u=o(68134),d=o(46053),c=(o(81806),o(47249),o(28379)),h=o(87990),f=o(37546),v=o(76797),p=o(13312),g=o(25515),m=o(12406),y=o(19502),A=o(31362),x=o(11270),_=o(94729),w=o(5682),S=o(95363),b=o(59518),R=o(23456),E=o(65308),M=o(12482),I=o(79453),T=o(50917);let k=class extends((0,y.b)((0,x.q)((0,_.A)((0,w.j)((0,l.P)((0,A.d)((0,m.p)(g.A)))))))){readModifications(e,t,o){this._modificationsSource={url:(0,I.f)(e,o),context:o}}initialize(){this.addHandles((0,u.on)(()=>this.modifications,"after-changes",()=>this.modifications=this.modifications,u.OH))}constructor(e){super(e),this.operationalLayerType="IntegratedMesh3DTilesLayer",this.modifications=null,this._modificationsSource=null,this.spatialReference=new p.A({wkid:4326,vcsWkid:115700}),this.fullExtent=new v.A(-180,-90,180,90,this.spatialReference),this.url=null,this.type="integrated-mesh-3dtiles",this.path=null,this.minScale=0,this.maxScale=0,this._rootTilesetJSON=null,this._rootTileset=null,this._key=null,this._session=null,this._rootRequestPromise=null}set elevationInfo(e){null!=e&&"absolute-height"!==e.mode||this._set("elevationInfo",e),this._validateElevationInfo(e)}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}get rootTilesetJSON(){return this._rootTilesetJSON}get rootTileset(){return this._rootTileset}get key(){return this._key}get session(){return this._session}_findSessionParameter(e){const t=[e];for(;(null===t||void 0===t?void 0:t.length)>0;){const e=t.pop();if(!e)return;for(const[n,i]of Object.entries(e)){if("uri"===n)try{const e=new URL("https://tmp"+i).searchParams.get("session");if(e)return e}catch(o){}"object"==typeof i&&null!==i&&t.push(i)}}return null}async requestRootAndSession(e){const t=(e,t)=>new r.A("3dtiles-init:"+e,t);return this._rootRequestPromise||(this._rootRequestPromise=new Promise((o,n)=>{this.url||n(t("url-missing","Layer url missing")),this._key=this.customParameters?this.customParameters.key:null,new Promise((e,o)=>{if(this.replacesTerrain&&!this._key){var n,r;const s=(null===(n=this.portalItem)||void 0===n?void 0:n.portal)||(null===(r=this.parent)||void 0===r||null===(r=r.portalItem)||void 0===r?void 0:r.portal)||E.A.getDefault();s.signIn().then(()=>{s.g3dTilesEnabled?(0,i.A)(s.restUrl+"/portals/self/modules/g3dtiles",{responseType:"json",query:{f:"json"}}).then(t=>{this._key=t.data.keyString,e()},()=>o(t("g3dtiles-key-error","Error fetching Google 3D Tiles key from portal"))):o(t("g3dTilesEnabled-false","Google 3D Tiles are not enabled on Portal "+s.url))},()=>o(t("sign-in-failed","Error signing in to Portal")))}else e()}).then(()=>{(0,i.A)(this.url,{query:this._key?{key:this._key,token:this.apiKey}:{token:this.apiKey},responseType:"array-buffer",authMode:"anonymous",signal:e}).then(e=>{try{this._rootTilesetJSON=JSON.parse((new TextDecoder).decode(e.data))}catch(i){return void n(t("root-parse-failed","Error parsing root tile, details: "+i))}this._rootTilesetJSON?(this._session=this._findSessionParameter(this._rootTilesetJSON),this._rootTileset=e.data,this.fullExtent=(0,R.uB)(this._rootTilesetJSON),o(),this._rootRequestPromise=null):n(t("root-is-null","Root tile is null."))},e=>{(0,a.QP)(e),n(t("root-load-failed","Error loading root tile")),this._rootRequestPromise=null,s.A.getLogger("IntegratedMesh3DTilesLayer").error("Layer loading failed",e)})},e=>n(e))})),this._rootRequestPromise}async _doLoad(e){const t=null!=e?e.signal:null;if(this._isUsedAsGroundLayer)throw new r.A("3dtiles-init:not-supported-in-groundlayers","Layer is not supported in basemap.");try{await this.loadFromPortal({supportedTypes:["3DTiles Service"],validateItem:e=>{var t;if(null!==(t=e.typeKeywords)&&void 0!==t&&t.includes("IntegratedMesh"))return!0;throw new r.A("portal:invalid-layer-item-type","Invalid layer item, expected '${expectedType}' ",{expectedType:"3DTiles Service containing IntegratedMesh"})}},e)}catch(o){(0,a.QP)(o)}if(null!=this._modificationsSource){const t=await b.A.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin("modifications",t,this._modificationsSource.context.origin),this._modificationsSource=null}await this.requestRootAndSession(t)}beforeSave(){if(null!=this._modificationsSource)return this.load().then(()=>{},()=>{})}get hasAttributionData(){return!1}async fetchAttributionData(){return{}}_validateElevationInfo(e){const t="Integrated mesh 3d tiles layers";(0,M.XF)(s.A.getLogger(this),(0,M.B)(t,"absolute-height",e)),(0,M.XF)(s.A.getLogger(this),(0,M.tW)(t,e))}get replacesTerrain(){return!1}get _isUsedAsGroundLayer(){return(0,T.S)(this.parent)}get hasGoogleUrl(){var e;return!(null===(e=this.url)||void 0===e||!e.match(/.+\.googleapis.com/))}};(0,n.Cg)([(0,d.MZ)({type:["IntegratedMesh3DTilesLayer"]})],k.prototype,"operationalLayerType",void 0),(0,n.Cg)([(0,d.MZ)({type:b.A,clonable:e=>e.clone()}),(0,f.P)({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],k.prototype,"modifications",void 0),(0,n.Cg)([(0,c.w)(["web-scene","portal-item"],"modifications")],k.prototype,"readModifications",null),(0,n.Cg)([(0,d.MZ)({type:p.A})],k.prototype,"spatialReference",void 0),(0,n.Cg)([(0,d.MZ)({type:v.A})],k.prototype,"fullExtent",void 0),(0,n.Cg)([(0,d.MZ)(S.Yj)],k.prototype,"elevationInfo",null),(0,n.Cg)([(0,d.MZ)({type:["show","hide"]})],k.prototype,"listMode",void 0),(0,n.Cg)([(0,d.MZ)(S.OZ)],k.prototype,"url",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],k.prototype,"type",void 0),(0,n.Cg)([(0,d.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],k.prototype,"path",void 0),(0,n.Cg)([(0,d.MZ)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:!1,write:!1}}}})],k.prototype,"minScale",void 0),(0,n.Cg)([(0,d.MZ)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:!1,write:!1}}}})],k.prototype,"maxScale",void 0),(0,n.Cg)([(0,d.MZ)()],k.prototype,"replacesTerrain",null),(0,n.Cg)([(0,d.MZ)()],k.prototype,"_isUsedAsGroundLayer",null),(0,n.Cg)([(0,d.MZ)()],k.prototype,"hasGoogleUrl",null),k=(0,n.Cg)([(0,h.$)("esri.layers.IntegratedMesh3DTilesLayer")],k);const P=k}}]);
//# sourceMappingURL=6790.9c939b01.chunk.js.map